import{a as o,q as L,r as A}from"./index-ADhmmBpU.js";import{u as V,a as y}from"./useMutate-B2j67kPQ.js";import{o as T,b as D,s as n,a as S}from"./zod-BQt-Wj8X.js";import{M as N}from"./MutateRequestMethod-D0dsk-6r.js";import{l as m}from"./lodash-BI9_Ro3R.js";import{u as k,A as b}from"./useApplicationDocument-C6bKJL3W.js";import{u as O}from"./button-Bp2lHjov-bkEUXTzY.js";const q=e=>T({applicationNumber:n().nonempty(e("required {{field}}",{field:e("Application number"),ns:o.LANG.NS.VALIDATION})),workProcedure:n().nonempty(e("required {{field}}",{field:e("Work conditions"),ns:o.LANG.NS.VALIDATION})),workDateTime:n().nonempty(e("required {{field}}",{field:e("Date"),ns:o.LANG.NS.VALIDATION})),station:n().nonempty(e("required {{field}}",{field:e("Magistral name"),ns:o.LANG.NS.VALIDATION})),noNumber:n().nonempty(e("required {{field}}",{field:e("NO number"),ns:o.LANG.NS.VALIDATION})),aiChannels:n().nonempty(e("required {{field}}",{field:e("AI-9 channels"),ns:o.LANG.NS.VALIDATION})),workReason:n().nonempty(e("required {{field}}",{field:e("Reason Job"),ns:o.LANG.NS.VALIDATION})),workDescription:n().nonempty(e("required {{field}}",{field:e("Job description"),ns:o.LANG.NS.VALIDATION})),koStatus:n().nonempty(e("required {{field}}",{field:e("NO status"),ns:o.LANG.NS.VALIDATION})),bypassSchedule:n().nonempty(e("required {{field}}",{field:e("AAG"),ns:o.LANG.NS.VALIDATION})),alternativeBackup:n().nonempty(e("required {{field}}",{field:e("Reservation"),ns:o.LANG.NS.VALIDATION})),responsiblePerson:n().nonempty(e("required {{field}}",{field:e("Responsible person"),ns:o.LANG.NS.VALIDATION})),approvedByTechnicalDirector:n().nonempty(e("required {{field}}",{field:e("Head of the enterprise"),ns:o.LANG.NS.VALIDATION})),approvedByLocalAI:n().nonempty(e("required {{field}}",{field:e("AI-9 full name"),ns:o.LANG.NS.VALIDATION})),orderAP:n().nonempty(e("required {{field}}",{field:e("Applicant AP"),ns:o.LANG.NS.VALIDATION})),orderMBB:n().nonempty(e("required {{field}}",{field:e("Applicant UBP"),ns:o.LANG.NS.VALIDATION})),recipientIds:D(n()).nonempty(e("required {{field}}",{field:e("Staffs"),ns:o.LANG.NS.VALIDATION}))}),M=({id:e,onSave:i})=>{const{t:a}=O(),{toast:t}=L(),{applicationDocumentQuery:l}=k(e),s=V({resolver:S(q(a)),mode:"onChange"});A.useEffect(()=>{var d,p;const r=(d=l.data)==null?void 0:d.data;if(r){s.setValue("applicationNumber",r.applicationNumber),s.setValue("workProcedure",r.workProcedure),s.setValue("workProcedure",r.workProcedure),s.setValue("workDateTime",r.workDateTime),s.setValue("station",r.station),s.setValue("noNumber",r.noNumber),s.setValue("aiChannels",r.aiChannels),s.setValue("workReason",r.workReason),s.setValue("workDescription",r.workDescription),s.setValue("koStatus",r.koStatus),s.setValue("bypassSchedule",r.bypassSchedule),s.setValue("alternativeBackup",r.alternativeBackup),s.setValue("responsiblePerson",r.responsiblePerson),s.setValue("approvedByTechnicalDirector",r.approvedByTechnicalDirector),s.setValue("approvedByLocalAI",r.approvedByLocalAI),s.setValue("orderAP",r.orderAP),s.setValue("orderMBB",r.orderMBB);const c=((p=r.recipientIds)==null?void 0:p.map(I=>I._id))??[];s.setValue("recipientIds",c.length>0?c:[""])}},[l.data,s]);const{query:u}=y({url:[b,e||""],method:e?N.PUT:N.POST,options:{onError:r=>{t({variant:"destructive",title:a(`${m.get(r,"response.statusText","Error")}`),description:a(`${m.get(r,"response.data.message","An error occurred. Contact the administrator")}`)})},onSuccess:()=>{s.reset(),i==null||i(),t({variant:"success",title:a("Success"),description:a(e?"Application updated successfully":"Application created successfully")})}}}),f=A.useCallback(r=>{u.mutate(r)},[u]);return{id:e,form:s,handleSubmit:f}};export{M as u};
