import{q as V,r as u}from"./index-ADhmmBpU.js";import{u as y,a as F}from"./useMutate-B2j67kPQ.js";import{a as E}from"./zod-BQt-Wj8X.js";import{c as T}from"./createF54Schema-CidpDcDP.js";import{M as d}from"./MutateRequestMethod-D0dsk-6r.js";import{l as f}from"./lodash-BI9_Ro3R.js";import{u as b,F as x}from"./useF54Document-SmdNDJqk.js";import{u as g}from"./useChannel-CLHGnbdc.js";import{u as D}from"./button-Bp2lHjov-bkEUXTzY.js";const O=({id:r,onSave:o})=>{const{t:s}=D(),{toast:n}=V(),{f54DocumentQuery:i}=b(r),e=y({resolver:E(T(s)),defaultValues:{prophylaxisType:"Yillik reja"}}),{channel:a}=g(e.watch("channel_id"));u.useEffect(()=>{var l,m;const t=(l=i.data)==null?void 0:l.data;if(t){e.setValue("channel_id",t.channel_id._id),e.setValue("real_minutes",t.real_minutes),e.setValue("date",t.date),e.setValue("minute",t.minute),e.setValue("date",t.date),e.setValue("prophylaxisType",t.prophylaxisType),e.setValue("cause",t.cause),e.setValue("ubpZone",t.ubpZone),e.setValue("note",t.note),e.setValue("description",t.description);const p=((m=t.recipientIds)==null?void 0:m.map(h=>h._id))??[];e.setValue("recipientIds",p.length>0?p:[""])}},[i.data,e]),u.useEffect(()=>{a&&(e.setValue("noNumber",a.channel_number_in_stream),e.setValue("teOeDesignation",a.timeslot_number),e.setValue("workArea",`${a.rcpu_site_id_a}/${a.rcpu_site_id_z}`))},[a]);const{query:c}=F({url:[x,r||""],method:r?d.PUT:d.POST,options:{onError:t=>{n({variant:"destructive",title:s(`${f.get(t,"response.statusText","Error")}`),description:s(`${f.get(t,"response.data.message","An error occurred. Contact the administrator")}`)})},onSuccess:()=>{e.reset(),o==null||o(),n({variant:"success",title:s("Success"),description:s(r?"F54 updated successfully":"F54 created successfully")})}}}),_=u.useCallback(t=>{c.mutate(t)},[c]);return console.log(e.formState.errors),{form:e,handleSubmit:_}};export{O as u};
