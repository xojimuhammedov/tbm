import{a as t,q as x,r as p,i as g,j as n,k as I,z as a,Q as q}from"./index-ADhmmBpU.js";import{P as j}from"./PageHeader-l3FtlNyv.js";import{P as v}from"./PageWrapper-D7EWSq9s.js";import{l as b}from"./lodash-BI9_Ro3R.js";import"./index.es-njk8-3Q7.js";import{u as _,c as L}from"./button-Bp2lHjov-bkEUXTzY.js";import"./sidebar-C0lF1Npi.js";import{F}from"./FormContainerFooter-M0H-Jjey.js";import{u as S}from"./useGetOne-DA0KuYmv.js";import{u as D,a as T}from"./useMutate-B2j67kPQ.js";import{o as w,s as l,a as G}from"./zod-BQt-Wj8X.js";import{M as h}from"./MutateRequestMethod-D0dsk-6r.js";import{F as A}from"./flows.constants-Dopgbqvl.js";import{A as z}from"./arrow-left-Bv-o5b3i.js";import"./createLucideIcon-B950nf2d-ChSZaRdU.js";import"./Spin-D_PNnV0x.js";import"./useApi-BNT2PGFQ.js";const E=e=>w({id_number:l().nonempty(e("required {{field}}",{field:e("Column 1"),ns:t.LANG.NS.VALIDATION})),consumer_id_point_a:l().nonempty(e("required {{field}}",{field:e("Consumer ID point A"),ns:t.LANG.NS.VALIDATION})),consumer_name_point_b:l().nonempty(e("required {{field}}",{field:e("International"),ns:t.LANG.NS.VALIDATION})),point_a:l().nonempty(e("required {{field}}",{field:e("Forward"),ns:t.LANG.NS.VALIDATION})),point_b:l().nonempty(e("required {{field}}",{field:e("Reverse"),ns:t.LANG.NS.VALIDATION})),signal_level:l().nonempty(e("required {{field}}",{field:e("Start"),ns:t.LANG.NS.VALIDATION})),organization_order_number:l().nonempty(e("required {{field}}",{field:e("Port A"),ns:t.LANG.NS.VALIDATION})),deciphering_order_number:l().nonempty(e("required {{field}}",{field:e("MUX A"),ns:t.LANG.NS.VALIDATION})),note:l().nonempty(e("required {{field}}",{field:e("PA"),ns:t.LANG.NS.VALIDATION})),deciphering_archive:l().nonempty(e("required {{field}}",{field:e("Final MS name"),ns:t.LANG.NS.VALIDATION})),organization_archive:l().nonempty(e("required {{field}}",{field:e("Signal transmission level"),ns:t.LANG.NS.VALIDATION}))}),V=({id:e,onSave:d})=>{const{t:o}=_(),{toast:r}=x(),s=p.useMemo(()=>E(o),[o]),c=D({resolver:G(s)}),m=S({url:[A,e||""],options:{enabled:!!e}}),{query:u}=T({url:[A,e||""],method:e?h.PUT:h.POST,options:{onError:i=>{r({variant:"destructive",title:o(`${b.get(i,"response.statusText","Error")}`),description:o(`${b.get(i,"response.data.message","An error occurred. Contact the administrator")}`)})},onSuccess:()=>{c.reset(),d==null||d(),r({variant:"success",title:o("Success"),description:o(e?"Flow updated successfully":"Flow created successfully")})}}});p.useEffect(()=>{var f;const i=(f=m.data)==null?void 0:f.data;i&&c.reset({consumer_id_point_a:i.consumer_id_point_a,id_number:i.id_number,consumer_name_point_b:i.consumer_name_point_b,point_a:i.point_a,point_b:i.point_b,signal_level:i.signal_level,organization_order_number:i.organization_order_number,deciphering_order_number:i.deciphering_order_number,note:i.note,deciphering_archive:i.deciphering_archive,organization_archive:i.organization_archive})},[m.data,c]);const N=p.useCallback(i=>{u.mutate(i)},[u]);return{form:c,onSubmit:N}},P=({id:e,onSave:d,readOnly:o=!1})=>{const{t:r}=_(),{form:s,onSubmit:c}=V({id:e,onSave:d}),m=g(),u=e?`${r("Edit")} ${r("Flows ID")}`:`${r("Create")} ${r("Flows ID")}`;return n.jsx(I,{...s,children:n.jsxs("form",{onSubmit:s.handleSubmit(c),className:"space-y-4",children:[n.jsx("h2",{className:"text-xl font-medium",children:u}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsx(a,{control:s.control,name:"id_number",label:r("ID nomer"),placeholder:r("Enter ID nomer"),required:!0,disabled:o}),n.jsx(a,{control:s.control,name:"consumer_id_point_a",label:r("Наименование A"),placeholder:r("Наименование A"),required:!0,disabled:o}),n.jsx(a,{control:s.control,name:"consumer_name_point_b",label:r("Наименование B"),placeholder:r("Наименование B"),required:!0,disabled:o}),n.jsx(a,{control:s.control,name:"point_a",label:r("Пункт A"),placeholder:r("Пункт B"),required:!0,disabled:o}),n.jsx(a,{control:s.control,name:"point_b",label:r("Пункт B"),placeholder:r("Пункт B"),required:!0,disabled:o}),n.jsx(a,{control:s.control,name:"signal_level",label:r("Уровень сигнала"),placeholder:r("Уровень сигнала"),required:!0,disabled:o}),n.jsx(a,{control:s.control,name:"organization_order_number",label:r("Номер распоряжения на организацию"),placeholder:r("Номер распоряжения на организацию"),required:!0,disabled:o}),n.jsx(a,{control:s.control,name:"deciphering_order_number",label:r("Номер распоряжения на расформирование"),placeholder:r("Номер распоряжения на расформирование"),required:!0,disabled:o}),n.jsx(a,{control:s.control,name:"note",label:r("Примечание"),placeholder:r("Примечание"),required:!0,disabled:o}),n.jsx(a,{control:s.control,name:"deciphering_archive",label:r("Архив распоряжения"),placeholder:r("Архив распоряжения"),required:!0,disabled:o}),n.jsx(a,{control:s.control,name:"organization_archive",label:r("Архив организации"),placeholder:r("Архив организации"),required:!0,disabled:o})]}),!o&&n.jsx(F,{children:n.jsxs(L,{size:"sm",variant:"ghost",type:"button",onClick:()=>m("/flows-5_1"),children:[n.jsx(z,{}),r("Back")]})})]})})},ee=()=>{const{t:e}=_(),d=g(),{id:o}=q(),r=p.useMemo(()=>[{name:e("Resource Database"),path:"/",isActive:!1},{name:e("Flows ID"),path:"/flows-id",isActive:!1},{name:e(o?"Edit":"Create"),path:o?`/flows-id/edit/${o}`:"/flows-id/create",isActive:!0}],[o,e]);return n.jsxs(n.Fragment,{children:[n.jsx(j,{className:"sticky top-0",breadcrumbs:r}),n.jsx(v,{children:n.jsx(P,{id:o||null,onSave:()=>d("/flows-id")})})]})};export{ee as default};
