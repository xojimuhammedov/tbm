import{a as i,q as I,r as p,i as A,j as o,k as g,z as a,Q as j}from"./index-ADhmmBpU.js";import{P as q}from"./PageHeader-l3FtlNyv.js";import{P as C}from"./PageWrapper-D7EWSq9s.js";import{l as h}from"./lodash-BI9_Ro3R.js";import"./index.es-njk8-3Q7.js";import{u as b,c as L}from"./button-Bp2lHjov-bkEUXTzY.js";import"./sidebar-C0lF1Npi.js";import{F as v}from"./FormContainerFooter-M0H-Jjey.js";import{u as D}from"./useGetOne-DA0KuYmv.js";import{u as S,a as T}from"./useMutate-B2j67kPQ.js";import{o as E,s as l,a as G}from"./zod-BQt-Wj8X.js";import{M as _}from"./MutateRequestMethod-D0dsk-6r.js";import{C as N}from"./channels.constants-CEa8zlM5.js";import{A as V}from"./arrow-left-Bv-o5b3i.js";import"./createLucideIcon-B950nf2d-ChSZaRdU.js";import"./Spin-D_PNnV0x.js";import"./useApi-BNT2PGFQ.js";const k=e=>E({id_number:l().nonempty(e("required {{field}}",{field:e("Code"),ns:i.LANG.NS.VALIDATION})),consumer_name:l().nonempty(e("required {{field}}",{field:e("Stream identifier"),ns:i.LANG.NS.VALIDATION})),point_a:l().nonempty(e("required {{field}}",{field:e("International stream number"),ns:i.LANG.NS.VALIDATION})),point_b:l().nonempty(e("required {{field}}",{field:e("Forward stream interaction number"),ns:i.LANG.NS.VALIDATION})),link_N1:l().nonempty(e("required {{field}}",{field:e("Reverse stream interaction number"),ns:i.LANG.NS.VALIDATION})),connection_number:l().nonempty(e("required {{field}}",{field:e("Connection number"),ns:i.LANG.NS.VALIDATION})),organization_order_number:l().nonempty(e("required {{field}}",{field:e("Connection number"),ns:i.LANG.NS.VALIDATION})),deciphering_notes:l().nonempty(e("required {{field}}",{field:e("Connection number"),ns:i.LANG.NS.VALIDATION})),is_archived:l().nonempty(e("required {{field}}",{field:e("Connection number"),ns:i.LANG.NS.VALIDATION})),verification_status:l().nonempty(e("required {{field}}",{field:e("Connection number"),ns:i.LANG.NS.VALIDATION}))}),y=({id:e,onSave:c})=>{const{t:r}=b(),{toast:n}=I(),s=p.useMemo(()=>k(r),[r]),d=S({resolver:G(s)}),m=D({url:[N,e||""],options:{enabled:!!e}}),{query:u}=T({url:[N,e||""],method:e?_.PUT:_.POST,options:{onError:t=>{n({variant:"destructive",title:r(`${h.get(t,"response.statusText","Error")}`),description:r(`${h.get(t,"response.data.message","An error occurred. Contact the administrator")}`)})},onSuccess:()=>{d.reset(),c==null||c(),n({variant:"success",title:r("Success"),description:r(e?"Channel updated successfully":"Channel created successfully")})}}});p.useEffect(()=>{var f;const t=(f=m.data)==null?void 0:f.data;t&&d.reset({id_number:t.id_number,consumer_name:t.consumer_name,connection_number:t.connection_number,point_a:t.point_a,point_b:t.point_b,link_N1:t.link_N1,organization_order_number:t.organization_order_number,deciphering_notes:t.deciphering_notes,is_archived:t.is_archived,verification_status:t.verification_status})},[m.data,d]);const x=p.useCallback(t=>{u.mutate(t)},[u]);return{form:d,onSubmit:x}},F=({id:e,onSave:c,readOnly:r=!1})=>{const{t:n}=b(),{form:s,onSubmit:d}=y({id:e,onSave:c}),m=A(),u=e?`${n("Edit")} ${n("Channels ID")}`:`${n("Create")} ${n("Channels ID")}`;return o.jsx(g,{...s,children:o.jsxs("form",{onSubmit:s.handleSubmit(d),className:"space-y-4",children:[o.jsx("h2",{className:"text-xl font-medium",children:u}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsx(a,{control:s.control,name:"id_number",label:n("ID номера"),placeholder:n("ID номера"),required:!0,disabled:r}),o.jsx(a,{control:s.control,name:"consumer_name",label:n("Наименование потребителя"),placeholder:n("Наименование потребителя"),required:!0,disabled:r}),o.jsx(a,{control:s.control,name:"connection_number",label:n("Номер связи"),placeholder:n("Номер связи"),required:!0,disabled:r}),o.jsx(a,{control:s.control,name:"point_a",label:n("Пункт А"),placeholder:n("Пункт А"),required:!0,disabled:r}),o.jsx(a,{control:s.control,name:"point_b",label:n("Пункт B"),placeholder:n("Пункт B"),required:!0,disabled:r}),o.jsx(a,{control:s.control,name:"link_N1",label:n("Линк №1"),placeholder:n("Линк №1"),required:!0,disabled:r}),o.jsx(a,{control:s.control,name:"organization_order_number",label:n("распоряжения на орг"),placeholder:n("распоряжения на орг"),required:!0,disabled:r}),o.jsx(a,{control:s.control,name:"deciphering_notes",label:n("Примечания расформиров"),placeholder:n("Примечания расформиров"),required:!0,disabled:r}),o.jsx(a,{control:s.control,name:"is_archived",label:n("архив"),placeholder:n("архив"),required:!0,disabled:r}),o.jsx(a,{control:s.control,name:"verification_status",label:n("Сверка"),placeholder:n("Сверка"),required:!0,disabled:r})]}),!r&&o.jsx(v,{children:o.jsxs(L,{size:"sm",variant:"ghost",type:"button",onClick:()=>m("/channels-5_3"),children:[o.jsx(V,{}),n("Back")]})})]})})},ee=()=>{const{t:e}=b(),c=A(),{id:r}=j(),n=p.useMemo(()=>[{name:e("Resource Database"),path:"/",isActive:!1},{name:e("Channels ID"),path:"/channels-id",isActive:!1},{name:e(r?"Edit":"Create"),path:r?`/channels-id/edit/${r}`:"/channels-id/create",isActive:!0}],[r,e]);return o.jsxs(o.Fragment,{children:[o.jsx(q,{className:"sticky top-0",breadcrumbs:n}),o.jsx(C,{children:o.jsx(F,{id:r||null,onSave:()=>c("/channels-id")})})]})};export{ee as default};
