import{a as i,q as y,r as N,j as e,k as T,z as o,X as g,i as S,Q as V}from"./index-ADhmmBpU.js";import{P as L}from"./PageHeader-l3FtlNyv.js";import{P as q}from"./PageWrapper-D7EWSq9s.js";import{l as p}from"./lodash-BI9_Ro3R.js";import{r as O}from"./index.es-njk8-3Q7.js";import{u as P,a as D}from"./useMutate-B2j67kPQ.js";import{o as k,s as n,b as j,a as G}from"./zod-BQt-Wj8X.js";import{M as A}from"./MutateRequestMethod-D0dsk-6r.js";import{u as U,R}from"./useRTTSIDocument-Bhne8kUd.js";import{u as h,c as v}from"./button-Bp2lHjov-bkEUXTzY.js";import{F as z}from"./FilePondComponent-B-yE-IPb.js";import{u as B,S as C}from"./useStaffOptions-CXWN6ZMm.js";import{S as F}from"./MySelect-CDOMHlry-CVNRsqeU.js";import"./sidebar-C0lF1Npi.js";import"./createLucideIcon-B950nf2d-ChSZaRdU.js";import"./useApi-BNT2PGFQ.js";import"./useGetOne-DA0KuYmv.js";import"./react-filepond.esm-B2oG36mQ.js";import"./useLists-DBTxrMAi.js";import"./useQueryParams-Dns8Zny6.js";import"./staff.constants-D5gKBh84.js";const E=s=>k({title:n().nonempty(s("required {{field}}",{field:s("Document title"),ns:i.LANG.NS.VALIDATION})),files:j(n()).nonempty(s("required {{field}}",{field:s("Files"),ns:i.LANG.NS.VALIDATION})),recipientIds:j(n()).nonempty(s("required {{field}}",{field:s("Staffs"),ns:i.LANG.NS.VALIDATION})),description:n().optional(),UbpNumber:n().nonempty(s("required {{field}}",{field:s("UBP number"),ns:i.LANG.NS.VALIDATION})),applicationNumber:n().nonempty(s("required {{field}}",{field:s("Application number"),ns:i.LANG.NS.VALIDATION})),workConditions:n().nonempty(s("required {{field}}",{field:s("Work conditions"),ns:i.LANG.NS.VALIDATION})),date:n().nonempty(s("required {{field}}",{field:s("UBP number"),ns:i.LANG.NS.VALIDATION})),magistralName:n().nonempty(s("required {{field}}",{field:s("UBP number"),ns:i.LANG.NS.VALIDATION})),NoNumber:n().nonempty(s("required {{field}}",{field:s("UBP number"),ns:i.LANG.NS.VALIDATION})),ai9Channels:n().nonempty(s("required {{field}}",{field:s("UBP number"),ns:i.LANG.NS.VALIDATION})),reasonJob:n().nonempty(s("required {{field}}",{field:s("Reason Job"),ns:i.LANG.NS.VALIDATION})),jobDescription:n().nonempty(s("required {{field}}",{field:s("Job description"),ns:i.LANG.NS.VALIDATION})),NOStatus:n().nonempty(s("required {{field}}",{field:s("NO status"),ns:i.LANG.NS.VALIDATION})),aag:n().nonempty(s("required {{field}}",{field:s("AAG"),ns:i.LANG.NS.VALIDATION})),reservation:n().nonempty(s("required {{field}}",{field:s("Reservation"),ns:i.LANG.NS.VALIDATION})),responsiblePerson:n().nonempty(s("required {{field}}",{field:s("UBP number"),ns:i.LANG.NS.VALIDATION})),headOfTheEnterprise:n().nonempty(s("required {{field}}",{field:s("Head of the enterprise"),ns:i.LANG.NS.VALIDATION})),aiFullName:n().nonempty(s("required {{field}}",{field:s("AI-9 full name"),ns:i.LANG.NS.VALIDATION})),applicantAP:n().nonempty(s("required {{field}}",{field:s("Applicant AP"),ns:i.LANG.NS.VALIDATION})),applicantUBP:n().nonempty(s("required {{field}}",{field:s("Applicant UBP"),ns:i.LANG.NS.VALIDATION}))}),w=({id:s,onSave:d})=>{const{t}=h(),{toast:a}=y(),{rttsiDocumentQuery:c}=U(s),r=P({resolver:G(E(t)),defaultValues:{files:[]},mode:"onChange"});N.useEffect(()=>{var b,x;const l=(b=c.data)==null?void 0:b.data;if(l){r.setValue("title",l.title),r.setValue("UbpNumber",l.UbpNumber),r.setValue("applicationNumber",l.applicationNumber),r.setValue("workConditions",l.workConditions),r.setValue("date",l.date),r.setValue("magistralName",l.magistralName),r.setValue("NoNumber",l.NoNumber),r.setValue("ai9Channels",l.ai9Channels),r.setValue("reasonJob",l.reasonJob),r.setValue("jobDescription",l.jobDescription),r.setValue("NOStatus",l.NOStatus),r.setValue("aag",l.aag),r.setValue("reservation",l.reservation),r.setValue("responsiblePerson",l.responsiblePerson),r.setValue("headOfTheEnterprise",l.headOfTheEnterprise),r.setValue("aiFullName",l.aiFullName),r.setValue("applicantAP",l.applicantAP),r.setValue("applicantUBP",l.applicantUBP),r.setValue("description",l.description),r.setValue("files",l.files);const f=((x=l.recipientIds)==null?void 0:x.map(I=>I._id))??[];r.setValue("recipientIds",f.length>0?f:[""])}},[c.data,r]);const{query:m}=D({url:[R,s||""],method:s?A.PUT:A.POST,options:{onError:l=>{a({variant:"destructive",title:t(`${p.get(l,"response.statusText","Error")}`),description:t(`${p.get(l,"response.data.message","An error occurred. Contact the administrator")}`)})},onSuccess:()=>{r.reset(),d==null||d(),a({variant:"success",title:t("Success"),description:t(s?"RTTSI updated successfully":"RTTSI created successfully")})}}}),u=N.useCallback(l=>{m.mutate(l)},[m]);return{id:s,form:r,handleSubmit:u}},M=({id:s,onSave:d,onCancel:t})=>{const{t:a}=h(),{staffOptions:c}=B(),{form:r,handleSubmit:m}=w({id:s,onSave:d});return e.jsx(T,{...r,children:e.jsx("form",{onSubmit:r.handleSubmit(m),className:"py-6 px-4",children:e.jsxs("div",{className:"max-w-5xl mx-auto px-2",children:[e.jsxs("div",{className:"rounded-lg shadow-sm border-2 p-8",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(o,{className:"border-none rounded-none w-48",required:!0,control:r.control,name:"title",placeholder:a("RH 45-232/2012")})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-1",children:a("D ilova")}),e.jsx("p",{className:"text-gray-600 mb-3",children:a("(Majburiy)")}),e.jsx("p",{className:"text-body-lg-regular",children:"Rejadan tashqari ta’mirlash-sozlash ishlarini o’tkazish uchun <br /> talabnomani taqdim etish shakli"})]}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsxs("div",{className:"flex justify-center items-center gap-4 mb-3",children:[e.jsx("div",{className:"",children:e.jsx(o,{required:!0,control:r.control,size:4,className:"flex-1 border border-t-0 border-l-0 border-r-0 rounded-none h-6",name:"UbpNumber",placeholder:a("Raqam")})}),e.jsx("div",{className:"mt-2",children:a("UBPdan")})]}),e.jsx("div",{className:"mb-2",children:a("rejadan tashqari ta’mirlash-sozlash ishlarini o’tkazish uchun")}),e.jsxs("div",{className:"flex justify-center items-center gap-4 mb-3",children:[e.jsx(o,{required:!0,control:r.control,size:4,className:"border border-t-0 border-l-0 border-r-0 rounded-none h-6",name:"applicationNumber"}),e.jsxs("div",{className:"mt-2",children:[" - ",a("son TALABNOMA")]})]})]}),e.jsxs("div",{className:"space-y-2 px-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"mt-4",children:["1. ",a("Ishlarni o'tkazish shartlari"),":"]}),e.jsx("div",{className:"flex-1",children:e.jsx(o,{control:r.control,className:"border border-t-0 border-l-0 border-r-0 rounded-none",name:"workConditions",placeholder:a("Yopib / yopmasdan / QBT bilan")})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"mt-4",children:"2. Sana va vaqt:"}),e.jsx("div",{className:"flex-1",children:e.jsx(o,{control:r.control,className:"border border-t-0 border-l-0 border-r-0 rounded-none",name:"date",placeholder:a("Ishlarni o'tkazish sanasi, oyi, yili, soati, minuti")})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"mt-4",children:["3. ",a("Uchastka, stansiyalar")]}),e.jsx("div",{className:"flex-1",children:e.jsx(o,{control:r.control,className:"border border-t-0 border-l-0 border-r-0 rounded-none",name:"magistralName",placeholder:a("Magistral nomi, AP nomeri")})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"mt-4",children:["4. ",a("NO nomeri")]}),e.jsx("div",{className:"flex-1",children:e.jsx(o,{control:r.control,className:"border border-t-0 border-l-0 border-r-0 rounded-none",name:"NoNumber",placeholder:a("O’tkazish liniyasi, liniya / guruh trantor va hk")})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"mt-4",children:["5. ",a("Al-9 kanallari")]}),e.jsx("div",{className:"flex-1",children:e.jsx(o,{control:r.control,className:"border border-t-0 border-l-0 border-r-0 rounded-none",name:"ai9Channels",placeholder:a("Bor / yo'q")})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"mt-4",children:"6. "}),e.jsx("div",{className:"flex-1",children:e.jsx(o,{control:r.control,className:"border border-t-0 border-l-0 border-r-0 rounded-none",name:"reasonJob",placeholder:a("Ishni bajarish sababi")})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"mt-4",children:"7."}),e.jsx("div",{className:"flex-1",children:e.jsx(o,{control:r.control,className:"border border-t-0 border-l-0 border-r-0 rounded-none",name:"jobDescription",placeholder:a("Bajarilayotgan ishlar xususiyati")})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"mt-4",children:["8. ",a("NO holati")]}),e.jsx("div",{className:"flex-1",children:e.jsx(o,{control:r.control,className:"border border-t-0 border-l-0 border-r-0 rounded-none",name:"NOStatus",placeholder:a("Bajarilayotgan ishlar xususiyati")})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"mt-4",children:["9. ",a("AAG")]}),e.jsx("div",{className:"flex-1",children:e.jsx(o,{control:r.control,className:"border border-t-0 border-l-0 border-r-0 rounded-none",name:"aag",placeholder:a("Bajarilayotgan ishlar xususiyati")})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"mt-4",children:"10."}),e.jsx("div",{className:"flex-1",children:e.jsx(o,{control:r.control,className:"border border-t-0 border-l-0 border-r-0 rounded-none",name:"reservation",placeholder:a("Rezervlashning boshqa usuli")})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"mt-4",children:["11. ",a("Rahbar stantsiyasi")]}),e.jsx("div",{className:"flex-1",children:e.jsx(o,{control:r.control,className:"border border-t-0 border-l-0 border-r-0 rounded-none",name:"responsiblePerson",placeholder:a("Ishlarni o’tkazish uchun javobgar shaxs")})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"mt-4",children:["12. ",a("Kelishilgan")]}),e.jsx("div",{className:"flex-1",children:e.jsx(o,{control:r.control,className:"border border-t-0 border-l-0 border-r-0 rounded-none",name:"headOfTheEnterprise",placeholder:a("“O’zbekiston” AK ekspluatasiya qiluvchi korxona texnik rahbari")})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"mt-4",children:["13. ",a("Kelishilgan")]}),e.jsx("div",{className:"flex-1",children:e.jsx(o,{control:r.control,className:"border border-t-0 border-l-0 border-r-0 rounded-none",name:"aiFullName",placeholder:"AI-9 F.I.Sh. (Joylarda)"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"mt-4",children:["14. ",a("Talabnoma tuzuvchi (AP)")]}),e.jsx("div",{className:"flex-1",children:e.jsx(o,{control:r.control,className:"border border-t-0 border-l-0 border-r-0 rounded-none",name:"applicantAP",placeholder:a("Talabnomaning sanasi, vaqti, raqami")})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"mt-4",children:["15. ",a("Talabnoma tuzuvchi (UBP)")]}),e.jsx("div",{className:"flex-1",children:e.jsx(o,{control:r.control,className:"border border-t-0 border-l-0 border-r-0 rounded-none",name:"applicantUBP",placeholder:a("Sana, vaqt, imzo")})})]})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx(z,{labelIdle:a("Qo'shimcha biriktrilgan fayllar"),allowProcess:!1,instantUpload:!0,maxFiles:1,docType:"f56",onFinishUpload:u=>{r.setValue("files",[`${p.get(u,"path")}`])}})}),e.jsx(O,{className:"min-h-[150px]",control:r.control,name:"description",placeholder:a("Izoh")}),e.jsx(F,{control:r.control,name:"recipientIds",options:c||[],label:a("Yuboriladigan xodimlar"),placeholder:a("Select staffs"),isClearable:!0,required:!0,isMulti:!0}),e.jsxs("div",{className:"flex items-center justify-between mt-8 pt-6 border-t",children:[e.jsxs(v,{type:"button",variant:"secondary",onClick:t,children:[e.jsx(g,{className:"size-4"}),a("Bekor qilish")]}),e.jsxs(v,{type:"submit",children:[e.jsx(C,{className:"size-4"}),a("Yuborish")]})]})]})})})},me=()=>{const{t:s}=h(),d=S(),{id:t}=V(),a=N.useMemo(()=>[{name:s("RTTSI"),path:"rttsi",isActive:!1},{name:s("RTTSI document"),path:"rttsi",isActive:!1},{name:s(t?"Edit":"Create"),path:t?`${t}/edit`:"create",isActive:!0}],[t,s]);return e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"sticky top-0",breadcrumbs:a}),e.jsx(q,{children:e.jsx(M,{id:t,onSave:()=>d("/rttsi"),onCancel:()=>d("/rttsi")})})]})};export{me as default};
