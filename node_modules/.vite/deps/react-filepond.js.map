{
  "version": 3,
  "sources": ["../../react-filepond/dist/react-filepond.esm.js", "../../filepond/dist/filepond.esm.js"],
  "sourcesContent": ["/*!\r\n * react-filepond v7.1.3\r\n * A handy FilePond adapter component for React\r\n * \r\n * Copyright (c) 2024 PQINA\r\n * https://pqina.nl/filepond\r\n * \r\n * Licensed under the MIT license.\r\n */\r\n\r\nimport React, { createElement, useCallback } from \"react\";\r\n\r\n// Import required methods and styles from the FilePond module, should not need anything else\r\nimport { create, supported, registerPlugin, FileStatus } from \"filepond\";\r\n\r\n// We need to be able to call the registerPlugin method directly so we can add plugins\r\nexport { registerPlugin, FileStatus };\r\n\r\n// Do this once\r\nconst isSupported = supported();\r\n\r\n// filtered methods\r\nconst filteredMethods = [\r\n  \"setOptions\",\r\n  \"on\",\r\n  \"off\",\r\n  \"onOnce\",\r\n  \"appendTo\",\r\n  \"insertAfter\",\r\n  \"insertBefore\",\r\n  \"isAttachedTo\",\r\n  \"replaceElement\",\r\n  \"restoreElement\",\r\n  \"destroy\",\r\n];\r\n\r\n// The React <FilePond/> wrapper\r\nexport class FilePond extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.allowFilesSync = true;\r\n  }\r\n\r\n  // Will setup FilePond instance when mounted\r\n  componentDidMount() {\r\n    // clone the input so we can restore it in unmount\r\n    this._input = this._element.querySelector('input[type=\"file\"]');\r\n    this._inputClone = this._input.cloneNode();\r\n\r\n    // exit here if not supported\r\n    if (!isSupported) return;\r\n\r\n    const options = Object.assign({}, this.props);\r\n\r\n    // if onupdate files is defined, make sure setFiles does not cause race condition\r\n    if (options.onupdatefiles) {\r\n      const cb = options.onupdatefiles;\r\n      options.onupdatefiles = (items) => {\r\n        this.allowFilesSync = false;\r\n        cb(items);\r\n      };\r\n    }\r\n\r\n    // Create our pond\r\n    this._pond = create(this._input, options);\r\n\r\n    // Reference pond methods to FilePond component instance\r\n    Object.keys(this._pond)\r\n      .filter((key) => !filteredMethods.includes(key))\r\n      .forEach((key) => {\r\n        this[key] = this._pond[key];\r\n      });\r\n  }\r\n\r\n  // Will clean up FilePond instance when unmounted\r\n  componentWillUnmount() {\r\n    // exit when no pond defined\r\n    if (!this._pond) return;\r\n\r\n    // This fixed <Strict> errors\r\n\r\n    // FilePond destroy is async so we have to move FilePond to a bin element so it can no longer affect current element tree as React unmount / mount is sync\r\n    const bin = document.createElement(\"div\");\r\n    bin.append(this._pond.element);\r\n    bin.id = \"foo\";\r\n\r\n    // now we call destroy so FilePond can start it's destroy logic\r\n    this._pond.destroy();\r\n    this._pond = undefined;\r\n\r\n    // we re-add the original file input element so everything is as it was before\r\n    this._element.append(this._inputClone);\r\n  }\r\n\r\n  shouldComponentUpdate() {\r\n    if (!this.allowFilesSync) {\r\n      this.allowFilesSync = true;\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  // Something changed\r\n  componentDidUpdate() {\r\n    // exit when no pond defined\r\n    if (!this._pond) return;\r\n\r\n    const options = Object.assign({}, this.props);\r\n\r\n    // this is only set onces, on didmount\r\n    delete options.onupdatefiles;\r\n\r\n    // update pond options based on new props\r\n    this._pond.setOptions(options);\r\n  }\r\n\r\n  // Renders basic element hook for FilePond to attach to\r\n  render() {\r\n    const {\r\n      id,\r\n      name,\r\n      className,\r\n      allowMultiple,\r\n      required,\r\n      captureMethod,\r\n      acceptedFileTypes,\r\n    } = this.props;\r\n    return createElement(\r\n      \"div\",\r\n      {\r\n        className: \"filepond--wrapper\",\r\n        ref: (element) => (this._element = element),\r\n      },\r\n      createElement(\"input\", {\r\n        type: \"file\",\r\n        name,\r\n        id,\r\n        accept: acceptedFileTypes,\r\n        multiple: allowMultiple,\r\n        required: required,\r\n        className: className,\r\n        capture: captureMethod,\r\n      })\r\n    );\r\n  }\r\n}\r\n\r\n", "/*!\r\n * FilePond 4.32.9\r\n * Licensed under MIT, https://opensource.org/licenses/MIT/\r\n * Please visit https://pqina.nl/filepond/ for details.\r\n */\r\n\r\n/* eslint-disable */\r\n\r\nconst isNode = value => value instanceof HTMLElement;\r\n\r\nconst createStore = (initialState, queries = [], actions = []) => {\r\n    // internal state\r\n    const state = {\r\n        ...initialState,\r\n    };\r\n\r\n    // contains all actions for next frame, is clear when actions are requested\r\n    const actionQueue = [];\r\n    const dispatchQueue = [];\r\n\r\n    // returns a duplicate of the current state\r\n    const getState = () => ({ ...state });\r\n\r\n    // returns a duplicate of the actions array and clears the actions array\r\n    const processActionQueue = () => {\r\n        // create copy of actions queue\r\n        const queue = [...actionQueue];\r\n\r\n        // clear actions queue (we don't want no double actions)\r\n        actionQueue.length = 0;\r\n\r\n        return queue;\r\n    };\r\n\r\n    // processes actions that might block the main UI thread\r\n    const processDispatchQueue = () => {\r\n        // create copy of actions queue\r\n        const queue = [...dispatchQueue];\r\n\r\n        // clear actions queue (we don't want no double actions)\r\n        dispatchQueue.length = 0;\r\n\r\n        // now dispatch these actions\r\n        queue.forEach(({ type, data }) => {\r\n            dispatch(type, data);\r\n        });\r\n    };\r\n\r\n    // adds a new action, calls its handler and\r\n    const dispatch = (type, data, isBlocking) => {\r\n        // is blocking action (should never block if document is hidden)\r\n        if (isBlocking && !document.hidden) {\r\n            dispatchQueue.push({ type, data });\r\n            return;\r\n        }\r\n\r\n        // if this action has a handler, handle the action\r\n        if (actionHandlers[type]) {\r\n            actionHandlers[type](data);\r\n        }\r\n\r\n        // now add action\r\n        actionQueue.push({\r\n            type,\r\n            data,\r\n        });\r\n    };\r\n\r\n    const query = (str, ...args) => (queryHandles[str] ? queryHandles[str](...args) : null);\r\n\r\n    const api = {\r\n        getState,\r\n        processActionQueue,\r\n        processDispatchQueue,\r\n        dispatch,\r\n        query,\r\n    };\r\n\r\n    let queryHandles = {};\r\n    queries.forEach(query => {\r\n        queryHandles = {\r\n            ...query(state),\r\n            ...queryHandles,\r\n        };\r\n    });\r\n\r\n    let actionHandlers = {};\r\n    actions.forEach(action => {\r\n        actionHandlers = {\r\n            ...action(dispatch, query, state),\r\n            ...actionHandlers,\r\n        };\r\n    });\r\n\r\n    return api;\r\n};\r\n\r\nconst defineProperty = (obj, property, definition) => {\r\n    if (typeof definition === 'function') {\r\n        obj[property] = definition;\r\n        return;\r\n    }\r\n    Object.defineProperty(obj, property, { ...definition });\r\n};\r\n\r\nconst forin = (obj, cb) => {\r\n    for (const key in obj) {\r\n        if (!obj.hasOwnProperty(key)) {\r\n            continue;\r\n        }\r\n\r\n        cb(key, obj[key]);\r\n    }\r\n};\r\n\r\nconst createObject = definition => {\r\n    const obj = {};\r\n    forin(definition, property => {\r\n        defineProperty(obj, property, definition[property]);\r\n    });\r\n    return obj;\r\n};\r\n\r\nconst attr = (node, name, value = null) => {\r\n    if (value === null) {\r\n        return node.getAttribute(name) || node.hasAttribute(name);\r\n    }\r\n    node.setAttribute(name, value);\r\n};\r\n\r\nconst ns = 'http://www.w3.org/2000/svg';\r\nconst svgElements = ['svg', 'path']; // only svg elements used\r\n\r\nconst isSVGElement = tag => svgElements.includes(tag);\r\n\r\nconst createElement = (tag, className, attributes = {}) => {\r\n    if (typeof className === 'object') {\r\n        attributes = className;\r\n        className = null;\r\n    }\r\n    const element = isSVGElement(tag)\r\n        ? document.createElementNS(ns, tag)\r\n        : document.createElement(tag);\r\n    if (className) {\r\n        if (isSVGElement(tag)) {\r\n            attr(element, 'class', className);\r\n        } else {\r\n            element.className = className;\r\n        }\r\n    }\r\n    forin(attributes, (name, value) => {\r\n        attr(element, name, value);\r\n    });\r\n    return element;\r\n};\r\n\r\nconst appendChild = parent => (child, index) => {\r\n    if (typeof index !== 'undefined' && parent.children[index]) {\r\n        parent.insertBefore(child, parent.children[index]);\r\n    } else {\r\n        parent.appendChild(child);\r\n    }\r\n};\r\n\r\nconst appendChildView = (parent, childViews) => (view, index) => {\r\n    if (typeof index !== 'undefined') {\r\n        childViews.splice(index, 0, view);\r\n    } else {\r\n        childViews.push(view);\r\n    }\r\n\r\n    return view;\r\n};\r\n\r\nconst removeChildView = (parent, childViews) => view => {\r\n    // remove from child views\r\n    childViews.splice(childViews.indexOf(view), 1);\r\n\r\n    // remove the element\r\n    if (view.element.parentNode) {\r\n        parent.removeChild(view.element);\r\n    }\r\n\r\n    return view;\r\n};\r\n\r\nconst IS_BROWSER = (() =>\r\n    typeof window !== 'undefined' && typeof window.document !== 'undefined')();\r\nconst isBrowser = () => IS_BROWSER;\r\n\r\nconst testElement = isBrowser() ? createElement('svg') : {};\r\nconst getChildCount =\r\n    'children' in testElement ? el => el.children.length : el => el.childNodes.length;\r\n\r\nconst getViewRect = (elementRect, childViews, offset, scale) => {\r\n    const left = offset[0] || elementRect.left;\r\n    const top = offset[1] || elementRect.top;\r\n    const right = left + elementRect.width;\r\n    const bottom = top + elementRect.height * (scale[1] || 1);\r\n\r\n    const rect = {\r\n        // the rectangle of the element itself\r\n        element: {\r\n            ...elementRect,\r\n        },\r\n\r\n        // the rectangle of the element expanded to contain its children, does not include any margins\r\n        inner: {\r\n            left: elementRect.left,\r\n            top: elementRect.top,\r\n            right: elementRect.right,\r\n            bottom: elementRect.bottom,\r\n        },\r\n\r\n        // the rectangle of the element expanded to contain its children including own margin and child margins\r\n        // margins will be added after we've recalculated the size\r\n        outer: {\r\n            left,\r\n            top,\r\n            right,\r\n            bottom,\r\n        },\r\n    };\r\n\r\n    // expand rect to fit all child rectangles\r\n    childViews\r\n        .filter(childView => !childView.isRectIgnored())\r\n        .map(childView => childView.rect)\r\n        .forEach(childViewRect => {\r\n            expandRect(rect.inner, { ...childViewRect.inner });\r\n            expandRect(rect.outer, { ...childViewRect.outer });\r\n        });\r\n\r\n    // calculate inner width and height\r\n    calculateRectSize(rect.inner);\r\n\r\n    // append additional margin (top and left margins are included in top and left automatically)\r\n    rect.outer.bottom += rect.element.marginBottom;\r\n    rect.outer.right += rect.element.marginRight;\r\n\r\n    // calculate outer width and height\r\n    calculateRectSize(rect.outer);\r\n\r\n    return rect;\r\n};\r\n\r\nconst expandRect = (parent, child) => {\r\n    // adjust for parent offset\r\n    child.top += parent.top;\r\n    child.right += parent.left;\r\n    child.bottom += parent.top;\r\n    child.left += parent.left;\r\n\r\n    if (child.bottom > parent.bottom) {\r\n        parent.bottom = child.bottom;\r\n    }\r\n\r\n    if (child.right > parent.right) {\r\n        parent.right = child.right;\r\n    }\r\n};\r\n\r\nconst calculateRectSize = rect => {\r\n    rect.width = rect.right - rect.left;\r\n    rect.height = rect.bottom - rect.top;\r\n};\r\n\r\nconst isNumber = value => typeof value === 'number';\r\n\r\n/**\r\n * Determines if position is at destination\r\n * @param position\r\n * @param destination\r\n * @param velocity\r\n * @param errorMargin\r\n * @returns {boolean}\r\n */\r\nconst thereYet = (position, destination, velocity, errorMargin = 0.001) => {\r\n    return Math.abs(position - destination) < errorMargin && Math.abs(velocity) < errorMargin;\r\n};\r\n\r\n/**\r\n * Spring animation\r\n */\r\nconst spring =\r\n    // default options\r\n    ({ stiffness = 0.5, damping = 0.75, mass = 10 } = {}) =>\r\n        // method definition\r\n        {\r\n            let target = null;\r\n            let position = null;\r\n            let velocity = 0;\r\n            let resting = false;\r\n\r\n            // updates spring state\r\n            const interpolate = (ts, skipToEndState) => {\r\n                // in rest, don't animate\r\n                if (resting) return;\r\n\r\n                // need at least a target or position to do springy things\r\n                if (!(isNumber(target) && isNumber(position))) {\r\n                    resting = true;\r\n                    velocity = 0;\r\n                    return;\r\n                }\r\n\r\n                // calculate spring force\r\n                const f = -(position - target) * stiffness;\r\n\r\n                // update velocity by adding force based on mass\r\n                velocity += f / mass;\r\n\r\n                // update position by adding velocity\r\n                position += velocity;\r\n\r\n                // slow down based on amount of damping\r\n                velocity *= damping;\r\n\r\n                // we've arrived if we're near target and our velocity is near zero\r\n                if (thereYet(position, target, velocity) || skipToEndState) {\r\n                    position = target;\r\n                    velocity = 0;\r\n                    resting = true;\r\n\r\n                    // we done\r\n                    api.onupdate(position);\r\n                    api.oncomplete(position);\r\n                } else {\r\n                    // progress update\r\n                    api.onupdate(position);\r\n                }\r\n            };\r\n\r\n            /**\r\n             * Set new target value\r\n             * @param value\r\n             */\r\n            const setTarget = value => {\r\n                // if currently has no position, set target and position to this value\r\n                if (isNumber(value) && !isNumber(position)) {\r\n                    position = value;\r\n                }\r\n\r\n                // next target value will not be animated to\r\n                if (target === null) {\r\n                    target = value;\r\n                    position = value;\r\n                }\r\n\r\n                // let start moving to target\r\n                target = value;\r\n\r\n                // already at target\r\n                if (position === target || typeof target === 'undefined') {\r\n                    // now resting as target is current position, stop moving\r\n                    resting = true;\r\n                    velocity = 0;\r\n\r\n                    // done!\r\n                    api.onupdate(position);\r\n                    api.oncomplete(position);\r\n\r\n                    return;\r\n                }\r\n\r\n                resting = false;\r\n            };\r\n\r\n            // need 'api' to call onupdate callback\r\n            const api = createObject({\r\n                interpolate,\r\n                target: {\r\n                    set: setTarget,\r\n                    get: () => target,\r\n                },\r\n                resting: {\r\n                    get: () => resting,\r\n                },\r\n                onupdate: value => {},\r\n                oncomplete: value => {},\r\n            });\r\n\r\n            return api;\r\n        };\r\n\r\nconst easeLinear = t => t;\r\nconst easeInOutQuad = t => (t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t);\r\n\r\nconst tween =\r\n    // default values\r\n    ({ duration = 500, easing = easeInOutQuad, delay = 0 } = {}) =>\r\n        // method definition\r\n        {\r\n            let start = null;\r\n            let t;\r\n            let p;\r\n            let resting = true;\r\n            let reverse = false;\r\n            let target = null;\r\n\r\n            const interpolate = (ts, skipToEndState) => {\r\n                if (resting || target === null) return;\r\n\r\n                if (start === null) {\r\n                    start = ts;\r\n                }\r\n\r\n                if (ts - start < delay) return;\r\n\r\n                t = ts - start - delay;\r\n\r\n                if (t >= duration || skipToEndState) {\r\n                    t = 1;\r\n                    p = reverse ? 0 : 1;\r\n                    api.onupdate(p * target);\r\n                    api.oncomplete(p * target);\r\n                    resting = true;\r\n                } else {\r\n                    p = t / duration;\r\n                    api.onupdate((t >= 0 ? easing(reverse ? 1 - p : p) : 0) * target);\r\n                }\r\n            };\r\n\r\n            // need 'api' to call onupdate callback\r\n            const api = createObject({\r\n                interpolate,\r\n                target: {\r\n                    get: () => (reverse ? 0 : target),\r\n                    set: value => {\r\n                        // is initial value\r\n                        if (target === null) {\r\n                            target = value;\r\n                            api.onupdate(value);\r\n                            api.oncomplete(value);\r\n                            return;\r\n                        }\r\n\r\n                        // want to tween to a smaller value and have a current value\r\n                        if (value < target) {\r\n                            target = 1;\r\n                            reverse = true;\r\n                        } else {\r\n                            // not tweening to a smaller value\r\n                            reverse = false;\r\n                            target = value;\r\n                        }\r\n\r\n                        // let's go!\r\n                        resting = false;\r\n                        start = null;\r\n                    },\r\n                },\r\n                resting: {\r\n                    get: () => resting,\r\n                },\r\n                onupdate: value => {},\r\n                oncomplete: value => {},\r\n            });\r\n\r\n            return api;\r\n        };\r\n\r\nconst animator = {\r\n    spring,\r\n    tween,\r\n};\r\n\r\n/*\r\n { type: 'spring', stiffness: .5, damping: .75, mass: 10 };\r\n { translation: { type: 'spring', ... }, ... }\r\n { translation: { x: { type: 'spring', ... } } }\r\n*/\r\nconst createAnimator = (definition, category, property) => {\r\n    // default is single definition\r\n    // we check if transform is set, if so, we check if property is set\r\n    const def =\r\n        definition[category] && typeof definition[category][property] === 'object'\r\n            ? definition[category][property]\r\n            : definition[category] || definition;\r\n\r\n    const type = typeof def === 'string' ? def : def.type;\r\n    const props = typeof def === 'object' ? { ...def } : {};\r\n\r\n    return animator[type] ? animator[type](props) : null;\r\n};\r\n\r\nconst addGetSet = (keys, obj, props, overwrite = false) => {\r\n    obj = Array.isArray(obj) ? obj : [obj];\r\n    obj.forEach(o => {\r\n        keys.forEach(key => {\r\n            let name = key;\r\n            let getter = () => props[key];\r\n            let setter = value => (props[key] = value);\r\n\r\n            if (typeof key === 'object') {\r\n                name = key.key;\r\n                getter = key.getter || getter;\r\n                setter = key.setter || setter;\r\n            }\r\n\r\n            if (o[name] && !overwrite) {\r\n                return;\r\n            }\r\n\r\n            o[name] = {\r\n                get: getter,\r\n                set: setter,\r\n            };\r\n        });\r\n    });\r\n};\r\n\r\n// add to state,\r\n// add getters and setters to internal and external api (if not set)\r\n// setup animators\r\n\r\nconst animations = ({ mixinConfig, viewProps, viewInternalAPI, viewExternalAPI }) => {\r\n    // initial properties\r\n    const initialProps = { ...viewProps };\r\n\r\n    // list of all active animations\r\n    const animations = [];\r\n\r\n    // setup animators\r\n    forin(mixinConfig, (property, animation) => {\r\n        const animator = createAnimator(animation);\r\n        if (!animator) {\r\n            return;\r\n        }\r\n\r\n        // when the animator updates, update the view state value\r\n        animator.onupdate = value => {\r\n            viewProps[property] = value;\r\n        };\r\n\r\n        // set animator target\r\n        animator.target = initialProps[property];\r\n\r\n        // when value is set, set the animator target value\r\n        const prop = {\r\n            key: property,\r\n            setter: value => {\r\n                // if already at target, we done!\r\n                if (animator.target === value) {\r\n                    return;\r\n                }\r\n\r\n                animator.target = value;\r\n            },\r\n            getter: () => viewProps[property],\r\n        };\r\n\r\n        // add getters and setters\r\n        addGetSet([prop], [viewInternalAPI, viewExternalAPI], viewProps, true);\r\n\r\n        // add it to the list for easy updating from the _write method\r\n        animations.push(animator);\r\n    });\r\n\r\n    // expose internal write api\r\n    return {\r\n        write: ts => {\r\n            let skipToEndState = document.hidden;\r\n            let resting = true;\r\n            animations.forEach(animation => {\r\n                if (!animation.resting) resting = false;\r\n                animation.interpolate(ts, skipToEndState);\r\n            });\r\n            return resting;\r\n        },\r\n        destroy: () => {},\r\n    };\r\n};\r\n\r\nconst addEvent = element => (type, fn) => {\r\n    element.addEventListener(type, fn);\r\n};\r\n\r\nconst removeEvent = element => (type, fn) => {\r\n    element.removeEventListener(type, fn);\r\n};\r\n\r\n// mixin\r\nconst listeners = ({\r\n    mixinConfig,\r\n    viewProps,\r\n    viewInternalAPI,\r\n    viewExternalAPI,\r\n    viewState,\r\n    view,\r\n}) => {\r\n    const events = [];\r\n\r\n    const add = addEvent(view.element);\r\n    const remove = removeEvent(view.element);\r\n\r\n    viewExternalAPI.on = (type, fn) => {\r\n        events.push({\r\n            type,\r\n            fn,\r\n        });\r\n        add(type, fn);\r\n    };\r\n\r\n    viewExternalAPI.off = (type, fn) => {\r\n        events.splice(events.findIndex(event => event.type === type && event.fn === fn), 1);\r\n        remove(type, fn);\r\n    };\r\n\r\n    return {\r\n        write: () => {\r\n            // not busy\r\n            return true;\r\n        },\r\n        destroy: () => {\r\n            events.forEach(event => {\r\n                remove(event.type, event.fn);\r\n            });\r\n        },\r\n    };\r\n};\r\n\r\n// add to external api and link to props\r\n\r\nconst apis = ({ mixinConfig, viewProps, viewExternalAPI }) => {\r\n    addGetSet(mixinConfig, viewExternalAPI, viewProps);\r\n};\r\n\r\nconst isDefined = value => value != null;\r\n\r\n// add to state,\r\n// add getters and setters to internal and external api (if not set)\r\n// set initial state based on props in viewProps\r\n// apply as transforms each frame\r\n\r\nconst defaults = {\r\n    opacity: 1,\r\n    scaleX: 1,\r\n    scaleY: 1,\r\n    translateX: 0,\r\n    translateY: 0,\r\n    rotateX: 0,\r\n    rotateY: 0,\r\n    rotateZ: 0,\r\n    originX: 0,\r\n    originY: 0,\r\n};\r\n\r\nconst styles = ({ mixinConfig, viewProps, viewInternalAPI, viewExternalAPI, view }) => {\r\n    // initial props\r\n    const initialProps = { ...viewProps };\r\n\r\n    // current props\r\n    const currentProps = {};\r\n\r\n    // we will add those properties to the external API and link them to the viewState\r\n    addGetSet(mixinConfig, [viewInternalAPI, viewExternalAPI], viewProps);\r\n\r\n    // override rect on internal and external rect getter so it takes in account transforms\r\n    const getOffset = () => [viewProps['translateX'] || 0, viewProps['translateY'] || 0];\r\n    const getScale = () => [viewProps['scaleX'] || 0, viewProps['scaleY'] || 0];\r\n    const getRect = () =>\r\n        view.rect ? getViewRect(view.rect, view.childViews, getOffset(), getScale()) : null;\r\n    viewInternalAPI.rect = { get: getRect };\r\n    viewExternalAPI.rect = { get: getRect };\r\n\r\n    // apply view props\r\n    mixinConfig.forEach(key => {\r\n        viewProps[key] =\r\n            typeof initialProps[key] === 'undefined' ? defaults[key] : initialProps[key];\r\n    });\r\n\r\n    // expose api\r\n    return {\r\n        write: () => {\r\n            // see if props have changed\r\n            if (!propsHaveChanged(currentProps, viewProps)) {\r\n                return;\r\n            }\r\n\r\n            // moves element to correct position on screen\r\n            applyStyles(view.element, viewProps);\r\n\r\n            // store new transforms\r\n            Object.assign(currentProps, { ...viewProps });\r\n\r\n            // no longer busy\r\n            return true;\r\n        },\r\n        destroy: () => {},\r\n    };\r\n};\r\n\r\nconst propsHaveChanged = (currentProps, newProps) => {\r\n    // different amount of keys\r\n    if (Object.keys(currentProps).length !== Object.keys(newProps).length) {\r\n        return true;\r\n    }\r\n\r\n    // lets analyze the individual props\r\n    for (const prop in newProps) {\r\n        if (newProps[prop] !== currentProps[prop]) {\r\n            return true;\r\n        }\r\n    }\r\n\r\n    return false;\r\n};\r\n\r\nconst applyStyles = (\r\n    element,\r\n    {\r\n        opacity,\r\n        perspective,\r\n        translateX,\r\n        translateY,\r\n        scaleX,\r\n        scaleY,\r\n        rotateX,\r\n        rotateY,\r\n        rotateZ,\r\n        originX,\r\n        originY,\r\n        width,\r\n        height,\r\n    }\r\n) => {\r\n    let transforms = '';\r\n    let styles = '';\r\n\r\n    // handle transform origin\r\n    if (isDefined(originX) || isDefined(originY)) {\r\n        styles += `transform-origin: ${originX || 0}px ${originY || 0}px;`;\r\n    }\r\n\r\n    // transform order is relevant\r\n    // 0. perspective\r\n    if (isDefined(perspective)) {\r\n        transforms += `perspective(${perspective}px) `;\r\n    }\r\n\r\n    // 1. translate\r\n    if (isDefined(translateX) || isDefined(translateY)) {\r\n        transforms += `translate3d(${translateX || 0}px, ${translateY || 0}px, 0) `;\r\n    }\r\n\r\n    // 2. scale\r\n    if (isDefined(scaleX) || isDefined(scaleY)) {\r\n        transforms += `scale3d(${isDefined(scaleX) ? scaleX : 1}, ${\r\n            isDefined(scaleY) ? scaleY : 1\r\n        }, 1) `;\r\n    }\r\n\r\n    // 3. rotate\r\n    if (isDefined(rotateZ)) {\r\n        transforms += `rotateZ(${rotateZ}rad) `;\r\n    }\r\n\r\n    if (isDefined(rotateX)) {\r\n        transforms += `rotateX(${rotateX}rad) `;\r\n    }\r\n\r\n    if (isDefined(rotateY)) {\r\n        transforms += `rotateY(${rotateY}rad) `;\r\n    }\r\n\r\n    // add transforms\r\n    if (transforms.length) {\r\n        styles += `transform:${transforms};`;\r\n    }\r\n\r\n    // add opacity\r\n    if (isDefined(opacity)) {\r\n        styles += `opacity:${opacity};`;\r\n\r\n        // if we reach zero, we make the element inaccessible\r\n        if (opacity === 0) {\r\n            styles += `visibility:hidden;`;\r\n        }\r\n\r\n        // if we're below 100% opacity this element can't be clicked\r\n        if (opacity < 1) {\r\n            styles += `pointer-events:none;`;\r\n        }\r\n    }\r\n\r\n    // add height\r\n    if (isDefined(height)) {\r\n        styles += `height:${height}px;`;\r\n    }\r\n\r\n    // add width\r\n    if (isDefined(width)) {\r\n        styles += `width:${width}px;`;\r\n    }\r\n\r\n    // apply styles\r\n    const elementCurrentStyle = element.elementCurrentStyle || '';\r\n\r\n    // if new styles does not match current styles, lets update!\r\n    if (styles.length !== elementCurrentStyle.length || styles !== elementCurrentStyle) {\r\n        element.style.cssText = styles;\r\n        // store current styles so we can compare them to new styles later on\r\n        // _not_ getting the style value is faster\r\n        element.elementCurrentStyle = styles;\r\n    }\r\n};\r\n\r\nconst Mixins = {\r\n    styles,\r\n    listeners,\r\n    animations,\r\n    apis,\r\n};\r\n\r\nconst updateRect = (rect = {}, element = {}, style = {}) => {\r\n    if (!element.layoutCalculated) {\r\n        rect.paddingTop = parseInt(style.paddingTop, 10) || 0;\r\n        rect.marginTop = parseInt(style.marginTop, 10) || 0;\r\n        rect.marginRight = parseInt(style.marginRight, 10) || 0;\r\n        rect.marginBottom = parseInt(style.marginBottom, 10) || 0;\r\n        rect.marginLeft = parseInt(style.marginLeft, 10) || 0;\r\n        element.layoutCalculated = true;\r\n    }\r\n\r\n    rect.left = element.offsetLeft || 0;\r\n    rect.top = element.offsetTop || 0;\r\n    rect.width = element.offsetWidth || 0;\r\n    rect.height = element.offsetHeight || 0;\r\n\r\n    rect.right = rect.left + rect.width;\r\n    rect.bottom = rect.top + rect.height;\r\n\r\n    rect.scrollTop = element.scrollTop;\r\n\r\n    rect.hidden = element.offsetParent === null;\r\n\r\n    return rect;\r\n};\r\n\r\nconst createView =\r\n    // default view definition\r\n    ({\r\n        // element definition\r\n        tag = 'div',\r\n        name = null,\r\n        attributes = {},\r\n\r\n        // view interaction\r\n        read = () => {},\r\n        write = () => {},\r\n        create = () => {},\r\n        destroy = () => {},\r\n\r\n        // hooks\r\n        filterFrameActionsForChild = (child, actions) => actions,\r\n        didCreateView = () => {},\r\n        didWriteView = () => {},\r\n\r\n        // rect related\r\n        ignoreRect = false,\r\n        ignoreRectUpdate = false,\r\n\r\n        // mixins\r\n        mixins = [],\r\n    } = {}) => (\r\n        // each view requires reference to store\r\n        store,\r\n        // specific properties for this view\r\n        props = {}\r\n    ) => {\r\n        // root element should not be changed\r\n        const element = createElement(tag, `filepond--${name}`, attributes);\r\n\r\n        // style reference should also not be changed\r\n        const style = window.getComputedStyle(element, null);\r\n\r\n        // element rectangle\r\n        const rect = updateRect();\r\n        let frameRect = null;\r\n\r\n        // rest state\r\n        let isResting = false;\r\n\r\n        // pretty self explanatory\r\n        const childViews = [];\r\n\r\n        // loaded mixins\r\n        const activeMixins = [];\r\n\r\n        // references to created children\r\n        const ref = {};\r\n\r\n        // state used for each instance\r\n        const state = {};\r\n\r\n        // list of writers that will be called to update this view\r\n        const writers = [\r\n            write, // default writer\r\n        ];\r\n\r\n        const readers = [\r\n            read, // default reader\r\n        ];\r\n\r\n        const destroyers = [\r\n            destroy, // default destroy\r\n        ];\r\n\r\n        // core view methods\r\n        const getElement = () => element;\r\n        const getChildViews = () => childViews.concat();\r\n        const getReference = () => ref;\r\n        const createChildView = store => (view, props) => view(store, props);\r\n        const getRect = () => {\r\n            if (frameRect) {\r\n                return frameRect;\r\n            }\r\n            frameRect = getViewRect(rect, childViews, [0, 0], [1, 1]);\r\n            return frameRect;\r\n        };\r\n        const getStyle = () => style;\r\n\r\n        /**\r\n         * Read data from DOM\r\n         * @private\r\n         */\r\n        const _read = () => {\r\n            frameRect = null;\r\n\r\n            // read child views\r\n            childViews.forEach(child => child._read());\r\n\r\n            const shouldUpdate = !(ignoreRectUpdate && rect.width && rect.height);\r\n            if (shouldUpdate) {\r\n                updateRect(rect, element, style);\r\n            }\r\n\r\n            // readers\r\n            const api = { root: internalAPI, props, rect };\r\n            readers.forEach(reader => reader(api));\r\n        };\r\n\r\n        /**\r\n         * Write data to DOM\r\n         * @private\r\n         */\r\n        const _write = (ts, frameActions, shouldOptimize) => {\r\n            // if no actions, we assume that the view is resting\r\n            let resting = frameActions.length === 0;\r\n\r\n            // writers\r\n            writers.forEach(writer => {\r\n                const writerResting = writer({\r\n                    props,\r\n                    root: internalAPI,\r\n                    actions: frameActions,\r\n                    timestamp: ts,\r\n                    shouldOptimize,\r\n                });\r\n                if (writerResting === false) {\r\n                    resting = false;\r\n                }\r\n            });\r\n\r\n            // run mixins\r\n            activeMixins.forEach(mixin => {\r\n                // if one of the mixins is still busy after write operation, we are not resting\r\n                const mixinResting = mixin.write(ts);\r\n                if (mixinResting === false) {\r\n                    resting = false;\r\n                }\r\n            });\r\n\r\n            // updates child views that are currently attached to the DOM\r\n            childViews\r\n                .filter(child => !!child.element.parentNode)\r\n                .forEach(child => {\r\n                    // if a child view is not resting, we are not resting\r\n                    const childResting = child._write(\r\n                        ts,\r\n                        filterFrameActionsForChild(child, frameActions),\r\n                        shouldOptimize\r\n                    );\r\n                    if (!childResting) {\r\n                        resting = false;\r\n                    }\r\n                });\r\n\r\n            // append new elements to DOM and update those\r\n            childViews\r\n                //.filter(child => !child.element.parentNode)\r\n                .forEach((child, index) => {\r\n                    // skip\r\n                    if (child.element.parentNode) {\r\n                        return;\r\n                    }\r\n\r\n                    // append to DOM\r\n                    internalAPI.appendChild(child.element, index);\r\n\r\n                    // call read (need to know the size of these elements)\r\n                    child._read();\r\n\r\n                    // re-call write\r\n                    child._write(\r\n                        ts,\r\n                        filterFrameActionsForChild(child, frameActions),\r\n                        shouldOptimize\r\n                    );\r\n\r\n                    // we just added somthing to the dom, no rest\r\n                    resting = false;\r\n                });\r\n\r\n            // update resting state\r\n            isResting = resting;\r\n\r\n            didWriteView({\r\n                props,\r\n                root: internalAPI,\r\n                actions: frameActions,\r\n                timestamp: ts,\r\n            });\r\n\r\n            // let parent know if we are resting\r\n            return resting;\r\n        };\r\n\r\n        const _destroy = () => {\r\n            activeMixins.forEach(mixin => mixin.destroy());\r\n            destroyers.forEach(destroyer => {\r\n                destroyer({ root: internalAPI, props });\r\n            });\r\n            childViews.forEach(child => child._destroy());\r\n        };\r\n\r\n        // sharedAPI\r\n        const sharedAPIDefinition = {\r\n            element: {\r\n                get: getElement,\r\n            },\r\n            style: {\r\n                get: getStyle,\r\n            },\r\n            childViews: {\r\n                get: getChildViews,\r\n            },\r\n        };\r\n\r\n        // private API definition\r\n        const internalAPIDefinition = {\r\n            ...sharedAPIDefinition,\r\n            rect: {\r\n                get: getRect,\r\n            },\r\n\r\n            // access to custom children references\r\n            ref: {\r\n                get: getReference,\r\n            },\r\n\r\n            // dom modifiers\r\n            is: needle => name === needle,\r\n            appendChild: appendChild(element),\r\n            createChildView: createChildView(store),\r\n            linkView: view => {\r\n                childViews.push(view);\r\n                return view;\r\n            },\r\n            unlinkView: view => {\r\n                childViews.splice(childViews.indexOf(view), 1);\r\n            },\r\n            appendChildView: appendChildView(element, childViews),\r\n            removeChildView: removeChildView(element, childViews),\r\n            registerWriter: writer => writers.push(writer),\r\n            registerReader: reader => readers.push(reader),\r\n            registerDestroyer: destroyer => destroyers.push(destroyer),\r\n            invalidateLayout: () => (element.layoutCalculated = false),\r\n\r\n            // access to data store\r\n            dispatch: store.dispatch,\r\n            query: store.query,\r\n        };\r\n\r\n        // public view API methods\r\n        const externalAPIDefinition = {\r\n            element: {\r\n                get: getElement,\r\n            },\r\n            childViews: {\r\n                get: getChildViews,\r\n            },\r\n            rect: {\r\n                get: getRect,\r\n            },\r\n            resting: {\r\n                get: () => isResting,\r\n            },\r\n            isRectIgnored: () => ignoreRect,\r\n            _read,\r\n            _write,\r\n            _destroy,\r\n        };\r\n\r\n        // mixin API methods\r\n        const mixinAPIDefinition = {\r\n            ...sharedAPIDefinition,\r\n            rect: {\r\n                get: () => rect,\r\n            },\r\n        };\r\n\r\n        // add mixin functionality\r\n        Object.keys(mixins)\r\n            .sort((a, b) => {\r\n                // move styles to the back of the mixin list (so adjustments of other mixins are applied to the props correctly)\r\n                if (a === 'styles') {\r\n                    return 1;\r\n                } else if (b === 'styles') {\r\n                    return -1;\r\n                }\r\n                return 0;\r\n            })\r\n            .forEach(key => {\r\n                const mixinAPI = Mixins[key]({\r\n                    mixinConfig: mixins[key],\r\n                    viewProps: props,\r\n                    viewState: state,\r\n                    viewInternalAPI: internalAPIDefinition,\r\n                    viewExternalAPI: externalAPIDefinition,\r\n                    view: createObject(mixinAPIDefinition),\r\n                });\r\n\r\n                if (mixinAPI) {\r\n                    activeMixins.push(mixinAPI);\r\n                }\r\n            });\r\n\r\n        // construct private api\r\n        const internalAPI = createObject(internalAPIDefinition);\r\n\r\n        // create the view\r\n        create({\r\n            root: internalAPI,\r\n            props,\r\n        });\r\n\r\n        // append created child views to root node\r\n        const childCount = getChildCount(element); // need to know the current child count so appending happens in correct order\r\n        childViews.forEach((child, index) => {\r\n            internalAPI.appendChild(child.element, childCount + index);\r\n        });\r\n\r\n        // call did create\r\n        didCreateView(internalAPI);\r\n\r\n        // expose public api\r\n        return createObject(externalAPIDefinition);\r\n    };\r\n\r\nconst createPainter = (read, write, fps = 60) => {\r\n    const name = '__framePainter';\r\n\r\n    // set global painter\r\n    if (window[name]) {\r\n        window[name].readers.push(read);\r\n        window[name].writers.push(write);\r\n        return;\r\n    }\r\n\r\n    window[name] = {\r\n        readers: [read],\r\n        writers: [write],\r\n    };\r\n\r\n    const painter = window[name];\r\n\r\n    const interval = 1000 / fps;\r\n    let last = null;\r\n    let id = null;\r\n    let requestTick = null;\r\n    let cancelTick = null;\r\n\r\n    const setTimerType = () => {\r\n        if (document.hidden) {\r\n            requestTick = () => window.setTimeout(() => tick(performance.now()), interval);\r\n            cancelTick = () => window.clearTimeout(id);\r\n        } else {\r\n            requestTick = () => window.requestAnimationFrame(tick);\r\n            cancelTick = () => window.cancelAnimationFrame(id);\r\n        }\r\n    };\r\n\r\n    document.addEventListener('visibilitychange', () => {\r\n        if (cancelTick) cancelTick();\r\n        setTimerType();\r\n        tick(performance.now());\r\n    });\r\n\r\n    const tick = ts => {\r\n        // queue next tick\r\n        id = requestTick(tick);\r\n\r\n        // limit fps\r\n        if (!last) {\r\n            last = ts;\r\n        }\r\n\r\n        const delta = ts - last;\r\n\r\n        if (delta <= interval) {\r\n            // skip frame\r\n            return;\r\n        }\r\n\r\n        // align next frame\r\n        last = ts - (delta % interval);\r\n\r\n        // update view\r\n        painter.readers.forEach(read => read());\r\n        painter.writers.forEach(write => write(ts));\r\n    };\r\n\r\n    setTimerType();\r\n    tick(performance.now());\r\n\r\n    return {\r\n        pause: () => {\r\n            cancelTick(id);\r\n        },\r\n    };\r\n};\r\n\r\nconst createRoute = (routes, fn) => ({ root, props, actions = [], timestamp, shouldOptimize }) => {\r\n    actions\r\n        .filter(action => routes[action.type])\r\n        .forEach(action =>\r\n            routes[action.type]({ root, props, action: action.data, timestamp, shouldOptimize })\r\n        );\r\n    if (fn) {\r\n        fn({ root, props, actions, timestamp, shouldOptimize });\r\n    }\r\n};\r\n\r\nconst insertBefore = (newNode, referenceNode) =>\r\n    referenceNode.parentNode.insertBefore(newNode, referenceNode);\r\n\r\nconst insertAfter = (newNode, referenceNode) => {\r\n    return referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\r\n};\r\n\r\nconst isArray = value => Array.isArray(value);\r\n\r\nconst isEmpty = value => value == null;\r\n\r\nconst trim = str => str.trim();\r\n\r\nconst toString = value => '' + value;\r\n\r\nconst toArray = (value, splitter = ',') => {\r\n    if (isEmpty(value)) {\r\n        return [];\r\n    }\r\n    if (isArray(value)) {\r\n        return value;\r\n    }\r\n    return toString(value)\r\n        .split(splitter)\r\n        .map(trim)\r\n        .filter(str => str.length);\r\n};\r\n\r\nconst isBoolean = value => typeof value === 'boolean';\r\n\r\nconst toBoolean = value => (isBoolean(value) ? value : value === 'true');\r\n\r\nconst isString = value => typeof value === 'string';\r\n\r\nconst toNumber = value =>\r\n    isNumber(value) ? value : isString(value) ? toString(value).replace(/[a-z]+/gi, '') : 0;\r\n\r\nconst toInt = value => parseInt(toNumber(value), 10);\r\n\r\nconst toFloat = value => parseFloat(toNumber(value));\r\n\r\nconst isInt = value => isNumber(value) && isFinite(value) && Math.floor(value) === value;\r\n\r\nconst toBytes = (value, base = 1000) => {\r\n    // is in bytes\r\n    if (isInt(value)) {\r\n        return value;\r\n    }\r\n\r\n    // is natural file size\r\n    let naturalFileSize = toString(value).trim();\r\n\r\n    // if is value in megabytes\r\n    if (/MB$/i.test(naturalFileSize)) {\r\n        naturalFileSize = naturalFileSize.replace(/MB$i/, '').trim();\r\n        return toInt(naturalFileSize) * base * base;\r\n    }\r\n\r\n    // if is value in kilobytes\r\n    if (/KB/i.test(naturalFileSize)) {\r\n        naturalFileSize = naturalFileSize.replace(/KB$i/, '').trim();\r\n        return toInt(naturalFileSize) * base;\r\n    }\r\n\r\n    return toInt(naturalFileSize);\r\n};\r\n\r\nconst isFunction = value => typeof value === 'function';\r\n\r\nconst toFunctionReference = string => {\r\n    let ref = self;\r\n    let levels = string.split('.');\r\n    let level = null;\r\n    while ((level = levels.shift())) {\r\n        ref = ref[level];\r\n        if (!ref) {\r\n            return null;\r\n        }\r\n    }\r\n    return ref;\r\n};\r\n\r\nconst methods = {\r\n    process: 'POST',\r\n    patch: 'PATCH',\r\n    revert: 'DELETE',\r\n    fetch: 'GET',\r\n    restore: 'GET',\r\n    load: 'GET',\r\n};\r\n\r\nconst createServerAPI = outline => {\r\n    const api = {};\r\n\r\n    api.url = isString(outline) ? outline : outline.url || '';\r\n    api.timeout = outline.timeout ? parseInt(outline.timeout, 10) : 0;\r\n    api.headers = outline.headers ? outline.headers : {};\r\n\r\n    forin(methods, key => {\r\n        api[key] = createAction(key, outline[key], methods[key], api.timeout, api.headers);\r\n    });\r\n\r\n    // remove process if no url or process on outline\r\n    api.process = outline.process || isString(outline) || outline.url ? api.process : null;\r\n\r\n    // special treatment for remove\r\n    api.remove = outline.remove || null;\r\n\r\n    // remove generic headers from api object\r\n    delete api.headers;\r\n\r\n    return api;\r\n};\r\n\r\nconst createAction = (name, outline, method, timeout, headers) => {\r\n    // is explicitely set to null so disable\r\n    if (outline === null) {\r\n        return null;\r\n    }\r\n\r\n    // if is custom function, done! Dev handles everything.\r\n    if (typeof outline === 'function') {\r\n        return outline;\r\n    }\r\n\r\n    // build action object\r\n    const action = {\r\n        url: method === 'GET' || method === 'PATCH' ? `?${name}=` : '',\r\n        method,\r\n        headers,\r\n        withCredentials: false,\r\n        timeout,\r\n        onload: null,\r\n        ondata: null,\r\n        onerror: null,\r\n    };\r\n\r\n    // is a single url\r\n    if (isString(outline)) {\r\n        action.url = outline;\r\n        return action;\r\n    }\r\n\r\n    // overwrite\r\n    Object.assign(action, outline);\r\n\r\n    // see if should reformat headers;\r\n    if (isString(action.headers)) {\r\n        const parts = action.headers.split(/:(.+)/);\r\n        action.headers = {\r\n            header: parts[0],\r\n            value: parts[1],\r\n        };\r\n    }\r\n\r\n    // if is bool withCredentials\r\n    action.withCredentials = toBoolean(action.withCredentials);\r\n\r\n    return action;\r\n};\r\n\r\nconst toServerAPI = value => createServerAPI(value);\r\n\r\nconst isNull = value => value === null;\r\n\r\nconst isObject = value => typeof value === 'object' && value !== null;\r\n\r\nconst isAPI = value => {\r\n    return (\r\n        isObject(value) &&\r\n        isString(value.url) &&\r\n        isObject(value.process) &&\r\n        isObject(value.revert) &&\r\n        isObject(value.restore) &&\r\n        isObject(value.fetch)\r\n    );\r\n};\r\n\r\nconst getType = value => {\r\n    if (isArray(value)) {\r\n        return 'array';\r\n    }\r\n\r\n    if (isNull(value)) {\r\n        return 'null';\r\n    }\r\n\r\n    if (isInt(value)) {\r\n        return 'int';\r\n    }\r\n\r\n    if (/^[0-9]+ ?(?:GB|MB|KB)$/gi.test(value)) {\r\n        return 'bytes';\r\n    }\r\n\r\n    if (isAPI(value)) {\r\n        return 'api';\r\n    }\r\n\r\n    return typeof value;\r\n};\r\n\r\nconst replaceSingleQuotes = str =>\r\n    str\r\n        .replace(/{\\s*'/g, '{\"')\r\n        .replace(/'\\s*}/g, '\"}')\r\n        .replace(/'\\s*:/g, '\":')\r\n        .replace(/:\\s*'/g, ':\"')\r\n        .replace(/,\\s*'/g, ',\"')\r\n        .replace(/'\\s*,/g, '\",');\r\n\r\nconst conversionTable = {\r\n    array: toArray,\r\n    boolean: toBoolean,\r\n    int: value => (getType(value) === 'bytes' ? toBytes(value) : toInt(value)),\r\n    number: toFloat,\r\n    float: toFloat,\r\n    bytes: toBytes,\r\n    string: value => (isFunction(value) ? value : toString(value)),\r\n    function: value => toFunctionReference(value),\r\n    serverapi: toServerAPI,\r\n    object: value => {\r\n        try {\r\n            return JSON.parse(replaceSingleQuotes(value));\r\n        } catch (e) {\r\n            return null;\r\n        }\r\n    },\r\n};\r\n\r\nconst convertTo = (value, type) => conversionTable[type](value);\r\n\r\nconst getValueByType = (newValue, defaultValue, valueType) => {\r\n    // can always assign default value\r\n    if (newValue === defaultValue) {\r\n        return newValue;\r\n    }\r\n\r\n    // get the type of the new value\r\n    let newValueType = getType(newValue);\r\n\r\n    // is valid type?\r\n    if (newValueType !== valueType) {\r\n        // is string input, let's attempt to convert\r\n        const convertedValue = convertTo(newValue, valueType);\r\n\r\n        // what is the type now\r\n        newValueType = getType(convertedValue);\r\n\r\n        // no valid conversions found\r\n        if (convertedValue === null) {\r\n            throw `Trying to assign value with incorrect type to \"${option}\", allowed type: \"${valueType}\"`;\r\n        } else {\r\n            newValue = convertedValue;\r\n        }\r\n    }\r\n\r\n    // assign new value\r\n    return newValue;\r\n};\r\n\r\nconst createOption = (defaultValue, valueType) => {\r\n    let currentValue = defaultValue;\r\n    return {\r\n        enumerable: true,\r\n        get: () => currentValue,\r\n        set: newValue => {\r\n            currentValue = getValueByType(newValue, defaultValue, valueType);\r\n        },\r\n    };\r\n};\r\n\r\nconst createOptions = options => {\r\n    const obj = {};\r\n    forin(options, prop => {\r\n        const optionDefinition = options[prop];\r\n        obj[prop] = createOption(optionDefinition[0], optionDefinition[1]);\r\n    });\r\n    return createObject(obj);\r\n};\r\n\r\nconst createInitialState = options => ({\r\n    // model\r\n    items: [],\r\n\r\n    // timeout used for calling update items\r\n    listUpdateTimeout: null,\r\n\r\n    // timeout used for stacking metadata updates\r\n    itemUpdateTimeout: null,\r\n\r\n    // queue of items waiting to be processed\r\n    processingQueue: [],\r\n\r\n    // options\r\n    options: createOptions(options),\r\n});\r\n\r\nconst fromCamels = (string, separator = '-') =>\r\n    string\r\n        .split(/(?=[A-Z])/)\r\n        .map(part => part.toLowerCase())\r\n        .join(separator);\r\n\r\nconst createOptionAPI = (store, options) => {\r\n    const obj = {};\r\n    forin(options, key => {\r\n        obj[key] = {\r\n            get: () => store.getState().options[key],\r\n            set: value => {\r\n                store.dispatch(`SET_${fromCamels(key, '_').toUpperCase()}`, {\r\n                    value,\r\n                });\r\n            },\r\n        };\r\n    });\r\n    return obj;\r\n};\r\n\r\nconst createOptionActions = options => (dispatch, query, state) => {\r\n    const obj = {};\r\n    forin(options, key => {\r\n        const name = fromCamels(key, '_').toUpperCase();\r\n\r\n        obj[`SET_${name}`] = action => {\r\n            try {\r\n                state.options[key] = action.value;\r\n            } catch (e) {\r\n                // nope, failed\r\n            }\r\n\r\n            // we successfully set the value of this option\r\n            dispatch(`DID_SET_${name}`, { value: state.options[key] });\r\n        };\r\n    });\r\n    return obj;\r\n};\r\n\r\nconst createOptionQueries = options => state => {\r\n    const obj = {};\r\n    forin(options, key => {\r\n        obj[`GET_${fromCamels(key, '_').toUpperCase()}`] = action => state.options[key];\r\n    });\r\n    return obj;\r\n};\r\n\r\nconst InteractionMethod = {\r\n    API: 1,\r\n    DROP: 2,\r\n    BROWSE: 3,\r\n    PASTE: 4,\r\n    NONE: 5,\r\n};\r\n\r\nconst getUniqueId = () =>\r\n    Math.random()\r\n        .toString(36)\r\n        .substring(2, 11);\r\n\r\nconst arrayRemove = (arr, index) => arr.splice(index, 1);\r\n\r\nconst run = (cb, sync) => {\r\n    if (sync) {\r\n        cb();\r\n    } else if (document.hidden) {\r\n        Promise.resolve(1).then(cb);\r\n    } else {\r\n        setTimeout(cb, 0);\r\n    }\r\n};\r\n\r\nconst on = () => {\r\n    const listeners = [];\r\n    const off = (event, cb) => {\r\n        arrayRemove(\r\n            listeners,\r\n            listeners.findIndex(listener => listener.event === event && (listener.cb === cb || !cb))\r\n        );\r\n    };\r\n    const fire = (event, args, sync) => {\r\n        listeners\r\n            .filter(listener => listener.event === event)\r\n            .map(listener => listener.cb)\r\n            .forEach(cb => run(() => cb(...args), sync));\r\n    };\r\n    return {\r\n        fireSync: (event, ...args) => {\r\n            fire(event, args, true);\r\n        },\r\n        fire: (event, ...args) => {\r\n            fire(event, args, false);\r\n        },\r\n        on: (event, cb) => {\r\n            listeners.push({ event, cb });\r\n        },\r\n        onOnce: (event, cb) => {\r\n            listeners.push({\r\n                event,\r\n                cb: (...args) => {\r\n                    off(event, cb);\r\n                    cb(...args);\r\n                },\r\n            });\r\n        },\r\n        off,\r\n    };\r\n};\r\n\r\nconst copyObjectPropertiesToObject = (src, target, excluded) => {\r\n    Object.getOwnPropertyNames(src)\r\n        .filter(property => !excluded.includes(property))\r\n        .forEach(key =>\r\n            Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(src, key))\r\n        );\r\n};\r\n\r\nconst PRIVATE = [\r\n    'fire',\r\n    'process',\r\n    'revert',\r\n    'load',\r\n    'on',\r\n    'off',\r\n    'onOnce',\r\n    'retryLoad',\r\n    'extend',\r\n    'archive',\r\n    'archived',\r\n    'release',\r\n    'released',\r\n    'requestProcessing',\r\n    'freeze',\r\n];\r\n\r\nconst createItemAPI = item => {\r\n    const api = {};\r\n    copyObjectPropertiesToObject(item, api, PRIVATE);\r\n    return api;\r\n};\r\n\r\nconst removeReleasedItems = items => {\r\n    items.forEach((item, index) => {\r\n        if (item.released) {\r\n            arrayRemove(items, index);\r\n        }\r\n    });\r\n};\r\n\r\nconst ItemStatus = {\r\n    INIT: 1,\r\n    IDLE: 2,\r\n    PROCESSING_QUEUED: 9,\r\n    PROCESSING: 3,\r\n    PROCESSING_COMPLETE: 5,\r\n    PROCESSING_ERROR: 6,\r\n    PROCESSING_REVERT_ERROR: 10,\r\n    LOADING: 7,\r\n    LOAD_ERROR: 8,\r\n};\r\n\r\nconst FileOrigin = {\r\n    INPUT: 1,\r\n    LIMBO: 2,\r\n    LOCAL: 3,\r\n};\r\n\r\nconst getNonNumeric = str => /[^0-9]+/.exec(str);\r\n\r\nconst getDecimalSeparator = () => getNonNumeric((1.1).toLocaleString())[0];\r\n\r\nconst getThousandsSeparator = () => {\r\n    // Added for browsers that do not return the thousands separator (happend on native browser Android 4.4.4)\r\n    // We check against the normal toString output and if they're the same return a comma when decimal separator is a dot\r\n    const decimalSeparator = getDecimalSeparator();\r\n    const thousandsStringWithSeparator = (1000.0).toLocaleString();\r\n    const thousandsStringWithoutSeparator = (1000.0).toString();\r\n    if (thousandsStringWithSeparator !== thousandsStringWithoutSeparator) {\r\n        return getNonNumeric(thousandsStringWithSeparator)[0];\r\n    }\r\n    return decimalSeparator === '.' ? ',' : '.';\r\n};\r\n\r\nconst Type = {\r\n    BOOLEAN: 'boolean',\r\n    INT: 'int',\r\n    NUMBER: 'number',\r\n    STRING: 'string',\r\n    ARRAY: 'array',\r\n    OBJECT: 'object',\r\n    FUNCTION: 'function',\r\n    ACTION: 'action',\r\n    SERVER_API: 'serverapi',\r\n    REGEX: 'regex',\r\n};\r\n\r\n// all registered filters\r\nconst filters = [];\r\n\r\n// loops over matching filters and passes options to each filter, returning the mapped results\r\nconst applyFilterChain = (key, value, utils) =>\r\n    new Promise((resolve, reject) => {\r\n        // find matching filters for this key\r\n        const matchingFilters = filters.filter(f => f.key === key).map(f => f.cb);\r\n\r\n        // resolve now\r\n        if (matchingFilters.length === 0) {\r\n            resolve(value);\r\n            return;\r\n        }\r\n\r\n        // first filter to kick things of\r\n        const initialFilter = matchingFilters.shift();\r\n\r\n        // chain filters\r\n        matchingFilters\r\n            .reduce(\r\n                // loop over promises passing value to next promise\r\n                (current, next) => current.then(value => next(value, utils)),\r\n\r\n                // call initial filter, will return a promise\r\n                initialFilter(value, utils)\r\n\r\n                // all executed\r\n            )\r\n            .then(value => resolve(value))\r\n            .catch(error => reject(error));\r\n    });\r\n\r\nconst applyFilters = (key, value, utils) =>\r\n    filters.filter(f => f.key === key).map(f => f.cb(value, utils));\r\n\r\n// adds a new filter to the list\r\nconst addFilter = (key, cb) => filters.push({ key, cb });\r\n\r\nconst extendDefaultOptions = additionalOptions => Object.assign(defaultOptions, additionalOptions);\r\n\r\nconst getOptions = () => ({ ...defaultOptions });\r\n\r\nconst setOptions = opts => {\r\n    forin(opts, (key, value) => {\r\n        // key does not exist, so this option cannot be set\r\n        if (!defaultOptions[key]) {\r\n            return;\r\n        }\r\n        defaultOptions[key][0] = getValueByType(\r\n            value,\r\n            defaultOptions[key][0],\r\n            defaultOptions[key][1]\r\n        );\r\n    });\r\n};\r\n\r\n// default options on app\r\nconst defaultOptions = {\r\n    // the id to add to the root element\r\n    id: [null, Type.STRING],\r\n\r\n    // input field name to use\r\n    name: ['filepond', Type.STRING],\r\n\r\n    // disable the field\r\n    disabled: [false, Type.BOOLEAN],\r\n\r\n    // classname to put on wrapper\r\n    className: [null, Type.STRING],\r\n\r\n    // is the field required\r\n    required: [false, Type.BOOLEAN],\r\n\r\n    // Allow media capture when value is set\r\n    captureMethod: [null, Type.STRING],\r\n    // - \"camera\", \"microphone\" or \"camcorder\",\r\n    // - Does not work with multiple on apple devices\r\n    // - If set, acceptedFileTypes must be made to match with media wildcard \"image/*\", \"audio/*\" or \"video/*\"\r\n\r\n    // sync `acceptedFileTypes` property with `accept` attribute\r\n    allowSyncAcceptAttribute: [true, Type.BOOLEAN],\r\n\r\n    // Feature toggles\r\n    allowDrop: [true, Type.BOOLEAN], // Allow dropping of files\r\n    allowBrowse: [true, Type.BOOLEAN], // Allow browsing the file system\r\n    allowPaste: [true, Type.BOOLEAN], // Allow pasting files\r\n    allowMultiple: [false, Type.BOOLEAN], // Allow multiple files (disabled by default, as multiple attribute is also required on input to allow multiple)\r\n    allowReplace: [true, Type.BOOLEAN], // Allow dropping a file on other file to replace it (only works when multiple is set to false)\r\n    allowRevert: [true, Type.BOOLEAN], // Allows user to revert file upload\r\n    allowRemove: [true, Type.BOOLEAN], // Allow user to remove a file\r\n    allowProcess: [true, Type.BOOLEAN], // Allows user to process a file, when set to false, this removes the file upload button\r\n    allowReorder: [false, Type.BOOLEAN], // Allow reordering of files\r\n    allowDirectoriesOnly: [false, Type.BOOLEAN], // Allow only selecting directories with browse (no support for filtering dnd at this point)\r\n\r\n    // Try store file if `server` not set\r\n    storeAsFile: [false, Type.BOOLEAN],\r\n\r\n    // Revert mode\r\n    forceRevert: [false, Type.BOOLEAN], // Set to 'force' to require the file to be reverted before removal\r\n\r\n    // Input requirements\r\n    maxFiles: [null, Type.INT], // Max number of files\r\n    checkValidity: [false, Type.BOOLEAN], // Enables custom validity messages\r\n\r\n    // Where to put file\r\n    itemInsertLocationFreedom: [true, Type.BOOLEAN], // Set to false to always add items to begin or end of list\r\n    itemInsertLocation: ['before', Type.STRING], // Default index in list to add items that have been dropped at the top of the list\r\n    itemInsertInterval: [75, Type.INT],\r\n\r\n    // Drag 'n Drop related\r\n    dropOnPage: [false, Type.BOOLEAN], // Allow dropping of files anywhere on page (prevents browser from opening file if dropped outside of Up)\r\n    dropOnElement: [true, Type.BOOLEAN], // Drop needs to happen on element (set to false to also load drops outside of Up)\r\n    dropValidation: [false, Type.BOOLEAN], // Enable or disable validating files on drop\r\n    ignoredFiles: [['.ds_store', 'thumbs.db', 'desktop.ini'], Type.ARRAY],\r\n\r\n    // Upload related\r\n    instantUpload: [true, Type.BOOLEAN], // Should upload files immediately on drop\r\n    maxParallelUploads: [2, Type.INT], // Maximum files to upload in parallel\r\n    allowMinimumUploadDuration: [true, Type.BOOLEAN], // if true uploads take at least 750 ms, this ensures the user sees the upload progress giving trust the upload actually happened\r\n\r\n    // Chunks\r\n    chunkUploads: [false, Type.BOOLEAN], // Enable chunked uploads\r\n    chunkForce: [false, Type.BOOLEAN], // Force use of chunk uploads even for files smaller than chunk size\r\n    chunkSize: [5000000, Type.INT], // Size of chunks (5MB default)\r\n    chunkRetryDelays: [[500, 1000, 3000], Type.ARRAY], // Amount of times to retry upload of a chunk when it fails\r\n\r\n    // The server api end points to use for uploading (see docs)\r\n    server: [null, Type.SERVER_API],\r\n\r\n    // File size calculations, can set to 1024, this is only used for display, properties use file size base 1000\r\n    fileSizeBase: [1000, Type.INT],\r\n\r\n    // Labels and status messages\r\n    labelFileSizeBytes: ['bytes', Type.STRING],\r\n    labelFileSizeKilobytes: ['KB', Type.STRING],\r\n    labelFileSizeMegabytes: ['MB', Type.STRING],\r\n    labelFileSizeGigabytes: ['GB', Type.STRING],\r\n\r\n    labelDecimalSeparator: [getDecimalSeparator(), Type.STRING], // Default is locale separator\r\n    labelThousandsSeparator: [getThousandsSeparator(), Type.STRING], // Default is locale separator\r\n\r\n    labelIdle: [\r\n        'Drag & Drop your files or <span class=\"filepond--label-action\">Browse</span>',\r\n        Type.STRING,\r\n    ],\r\n    labelInvalidField: ['Field contains invalid files', Type.STRING],\r\n    labelFileWaitingForSize: ['Waiting for size', Type.STRING],\r\n    labelFileSizeNotAvailable: ['Size not available', Type.STRING],\r\n    labelFileCountSingular: ['file in list', Type.STRING],\r\n    labelFileCountPlural: ['files in list', Type.STRING],\r\n    labelFileLoading: ['Loading', Type.STRING],\r\n    labelFileAdded: ['Added', Type.STRING], // assistive only\r\n    labelFileLoadError: ['Error during load', Type.STRING],\r\n    labelFileRemoved: ['Removed', Type.STRING], // assistive only\r\n    labelFileRemoveError: ['Error during remove', Type.STRING],\r\n    labelFileProcessing: ['Uploading', Type.STRING],\r\n    labelFileProcessingComplete: ['Upload complete', Type.STRING],\r\n    labelFileProcessingAborted: ['Upload cancelled', Type.STRING],\r\n    labelFileProcessingError: ['Error during upload', Type.STRING],\r\n    labelFileProcessingRevertError: ['Error during revert', Type.STRING],\r\n\r\n    labelTapToCancel: ['tap to cancel', Type.STRING],\r\n    labelTapToRetry: ['tap to retry', Type.STRING],\r\n    labelTapToUndo: ['tap to undo', Type.STRING],\r\n\r\n    labelButtonRemoveItem: ['Remove', Type.STRING],\r\n    labelButtonAbortItemLoad: ['Abort', Type.STRING],\r\n    labelButtonRetryItemLoad: ['Retry', Type.STRING],\r\n    labelButtonAbortItemProcessing: ['Cancel', Type.STRING],\r\n    labelButtonUndoItemProcessing: ['Undo', Type.STRING],\r\n    labelButtonRetryItemProcessing: ['Retry', Type.STRING],\r\n    labelButtonProcessItem: ['Upload', Type.STRING],\r\n\r\n    // make sure width and height plus viewpox are even numbers so icons are nicely centered\r\n    iconRemove: [\r\n        '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M11.586 13l-2.293 2.293a1 1 0 0 0 1.414 1.414L13 14.414l2.293 2.293a1 1 0 0 0 1.414-1.414L14.414 13l2.293-2.293a1 1 0 0 0-1.414-1.414L13 11.586l-2.293-2.293a1 1 0 0 0-1.414 1.414L11.586 13z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>',\r\n        Type.STRING,\r\n    ],\r\n    iconProcess: [\r\n        '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 10.414v3.585a1 1 0 0 1-2 0v-3.585l-1.293 1.293a1 1 0 0 1-1.414-1.415l3-3a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1-1.414 1.415L14 10.414zM9 18a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2H9z\" fill=\"currentColor\" fill-rule=\"evenodd\"/></svg>',\r\n        Type.STRING,\r\n    ],\r\n    iconRetry: [\r\n        '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M10.81 9.185l-.038.02A4.997 4.997 0 0 0 8 13.683a5 5 0 0 0 5 5 5 5 0 0 0 5-5 1 1 0 0 1 2 0A7 7 0 1 1 9.722 7.496l-.842-.21a.999.999 0 1 1 .484-1.94l3.23.806c.535.133.86.675.73 1.21l-.804 3.233a.997.997 0 0 1-1.21.73.997.997 0 0 1-.73-1.21l.23-.928v-.002z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>',\r\n        Type.STRING,\r\n    ],\r\n    iconUndo: [\r\n        '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9.185 10.81l.02-.038A4.997 4.997 0 0 1 13.683 8a5 5 0 0 1 5 5 5 5 0 0 1-5 5 1 1 0 0 0 0 2A7 7 0 1 0 7.496 9.722l-.21-.842a.999.999 0 1 0-1.94.484l.806 3.23c.133.535.675.86 1.21.73l3.233-.803a.997.997 0 0 0 .73-1.21.997.997 0 0 0-1.21-.73l-.928.23-.002-.001z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>',\r\n        Type.STRING,\r\n    ],\r\n    iconDone: [\r\n        '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M18.293 9.293a1 1 0 0 1 1.414 1.414l-7.002 7a1 1 0 0 1-1.414 0l-3.998-4a1 1 0 1 1 1.414-1.414L12 15.586l6.294-6.293z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>',\r\n        Type.STRING,\r\n    ],\r\n\r\n    // event handlers\r\n    oninit: [null, Type.FUNCTION],\r\n    onwarning: [null, Type.FUNCTION],\r\n    onerror: [null, Type.FUNCTION],\r\n    onactivatefile: [null, Type.FUNCTION],\r\n    oninitfile: [null, Type.FUNCTION],\r\n    onaddfilestart: [null, Type.FUNCTION],\r\n    onaddfileprogress: [null, Type.FUNCTION],\r\n    onaddfile: [null, Type.FUNCTION],\r\n    onprocessfilestart: [null, Type.FUNCTION],\r\n    onprocessfileprogress: [null, Type.FUNCTION],\r\n    onprocessfileabort: [null, Type.FUNCTION],\r\n    onprocessfilerevert: [null, Type.FUNCTION],\r\n    onprocessfile: [null, Type.FUNCTION],\r\n    onprocessfiles: [null, Type.FUNCTION],\r\n    onremovefile: [null, Type.FUNCTION],\r\n    onpreparefile: [null, Type.FUNCTION],\r\n    onupdatefiles: [null, Type.FUNCTION],\r\n    onreorderfiles: [null, Type.FUNCTION],\r\n\r\n    // hooks\r\n    beforeDropFile: [null, Type.FUNCTION],\r\n    beforeAddFile: [null, Type.FUNCTION],\r\n    beforeRemoveFile: [null, Type.FUNCTION],\r\n    beforePrepareFile: [null, Type.FUNCTION],\r\n\r\n    // styles\r\n    stylePanelLayout: [null, Type.STRING], // null 'integrated', 'compact', 'circle'\r\n    stylePanelAspectRatio: [null, Type.STRING], // null or '3:2' or 1\r\n    styleItemPanelAspectRatio: [null, Type.STRING],\r\n    styleButtonRemoveItemPosition: ['left', Type.STRING],\r\n    styleButtonProcessItemPosition: ['right', Type.STRING],\r\n    styleLoadIndicatorPosition: ['right', Type.STRING],\r\n    styleProgressIndicatorPosition: ['right', Type.STRING],\r\n    styleButtonRemoveItemAlign: [false, Type.BOOLEAN],\r\n\r\n    // custom initial files array\r\n    files: [[], Type.ARRAY],\r\n\r\n    // show support by displaying credits\r\n    credits: [['https://pqina.nl/', 'Powered by PQINA'], Type.ARRAY],\r\n};\r\n\r\nconst getItemByQuery = (items, query) => {\r\n    // just return first index\r\n    if (isEmpty(query)) {\r\n        return items[0] || null;\r\n    }\r\n\r\n    // query is index\r\n    if (isInt(query)) {\r\n        return items[query] || null;\r\n    }\r\n\r\n    // if query is item, get the id\r\n    if (typeof query === 'object') {\r\n        query = query.id;\r\n    }\r\n\r\n    // assume query is a string and return item by id\r\n    return items.find(item => item.id === query) || null;\r\n};\r\n\r\nconst getNumericAspectRatioFromString = aspectRatio => {\r\n    if (isEmpty(aspectRatio)) {\r\n        return aspectRatio;\r\n    }\r\n    if (/:/.test(aspectRatio)) {\r\n        const parts = aspectRatio.split(':');\r\n        return parts[1] / parts[0];\r\n    }\r\n    return parseFloat(aspectRatio);\r\n};\r\n\r\nconst getActiveItems = items => items.filter(item => !item.archived);\r\n\r\nconst Status = {\r\n    EMPTY: 0,\r\n    IDLE: 1, // waiting\r\n    ERROR: 2, // a file is in error state\r\n    BUSY: 3, // busy processing or loading\r\n    READY: 4, // all files uploaded\r\n};\r\n\r\nlet res = null;\r\nconst canUpdateFileInput = () => {\r\n    if (res === null) {\r\n        try {\r\n            const dataTransfer = new DataTransfer();\r\n            dataTransfer.items.add(new File(['hello world'], 'This_Works.txt'));\r\n            const el = document.createElement('input');\r\n            el.setAttribute('type', 'file');\r\n            el.files = dataTransfer.files;\r\n            res = el.files.length === 1;\r\n        } catch (err) {\r\n            res = false;\r\n        }\r\n    }\r\n    return res;\r\n};\r\n\r\nconst ITEM_ERROR = [\r\n    ItemStatus.LOAD_ERROR,\r\n    ItemStatus.PROCESSING_ERROR,\r\n    ItemStatus.PROCESSING_REVERT_ERROR,\r\n];\r\nconst ITEM_BUSY = [\r\n    ItemStatus.LOADING,\r\n    ItemStatus.PROCESSING,\r\n    ItemStatus.PROCESSING_QUEUED,\r\n    ItemStatus.INIT,\r\n];\r\nconst ITEM_READY = [ItemStatus.PROCESSING_COMPLETE];\r\n\r\nconst isItemInErrorState = item => ITEM_ERROR.includes(item.status);\r\nconst isItemInBusyState = item => ITEM_BUSY.includes(item.status);\r\nconst isItemInReadyState = item => ITEM_READY.includes(item.status);\r\n\r\nconst isAsync = state =>\r\n    isObject(state.options.server) &&\r\n    (isObject(state.options.server.process) || isFunction(state.options.server.process));\r\n\r\nconst queries = state => ({\r\n    GET_STATUS: () => {\r\n        const items = getActiveItems(state.items);\r\n\r\n        const { EMPTY, ERROR, BUSY, IDLE, READY } = Status;\r\n\r\n        if (items.length === 0) return EMPTY;\r\n\r\n        if (items.some(isItemInErrorState)) return ERROR;\r\n\r\n        if (items.some(isItemInBusyState)) return BUSY;\r\n\r\n        if (items.some(isItemInReadyState)) return READY;\r\n\r\n        return IDLE;\r\n    },\r\n\r\n    GET_ITEM: query => getItemByQuery(state.items, query),\r\n\r\n    GET_ACTIVE_ITEM: query => getItemByQuery(getActiveItems(state.items), query),\r\n\r\n    GET_ACTIVE_ITEMS: () => getActiveItems(state.items),\r\n\r\n    GET_ITEMS: () => state.items,\r\n\r\n    GET_ITEM_NAME: query => {\r\n        const item = getItemByQuery(state.items, query);\r\n        return item ? item.filename : null;\r\n    },\r\n\r\n    GET_ITEM_SIZE: query => {\r\n        const item = getItemByQuery(state.items, query);\r\n        return item ? item.fileSize : null;\r\n    },\r\n\r\n    GET_STYLES: () =>\r\n        Object.keys(state.options)\r\n            .filter(key => /^style/.test(key))\r\n            .map(option => ({\r\n                name: option,\r\n                value: state.options[option],\r\n            })),\r\n\r\n    GET_PANEL_ASPECT_RATIO: () => {\r\n        const isShapeCircle = /circle/.test(state.options.stylePanelLayout);\r\n        const aspectRatio = isShapeCircle\r\n            ? 1\r\n            : getNumericAspectRatioFromString(state.options.stylePanelAspectRatio);\r\n        return aspectRatio;\r\n    },\r\n\r\n    GET_ITEM_PANEL_ASPECT_RATIO: () => state.options.styleItemPanelAspectRatio,\r\n\r\n    GET_ITEMS_BY_STATUS: status =>\r\n        getActiveItems(state.items).filter(item => item.status === status),\r\n\r\n    GET_TOTAL_ITEMS: () => getActiveItems(state.items).length,\r\n\r\n    SHOULD_UPDATE_FILE_INPUT: () =>\r\n        state.options.storeAsFile && canUpdateFileInput() && !isAsync(state),\r\n\r\n    IS_ASYNC: () => isAsync(state),\r\n\r\n    GET_FILE_SIZE_LABELS: query => ({\r\n        labelBytes: query('GET_LABEL_FILE_SIZE_BYTES') || undefined,\r\n        labelKilobytes: query('GET_LABEL_FILE_SIZE_KILOBYTES') || undefined,\r\n        labelMegabytes: query('GET_LABEL_FILE_SIZE_MEGABYTES') || undefined,\r\n        labelGigabytes: query('GET_LABEL_FILE_SIZE_GIGABYTES') || undefined,\r\n    }),\r\n});\r\n\r\nconst hasRoomForItem = state => {\r\n    const count = getActiveItems(state.items).length;\r\n\r\n    // if cannot have multiple items, to add one item it should currently not contain items\r\n    if (!state.options.allowMultiple) {\r\n        return count === 0;\r\n    }\r\n\r\n    // if allows multiple items, we check if a max item count has been set, if not, there's no limit\r\n    const maxFileCount = state.options.maxFiles;\r\n    if (maxFileCount === null) {\r\n        return true;\r\n    }\r\n\r\n    // we check if the current count is smaller than the max count, if so, another file can still be added\r\n    if (count < maxFileCount) {\r\n        return true;\r\n    }\r\n\r\n    // no more room for another file\r\n    return false;\r\n};\r\n\r\nconst limit = (value, min, max) => Math.max(Math.min(max, value), min);\r\n\r\nconst arrayInsert = (arr, index, item) => arr.splice(index, 0, item);\r\n\r\nconst insertItem = (items, item, index) => {\r\n    if (isEmpty(item)) {\r\n        return null;\r\n    }\r\n\r\n    // if index is undefined, append\r\n    if (typeof index === 'undefined') {\r\n        items.push(item);\r\n        return item;\r\n    }\r\n\r\n    // limit the index to the size of the items array\r\n    index = limit(index, 0, items.length);\r\n\r\n    // add item to array\r\n    arrayInsert(items, index, item);\r\n\r\n    // expose\r\n    return item;\r\n};\r\n\r\nconst isBase64DataURI = str =>\r\n    /^\\s*data:([a-z]+\\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\\-._~:@\\/?%\\s]*)\\s*$/i.test(\r\n        str\r\n    );\r\n\r\nconst getFilenameFromURL = url =>\r\n    `${url}`\r\n        .split('/')\r\n        .pop()\r\n        .split('?')\r\n        .shift();\r\n\r\nconst getExtensionFromFilename = name => name.split('.').pop();\r\n\r\nconst guesstimateExtension = type => {\r\n    // if no extension supplied, exit here\r\n    if (typeof type !== 'string') {\r\n        return '';\r\n    }\r\n\r\n    // get subtype\r\n    const subtype = type.split('/').pop();\r\n\r\n    // is svg subtype\r\n    if (/svg/.test(subtype)) {\r\n        return 'svg';\r\n    }\r\n\r\n    if (/zip|compressed/.test(subtype)) {\r\n        return 'zip';\r\n    }\r\n\r\n    if (/plain/.test(subtype)) {\r\n        return 'txt';\r\n    }\r\n\r\n    if (/msword/.test(subtype)) {\r\n        return 'doc';\r\n    }\r\n\r\n    // if is valid subtype\r\n    if (/[a-z]+/.test(subtype)) {\r\n        // always use jpg extension\r\n        if (subtype === 'jpeg') {\r\n            return 'jpg';\r\n        }\r\n\r\n        // return subtype\r\n        return subtype;\r\n    }\r\n\r\n    return '';\r\n};\r\n\r\nconst leftPad = (value, padding = '') => (padding + value).slice(-padding.length);\r\n\r\nconst getDateString = (date = new Date()) =>\r\n    `${date.getFullYear()}-${leftPad(date.getMonth() + 1, '00')}-${leftPad(\r\n        date.getDate(),\r\n        '00'\r\n    )}_${leftPad(date.getHours(), '00')}-${leftPad(date.getMinutes(), '00')}-${leftPad(\r\n        date.getSeconds(),\r\n        '00'\r\n    )}`;\r\n\r\nconst getFileFromBlob = (blob, filename, type = null, extension = null) => {\r\n    const file =\r\n        typeof type === 'string'\r\n            ? blob.slice(0, blob.size, type)\r\n            : blob.slice(0, blob.size, blob.type);\r\n    file.lastModifiedDate = new Date();\r\n\r\n    // copy relative path\r\n    if (blob._relativePath) file._relativePath = blob._relativePath;\r\n\r\n    // if blob has name property, use as filename if no filename supplied\r\n    if (!isString(filename)) {\r\n        filename = getDateString();\r\n    }\r\n\r\n    // if filename supplied but no extension and filename has extension\r\n    if (filename && extension === null && getExtensionFromFilename(filename)) {\r\n        file.name = filename;\r\n    } else {\r\n        extension = extension || guesstimateExtension(file.type);\r\n        file.name = filename + (extension ? '.' + extension : '');\r\n    }\r\n\r\n    return file;\r\n};\r\n\r\nconst getBlobBuilder = () => {\r\n    return (window.BlobBuilder =\r\n        window.BlobBuilder ||\r\n        window.WebKitBlobBuilder ||\r\n        window.MozBlobBuilder ||\r\n        window.MSBlobBuilder);\r\n};\r\n\r\nconst createBlob = (arrayBuffer, mimeType) => {\r\n    const BB = getBlobBuilder();\r\n\r\n    if (BB) {\r\n        const bb = new BB();\r\n        bb.append(arrayBuffer);\r\n        return bb.getBlob(mimeType);\r\n    }\r\n\r\n    return new Blob([arrayBuffer], {\r\n        type: mimeType,\r\n    });\r\n};\r\n\r\nconst getBlobFromByteStringWithMimeType = (byteString, mimeType) => {\r\n    const ab = new ArrayBuffer(byteString.length);\r\n    const ia = new Uint8Array(ab);\r\n\r\n    for (let i = 0; i < byteString.length; i++) {\r\n        ia[i] = byteString.charCodeAt(i);\r\n    }\r\n\r\n    return createBlob(ab, mimeType);\r\n};\r\n\r\nconst getMimeTypeFromBase64DataURI = dataURI => {\r\n    return (/^data:(.+);/.exec(dataURI) || [])[1] || null;\r\n};\r\n\r\nconst getBase64DataFromBase64DataURI = dataURI => {\r\n    // get data part of string (remove data:image/jpeg...,)\r\n    const data = dataURI.split(',')[1];\r\n\r\n    // remove any whitespace as that causes InvalidCharacterError in IE\r\n    return data.replace(/\\s/g, '');\r\n};\r\n\r\nconst getByteStringFromBase64DataURI = dataURI => {\r\n    return atob(getBase64DataFromBase64DataURI(dataURI));\r\n};\r\n\r\nconst getBlobFromBase64DataURI = dataURI => {\r\n    const mimeType = getMimeTypeFromBase64DataURI(dataURI);\r\n    const byteString = getByteStringFromBase64DataURI(dataURI);\r\n\r\n    return getBlobFromByteStringWithMimeType(byteString, mimeType);\r\n};\r\n\r\nconst getFileFromBase64DataURI = (dataURI, filename, extension) => {\r\n    return getFileFromBlob(getBlobFromBase64DataURI(dataURI), filename, null, extension);\r\n};\r\n\r\nconst getFileNameFromHeader = header => {\r\n    // test if is content disposition header, if not exit\r\n    if (!/^content-disposition:/i.test(header)) return null;\r\n\r\n    // get filename parts\r\n    const matches = header\r\n        .split(/filename=|filename\\*=.+''/)\r\n        .splice(1)\r\n        .map(name => name.trim().replace(/^[\"']|[;\"']{0,2}$/g, ''))\r\n        .filter(name => name.length);\r\n\r\n    return matches.length ? decodeURI(matches[matches.length - 1]) : null;\r\n};\r\n\r\nconst getFileSizeFromHeader = header => {\r\n    if (/content-length:/i.test(header)) {\r\n        const size = header.match(/[0-9]+/)[0];\r\n        return size ? parseInt(size, 10) : null;\r\n    }\r\n    return null;\r\n};\r\n\r\nconst getTranfserIdFromHeader = header => {\r\n    if (/x-content-transfer-id:/i.test(header)) {\r\n        const id = (header.split(':')[1] || '').trim();\r\n        return id || null;\r\n    }\r\n    return null;\r\n};\r\n\r\nconst getFileInfoFromHeaders = headers => {\r\n    const info = {\r\n        source: null,\r\n        name: null,\r\n        size: null,\r\n    };\r\n\r\n    const rows = headers.split('\\n');\r\n    for (let header of rows) {\r\n        const name = getFileNameFromHeader(header);\r\n        if (name) {\r\n            info.name = name;\r\n            continue;\r\n        }\r\n\r\n        const size = getFileSizeFromHeader(header);\r\n        if (size) {\r\n            info.size = size;\r\n            continue;\r\n        }\r\n\r\n        const source = getTranfserIdFromHeader(header);\r\n        if (source) {\r\n            info.source = source;\r\n            continue;\r\n        }\r\n    }\r\n\r\n    return info;\r\n};\r\n\r\nconst createFileLoader = fetchFn => {\r\n    const state = {\r\n        source: null,\r\n        complete: false,\r\n        progress: 0,\r\n        size: null,\r\n        timestamp: null,\r\n        duration: 0,\r\n        request: null,\r\n    };\r\n\r\n    const getProgress = () => state.progress;\r\n    const abort = () => {\r\n        if (state.request && state.request.abort) {\r\n            state.request.abort();\r\n        }\r\n    };\r\n\r\n    // load source\r\n    const load = () => {\r\n        // get quick reference\r\n        const source = state.source;\r\n\r\n        api.fire('init', source);\r\n\r\n        // Load Files\r\n        if (source instanceof File) {\r\n            api.fire('load', source);\r\n        } else if (source instanceof Blob) {\r\n            // Load blobs, set default name to current date\r\n            api.fire('load', getFileFromBlob(source, source.name));\r\n        } else if (isBase64DataURI(source)) {\r\n            // Load base 64, set default name to current date\r\n            api.fire('load', getFileFromBase64DataURI(source));\r\n        } else {\r\n            // Deal as if is external URL, let's load it!\r\n            loadURL(source);\r\n        }\r\n    };\r\n\r\n    // loads a url\r\n    const loadURL = url => {\r\n        // is remote url and no fetch method supplied\r\n        if (!fetchFn) {\r\n            api.fire('error', {\r\n                type: 'error',\r\n                body: \"Can't load URL\",\r\n                code: 400,\r\n            });\r\n            return;\r\n        }\r\n\r\n        // set request start\r\n        state.timestamp = Date.now();\r\n\r\n        // load file\r\n        state.request = fetchFn(\r\n            url,\r\n            response => {\r\n                // update duration\r\n                state.duration = Date.now() - state.timestamp;\r\n\r\n                // done!\r\n                state.complete = true;\r\n\r\n                // turn blob response into a file\r\n                if (response instanceof Blob) {\r\n                    response = getFileFromBlob(response, response.name || getFilenameFromURL(url));\r\n                }\r\n\r\n                api.fire(\r\n                    'load',\r\n                    // if has received blob, we go with blob, if no response, we return null\r\n                    response instanceof Blob ? response : response ? response.body : null\r\n                );\r\n            },\r\n            error => {\r\n                api.fire(\r\n                    'error',\r\n                    typeof error === 'string'\r\n                        ? {\r\n                              type: 'error',\r\n                              code: 0,\r\n                              body: error,\r\n                          }\r\n                        : error\r\n                );\r\n            },\r\n            (computable, current, total) => {\r\n                // collected some meta data already\r\n                if (total) {\r\n                    state.size = total;\r\n                }\r\n\r\n                // update duration\r\n                state.duration = Date.now() - state.timestamp;\r\n\r\n                // if we can't compute progress, we're not going to fire progress events\r\n                if (!computable) {\r\n                    state.progress = null;\r\n                    return;\r\n                }\r\n\r\n                // update progress percentage\r\n                state.progress = current / total;\r\n\r\n                // expose\r\n                api.fire('progress', state.progress);\r\n            },\r\n            () => {\r\n                api.fire('abort');\r\n            },\r\n            response => {\r\n                const fileinfo = getFileInfoFromHeaders(\r\n                    typeof response === 'string' ? response : response.headers\r\n                );\r\n                api.fire('meta', {\r\n                    size: state.size || fileinfo.size,\r\n                    filename: fileinfo.name,\r\n                    source: fileinfo.source,\r\n                });\r\n            }\r\n        );\r\n    };\r\n\r\n    const api = {\r\n        ...on(),\r\n        setSource: source => (state.source = source),\r\n        getProgress, // file load progress\r\n        abort, // abort file load\r\n        load, // start load\r\n    };\r\n\r\n    return api;\r\n};\r\n\r\nconst isGet = method => /GET|HEAD/.test(method);\r\n\r\nconst sendRequest = (data, url, options) => {\r\n    const api = {\r\n        onheaders: () => {},\r\n        onprogress: () => {},\r\n        onload: () => {},\r\n        ontimeout: () => {},\r\n        onerror: () => {},\r\n        onabort: () => {},\r\n        abort: () => {\r\n            aborted = true;\r\n            xhr.abort();\r\n        },\r\n    };\r\n\r\n    // timeout identifier, only used when timeout is defined\r\n    let aborted = false;\r\n    let headersReceived = false;\r\n\r\n    // set default options\r\n    options = {\r\n        method: 'POST',\r\n        headers: {},\r\n        withCredentials: false,\r\n        ...options,\r\n    };\r\n\r\n    // encode url\r\n    url = encodeURI(url);\r\n\r\n    // if method is GET, add any received data to url\r\n\r\n    if (isGet(options.method) && data) {\r\n        url = `${url}${encodeURIComponent(typeof data === 'string' ? data : JSON.stringify(data))}`;\r\n    }\r\n\r\n    // create request\r\n    const xhr = new XMLHttpRequest();\r\n\r\n    // progress of load\r\n    const process = isGet(options.method) ? xhr : xhr.upload;\r\n    process.onprogress = e => {\r\n        // no progress event when aborted ( onprogress is called once after abort() )\r\n        if (aborted) {\r\n            return;\r\n        }\r\n\r\n        api.onprogress(e.lengthComputable, e.loaded, e.total);\r\n    };\r\n\r\n    // tries to get header info to the app as fast as possible\r\n    xhr.onreadystatechange = () => {\r\n        // not interesting in these states ('unsent' and 'openend' as they don't give us any additional info)\r\n        if (xhr.readyState < 2) {\r\n            return;\r\n        }\r\n\r\n        // no server response\r\n        if (xhr.readyState === 4 && xhr.status === 0) {\r\n            return;\r\n        }\r\n\r\n        if (headersReceived) {\r\n            return;\r\n        }\r\n\r\n        headersReceived = true;\r\n\r\n        // we've probably received some useful data in response headers\r\n        api.onheaders(xhr);\r\n    };\r\n\r\n    // load successful\r\n    xhr.onload = () => {\r\n        // is classified as valid response\r\n        if (xhr.status >= 200 && xhr.status < 300) {\r\n            api.onload(xhr);\r\n        } else {\r\n            api.onerror(xhr);\r\n        }\r\n    };\r\n\r\n    // error during load\r\n    xhr.onerror = () => api.onerror(xhr);\r\n\r\n    // request aborted\r\n    xhr.onabort = () => {\r\n        aborted = true;\r\n        api.onabort();\r\n    };\r\n\r\n    // request timeout\r\n    xhr.ontimeout = () => api.ontimeout(xhr);\r\n\r\n    // open up open up!\r\n    xhr.open(options.method, url, true);\r\n\r\n    // set timeout if defined (do it after open so IE11 plays ball)\r\n    if (isInt(options.timeout)) {\r\n        xhr.timeout = options.timeout;\r\n    }\r\n\r\n    // add headers\r\n    Object.keys(options.headers).forEach(key => {\r\n        const value = unescape(encodeURIComponent(options.headers[key]));\r\n        xhr.setRequestHeader(key, value);\r\n    });\r\n\r\n    // set type of response\r\n    if (options.responseType) {\r\n        xhr.responseType = options.responseType;\r\n    }\r\n\r\n    // set credentials\r\n    if (options.withCredentials) {\r\n        xhr.withCredentials = true;\r\n    }\r\n\r\n    // let's send our data\r\n    xhr.send(data);\r\n\r\n    return api;\r\n};\r\n\r\nconst createResponse = (type, code, body, headers) => ({\r\n    type,\r\n    code,\r\n    body,\r\n    headers,\r\n});\r\n\r\nconst createTimeoutResponse = cb => xhr => {\r\n    cb(createResponse('error', 0, 'Timeout', xhr.getAllResponseHeaders()));\r\n};\r\n\r\nconst hasQS = str => /\\?/.test(str);\r\nconst buildURL = (...parts) => {\r\n    let url = '';\r\n    parts.forEach(part => {\r\n        url += hasQS(url) && hasQS(part) ? part.replace(/\\?/, '&') : part;\r\n    });\r\n    return url;\r\n};\r\n\r\nconst createFetchFunction = (apiUrl = '', action) => {\r\n    // custom handler (should also handle file, load, error, progress and abort)\r\n    if (typeof action === 'function') {\r\n        return action;\r\n    }\r\n\r\n    // no action supplied\r\n    if (!action || !isString(action.url)) {\r\n        return null;\r\n    }\r\n\r\n    // set onload hanlder\r\n    const onload = action.onload || (res => res);\r\n    const onerror = action.onerror || (res => null);\r\n\r\n    // internal handler\r\n    return (url, load, error, progress, abort, headers) => {\r\n        // do local or remote request based on if the url is external\r\n        const request = sendRequest(url, buildURL(apiUrl, action.url), {\r\n            ...action,\r\n            responseType: 'blob',\r\n        });\r\n\r\n        request.onload = xhr => {\r\n            // get headers\r\n            const headers = xhr.getAllResponseHeaders();\r\n\r\n            // get filename\r\n            const filename = getFileInfoFromHeaders(headers).name || getFilenameFromURL(url);\r\n\r\n            // create response\r\n            load(\r\n                createResponse(\r\n                    'load',\r\n                    xhr.status,\r\n                    action.method === 'HEAD'\r\n                        ? null\r\n                        : getFileFromBlob(onload(xhr.response), filename),\r\n                    headers\r\n                )\r\n            );\r\n        };\r\n\r\n        request.onerror = xhr => {\r\n            error(\r\n                createResponse(\r\n                    'error',\r\n                    xhr.status,\r\n                    onerror(xhr.response) || xhr.statusText,\r\n                    xhr.getAllResponseHeaders()\r\n                )\r\n            );\r\n        };\r\n\r\n        request.onheaders = xhr => {\r\n            headers(createResponse('headers', xhr.status, null, xhr.getAllResponseHeaders()));\r\n        };\r\n\r\n        request.ontimeout = createTimeoutResponse(error);\r\n        request.onprogress = progress;\r\n        request.onabort = abort;\r\n\r\n        // should return request\r\n        return request;\r\n    };\r\n};\r\n\r\nconst ChunkStatus = {\r\n    QUEUED: 0,\r\n    COMPLETE: 1,\r\n    PROCESSING: 2,\r\n    ERROR: 3,\r\n    WAITING: 4,\r\n};\r\n\r\n/*\r\nfunction signature:\r\n  (file, metadata, load, error, progress, abort, transfer, options) => {\r\n    return {\r\n    abort:() => {}\r\n  }\r\n}\r\n*/\r\n\r\n// apiUrl, action, name, file, metadata, load, error, progress, abort, transfer, options\r\nconst processFileChunked = (\r\n    apiUrl,\r\n    action,\r\n    name,\r\n    file,\r\n    metadata,\r\n    load,\r\n    error,\r\n    progress,\r\n    abort,\r\n    transfer,\r\n    options\r\n) => {\r\n    // all chunks\r\n    const chunks = [];\r\n    const { chunkTransferId, chunkServer, chunkSize, chunkRetryDelays } = options;\r\n\r\n    // default state\r\n    const state = {\r\n        serverId: chunkTransferId,\r\n        aborted: false,\r\n    };\r\n\r\n    // set onload handlers\r\n    const ondata = action.ondata || (fd => fd);\r\n    const onload =\r\n        action.onload ||\r\n        ((xhr, method) =>\r\n            method === 'HEAD' ? xhr.getResponseHeader('Upload-Offset') : xhr.response);\r\n    const onerror = action.onerror || (res => null);\r\n\r\n    // create server hook\r\n    const requestTransferId = cb => {\r\n        const formData = new FormData();\r\n\r\n        // add metadata under same name\r\n        if (isObject(metadata)) formData.append(name, JSON.stringify(metadata));\r\n\r\n        const headers =\r\n            typeof action.headers === 'function'\r\n                ? action.headers(file, metadata)\r\n                : {\r\n                      ...action.headers,\r\n                      'Upload-Length': file.size,\r\n                  };\r\n\r\n        const requestParams = {\r\n            ...action,\r\n            headers,\r\n        };\r\n\r\n        // send request object\r\n        const request = sendRequest(ondata(formData), buildURL(apiUrl, action.url), requestParams);\r\n\r\n        request.onload = xhr => cb(onload(xhr, requestParams.method));\r\n\r\n        request.onerror = xhr =>\r\n            error(\r\n                createResponse(\r\n                    'error',\r\n                    xhr.status,\r\n                    onerror(xhr.response) || xhr.statusText,\r\n                    xhr.getAllResponseHeaders()\r\n                )\r\n            );\r\n\r\n        request.ontimeout = createTimeoutResponse(error);\r\n    };\r\n\r\n    const requestTransferOffset = cb => {\r\n        const requestUrl = buildURL(apiUrl, chunkServer.url, state.serverId);\r\n\r\n        const headers =\r\n            typeof action.headers === 'function'\r\n                ? action.headers(state.serverId)\r\n                : {\r\n                      ...action.headers,\r\n                  };\r\n\r\n        const requestParams = {\r\n            headers,\r\n            method: 'HEAD',\r\n        };\r\n\r\n        const request = sendRequest(null, requestUrl, requestParams);\r\n\r\n        request.onload = xhr => cb(onload(xhr, requestParams.method));\r\n\r\n        request.onerror = xhr =>\r\n            error(\r\n                createResponse(\r\n                    'error',\r\n                    xhr.status,\r\n                    onerror(xhr.response) || xhr.statusText,\r\n                    xhr.getAllResponseHeaders()\r\n                )\r\n            );\r\n\r\n        request.ontimeout = createTimeoutResponse(error);\r\n    };\r\n\r\n    // create chunks\r\n    const lastChunkIndex = Math.floor(file.size / chunkSize);\r\n    for (let i = 0; i <= lastChunkIndex; i++) {\r\n        const offset = i * chunkSize;\r\n        const data = file.slice(offset, offset + chunkSize, 'application/offset+octet-stream');\r\n        chunks[i] = {\r\n            index: i,\r\n            size: data.size,\r\n            offset,\r\n            data,\r\n            file,\r\n            progress: 0,\r\n            retries: [...chunkRetryDelays],\r\n            status: ChunkStatus.QUEUED,\r\n            error: null,\r\n            request: null,\r\n            timeout: null,\r\n        };\r\n    }\r\n\r\n    const completeProcessingChunks = () => load(state.serverId);\r\n\r\n    const canProcessChunk = chunk =>\r\n        chunk.status === ChunkStatus.QUEUED || chunk.status === ChunkStatus.ERROR;\r\n\r\n    const processChunk = chunk => {\r\n        // processing is paused, wait here\r\n        if (state.aborted) return;\r\n\r\n        // get next chunk to process\r\n        chunk = chunk || chunks.find(canProcessChunk);\r\n\r\n        // no more chunks to process\r\n        if (!chunk) {\r\n            // all done?\r\n            if (chunks.every(chunk => chunk.status === ChunkStatus.COMPLETE)) {\r\n                completeProcessingChunks();\r\n            }\r\n\r\n            // no chunk to handle\r\n            return;\r\n        }\r\n\r\n        // now processing this chunk\r\n        chunk.status = ChunkStatus.PROCESSING;\r\n        chunk.progress = null;\r\n\r\n        // allow parsing of formdata\r\n        const ondata = chunkServer.ondata || (fd => fd);\r\n        const onerror = chunkServer.onerror || (res => null);\r\n        const onload = chunkServer.onload || (() => {});\r\n\r\n        // send request object\r\n        const requestUrl = buildURL(apiUrl, chunkServer.url, state.serverId);\r\n\r\n        const headers =\r\n            typeof chunkServer.headers === 'function'\r\n                ? chunkServer.headers(chunk)\r\n                : {\r\n                      ...chunkServer.headers,\r\n                      'Content-Type': 'application/offset+octet-stream',\r\n                      'Upload-Offset': chunk.offset,\r\n                      'Upload-Length': file.size,\r\n                      'Upload-Name': file.name,\r\n                  };\r\n\r\n        const request = (chunk.request = sendRequest(ondata(chunk.data), requestUrl, {\r\n            ...chunkServer,\r\n            headers,\r\n        }));\r\n\r\n        request.onload = xhr => {\r\n            // allow hooking into request result\r\n            onload(xhr, chunk.index, chunks.length);\r\n\r\n            // done!\r\n            chunk.status = ChunkStatus.COMPLETE;\r\n\r\n            // remove request reference\r\n            chunk.request = null;\r\n\r\n            // start processing more chunks\r\n            processChunks();\r\n        };\r\n\r\n        request.onprogress = (lengthComputable, loaded, total) => {\r\n            chunk.progress = lengthComputable ? loaded : null;\r\n            updateTotalProgress();\r\n        };\r\n\r\n        request.onerror = xhr => {\r\n            chunk.status = ChunkStatus.ERROR;\r\n            chunk.request = null;\r\n            chunk.error = onerror(xhr.response) || xhr.statusText;\r\n            if (!retryProcessChunk(chunk)) {\r\n                error(\r\n                    createResponse(\r\n                        'error',\r\n                        xhr.status,\r\n                        onerror(xhr.response) || xhr.statusText,\r\n                        xhr.getAllResponseHeaders()\r\n                    )\r\n                );\r\n            }\r\n        };\r\n\r\n        request.ontimeout = xhr => {\r\n            chunk.status = ChunkStatus.ERROR;\r\n            chunk.request = null;\r\n            if (!retryProcessChunk(chunk)) {\r\n                createTimeoutResponse(error)(xhr);\r\n            }\r\n        };\r\n\r\n        request.onabort = () => {\r\n            chunk.status = ChunkStatus.QUEUED;\r\n            chunk.request = null;\r\n            abort();\r\n        };\r\n    };\r\n\r\n    const retryProcessChunk = chunk => {\r\n        // no more retries left\r\n        if (chunk.retries.length === 0) return false;\r\n\r\n        // new retry\r\n        chunk.status = ChunkStatus.WAITING;\r\n        clearTimeout(chunk.timeout);\r\n        chunk.timeout = setTimeout(() => {\r\n            processChunk(chunk);\r\n        }, chunk.retries.shift());\r\n\r\n        // we're going to retry\r\n        return true;\r\n    };\r\n\r\n    const updateTotalProgress = () => {\r\n        // calculate total progress fraction\r\n        const totalBytesTransfered = chunks.reduce((p, chunk) => {\r\n            if (p === null || chunk.progress === null) return null;\r\n            return p + chunk.progress;\r\n        }, 0);\r\n\r\n        // can't compute progress\r\n        if (totalBytesTransfered === null) return progress(false, 0, 0);\r\n\r\n        // calculate progress values\r\n        const totalSize = chunks.reduce((total, chunk) => total + chunk.size, 0);\r\n\r\n        // can update progress indicator\r\n        progress(true, totalBytesTransfered, totalSize);\r\n    };\r\n\r\n    // process new chunks\r\n    const processChunks = () => {\r\n        const totalProcessing = chunks.filter(chunk => chunk.status === ChunkStatus.PROCESSING)\r\n            .length;\r\n        if (totalProcessing >= 1) return;\r\n        processChunk();\r\n    };\r\n\r\n    const abortChunks = () => {\r\n        chunks.forEach(chunk => {\r\n            clearTimeout(chunk.timeout);\r\n            if (chunk.request) {\r\n                chunk.request.abort();\r\n            }\r\n        });\r\n    };\r\n\r\n    // let's go!\r\n    if (!state.serverId) {\r\n        requestTransferId(serverId => {\r\n            // stop here if aborted, might have happened in between request and callback\r\n            if (state.aborted) return;\r\n\r\n            // pass back to item so we can use it if something goes wrong\r\n            transfer(serverId);\r\n\r\n            // store internally\r\n            state.serverId = serverId;\r\n            processChunks();\r\n        });\r\n    } else {\r\n        requestTransferOffset(offset => {\r\n            // stop here if aborted, might have happened in between request and callback\r\n            if (state.aborted) return;\r\n\r\n            // mark chunks with lower offset as complete\r\n            chunks\r\n                .filter(chunk => chunk.offset < offset)\r\n                .forEach(chunk => {\r\n                    chunk.status = ChunkStatus.COMPLETE;\r\n                    chunk.progress = chunk.size;\r\n                });\r\n\r\n            // continue processing\r\n            processChunks();\r\n        });\r\n    }\r\n\r\n    return {\r\n        abort: () => {\r\n            state.aborted = true;\r\n            abortChunks();\r\n        },\r\n    };\r\n};\r\n\r\n/*\r\nfunction signature:\r\n  (file, metadata, load, error, progress, abort) => {\r\n    return {\r\n    abort:() => {}\r\n  }\r\n}\r\n*/\r\nconst createFileProcessorFunction = (apiUrl, action, name, options) => (\r\n    file,\r\n    metadata,\r\n    load,\r\n    error,\r\n    progress,\r\n    abort,\r\n    transfer\r\n) => {\r\n    // no file received\r\n    if (!file) return;\r\n\r\n    // if was passed a file, and we can chunk it, exit here\r\n    const canChunkUpload = options.chunkUploads;\r\n    const shouldChunkUpload = canChunkUpload && file.size > options.chunkSize;\r\n    const willChunkUpload = canChunkUpload && (shouldChunkUpload || options.chunkForce);\r\n    if (file instanceof Blob && willChunkUpload)\r\n        return processFileChunked(\r\n            apiUrl,\r\n            action,\r\n            name,\r\n            file,\r\n            metadata,\r\n            load,\r\n            error,\r\n            progress,\r\n            abort,\r\n            transfer,\r\n            options\r\n        );\r\n\r\n    // set handlers\r\n    const ondata = action.ondata || (fd => fd);\r\n    const onload = action.onload || (res => res);\r\n    const onerror = action.onerror || (res => null);\r\n\r\n    const headers =\r\n        typeof action.headers === 'function'\r\n            ? action.headers(file, metadata) || {}\r\n            : {\r\n                  ...action.headers,\r\n              };\r\n\r\n    const requestParams = {\r\n        ...action,\r\n        headers,\r\n    };\r\n\r\n    // create formdata object\r\n    var formData = new FormData();\r\n\r\n    // add metadata under same name\r\n    if (isObject(metadata)) {\r\n        formData.append(name, JSON.stringify(metadata));\r\n    }\r\n\r\n    // Turn into an array of objects so no matter what the input, we can handle it the same way\r\n    (file instanceof Blob ? [{ name: null, file }] : file).forEach(item => {\r\n        formData.append(\r\n            name,\r\n            item.file,\r\n            item.name === null ? item.file.name : `${item.name}${item.file.name}`\r\n        );\r\n    });\r\n\r\n    // send request object\r\n    const request = sendRequest(ondata(formData), buildURL(apiUrl, action.url), requestParams);\r\n    request.onload = xhr => {\r\n        load(createResponse('load', xhr.status, onload(xhr.response), xhr.getAllResponseHeaders()));\r\n    };\r\n\r\n    request.onerror = xhr => {\r\n        error(\r\n            createResponse(\r\n                'error',\r\n                xhr.status,\r\n                onerror(xhr.response) || xhr.statusText,\r\n                xhr.getAllResponseHeaders()\r\n            )\r\n        );\r\n    };\r\n\r\n    request.ontimeout = createTimeoutResponse(error);\r\n    request.onprogress = progress;\r\n    request.onabort = abort;\r\n\r\n    // should return request\r\n    return request;\r\n};\r\n\r\nconst createProcessorFunction = (apiUrl = '', action, name, options) => {\r\n    // custom handler (should also handle file, load, error, progress and abort)\r\n    if (typeof action === 'function') return (...params) => action(name, ...params, options);\r\n\r\n    // no action supplied\r\n    if (!action || !isString(action.url)) return null;\r\n\r\n    // internal handler\r\n    return createFileProcessorFunction(apiUrl, action, name, options);\r\n};\r\n\r\n/*\r\n function signature:\r\n (uniqueFileId, load, error) => { }\r\n */\r\nconst createRevertFunction = (apiUrl = '', action) => {\r\n    // is custom implementation\r\n    if (typeof action === 'function') {\r\n        return action;\r\n    }\r\n\r\n    // no action supplied, return stub function, interface will work, but file won't be removed\r\n    if (!action || !isString(action.url)) {\r\n        return (uniqueFileId, load) => load();\r\n    }\r\n\r\n    // set onload hanlder\r\n    const onload = action.onload || (res => res);\r\n    const onerror = action.onerror || (res => null);\r\n\r\n    // internal implementation\r\n    return (uniqueFileId, load, error) => {\r\n        const request = sendRequest(\r\n            uniqueFileId,\r\n            apiUrl + action.url,\r\n            action // contains method, headers and withCredentials properties\r\n        );\r\n        request.onload = xhr => {\r\n            load(\r\n                createResponse(\r\n                    'load',\r\n                    xhr.status,\r\n                    onload(xhr.response),\r\n                    xhr.getAllResponseHeaders()\r\n                )\r\n            );\r\n        };\r\n\r\n        request.onerror = xhr => {\r\n            error(\r\n                createResponse(\r\n                    'error',\r\n                    xhr.status,\r\n                    onerror(xhr.response) || xhr.statusText,\r\n                    xhr.getAllResponseHeaders()\r\n                )\r\n            );\r\n        };\r\n\r\n        request.ontimeout = createTimeoutResponse(error);\r\n\r\n        return request;\r\n    };\r\n};\r\n\r\nconst getRandomNumber = (min = 0, max = 1) => min + Math.random() * (max - min);\r\n\r\nconst createPerceivedPerformanceUpdater = (\r\n    cb,\r\n    duration = 1000,\r\n    offset = 0,\r\n    tickMin = 25,\r\n    tickMax = 250\r\n) => {\r\n    let timeout = null;\r\n    const start = Date.now();\r\n\r\n    const tick = () => {\r\n        let runtime = Date.now() - start;\r\n        let delay = getRandomNumber(tickMin, tickMax);\r\n\r\n        if (runtime + delay > duration) {\r\n            delay = runtime + delay - duration;\r\n        }\r\n\r\n        let progress = runtime / duration;\r\n        if (progress >= 1 || document.hidden) {\r\n            cb(1);\r\n            return;\r\n        }\r\n\r\n        cb(progress);\r\n\r\n        timeout = setTimeout(tick, delay);\r\n    };\r\n\r\n    if (duration > 0) tick();\r\n\r\n    return {\r\n        clear: () => {\r\n            clearTimeout(timeout);\r\n        },\r\n    };\r\n};\r\n\r\nconst createFileProcessor = (processFn, options) => {\r\n    const state = {\r\n        complete: false,\r\n        perceivedProgress: 0,\r\n        perceivedPerformanceUpdater: null,\r\n        progress: null,\r\n        timestamp: null,\r\n        perceivedDuration: 0,\r\n        duration: 0,\r\n        request: null,\r\n        response: null,\r\n    };\r\n\r\n    const { allowMinimumUploadDuration } = options;\r\n\r\n    const process = (file, metadata) => {\r\n        const progressFn = () => {\r\n            // we've not yet started the real download, stop here\r\n            // the request might not go through, for instance, there might be some server trouble\r\n            // if state.progress is null, the server does not allow computing progress and we show the spinner instead\r\n            if (state.duration === 0 || state.progress === null) return;\r\n\r\n            // as we're now processing, fire the progress event\r\n            api.fire('progress', api.getProgress());\r\n        };\r\n\r\n        const completeFn = () => {\r\n            state.complete = true;\r\n            api.fire('load-perceived', state.response.body);\r\n        };\r\n\r\n        // let's start processing\r\n        api.fire('start');\r\n\r\n        // set request start\r\n        state.timestamp = Date.now();\r\n\r\n        // create perceived performance progress indicator\r\n        state.perceivedPerformanceUpdater = createPerceivedPerformanceUpdater(\r\n            progress => {\r\n                state.perceivedProgress = progress;\r\n                state.perceivedDuration = Date.now() - state.timestamp;\r\n\r\n                progressFn();\r\n\r\n                // if fake progress is done, and a response has been received,\r\n                // and we've not yet called the complete method\r\n                if (state.response && state.perceivedProgress === 1 && !state.complete) {\r\n                    // we done!\r\n                    completeFn();\r\n                }\r\n            },\r\n            // random delay as in a list of files you start noticing\r\n            // files uploading at the exact same speed\r\n            allowMinimumUploadDuration ? getRandomNumber(750, 1500) : 0\r\n        );\r\n\r\n        // remember request so we can abort it later\r\n        state.request = processFn(\r\n            // the file to process\r\n            file,\r\n\r\n            // the metadata to send along\r\n            metadata,\r\n\r\n            // callbacks (load, error, progress, abort, transfer)\r\n            // load expects the body to be a server id if\r\n            // you want to make use of revert\r\n            response => {\r\n                // we put the response in state so we can access\r\n                // it outside of this method\r\n                state.response = isObject(response)\r\n                    ? response\r\n                    : {\r\n                          type: 'load',\r\n                          code: 200,\r\n                          body: `${response}`,\r\n                          headers: {},\r\n                      };\r\n\r\n                // update duration\r\n                state.duration = Date.now() - state.timestamp;\r\n\r\n                // force progress to 1 as we're now done\r\n                state.progress = 1;\r\n\r\n                // actual load is done let's share results\r\n                api.fire('load', state.response.body);\r\n\r\n                // we are really done\r\n                // if perceived progress is 1 ( wait for perceived progress to complete )\r\n                // or if server does not support progress ( null )\r\n                if (\r\n                    !allowMinimumUploadDuration ||\r\n                    (allowMinimumUploadDuration && state.perceivedProgress === 1)\r\n                ) {\r\n                    completeFn();\r\n                }\r\n            },\r\n\r\n            // error is expected to be an object with type, code, body\r\n            error => {\r\n                // cancel updater\r\n                state.perceivedPerformanceUpdater.clear();\r\n\r\n                // update others about this error\r\n                api.fire(\r\n                    'error',\r\n                    isObject(error)\r\n                        ? error\r\n                        : {\r\n                              type: 'error',\r\n                              code: 0,\r\n                              body: `${error}`,\r\n                          }\r\n                );\r\n            },\r\n\r\n            // actual processing progress\r\n            (computable, current, total) => {\r\n                // update actual duration\r\n                state.duration = Date.now() - state.timestamp;\r\n\r\n                // update actual progress\r\n                state.progress = computable ? current / total : null;\r\n\r\n                progressFn();\r\n            },\r\n\r\n            // abort does not expect a value\r\n            () => {\r\n                // stop updater\r\n                state.perceivedPerformanceUpdater.clear();\r\n\r\n                // fire the abort event so we can switch visuals\r\n                api.fire('abort', state.response ? state.response.body : null);\r\n            },\r\n\r\n            // register the id for this transfer\r\n            transferId => {\r\n                api.fire('transfer', transferId);\r\n            }\r\n        );\r\n    };\r\n\r\n    const abort = () => {\r\n        // no request running, can't abort\r\n        if (!state.request) return;\r\n\r\n        // stop updater\r\n        state.perceivedPerformanceUpdater.clear();\r\n\r\n        // abort actual request\r\n        if (state.request.abort) state.request.abort();\r\n\r\n        // if has response object, we've completed the request\r\n        state.complete = true;\r\n    };\r\n\r\n    const reset = () => {\r\n        abort();\r\n        state.complete = false;\r\n        state.perceivedProgress = 0;\r\n        state.progress = 0;\r\n        state.timestamp = null;\r\n        state.perceivedDuration = 0;\r\n        state.duration = 0;\r\n        state.request = null;\r\n        state.response = null;\r\n    };\r\n\r\n    const getProgress = allowMinimumUploadDuration\r\n        ? () => (state.progress ? Math.min(state.progress, state.perceivedProgress) : null)\r\n        : () => state.progress || null;\r\n\r\n    const getDuration = allowMinimumUploadDuration\r\n        ? () => Math.min(state.duration, state.perceivedDuration)\r\n        : () => state.duration;\r\n\r\n    const api = {\r\n        ...on(),\r\n        process, // start processing file\r\n        abort, // abort active process request\r\n        getProgress,\r\n        getDuration,\r\n        reset,\r\n    };\r\n\r\n    return api;\r\n};\r\n\r\nconst getFilenameWithoutExtension = name => name.substring(0, name.lastIndexOf('.')) || name;\r\n\r\nconst createFileStub = source => {\r\n    let data = [source.name, source.size, source.type];\r\n\r\n    // is blob or base64, then we need to set the name\r\n    if (source instanceof Blob || isBase64DataURI(source)) {\r\n        data[0] = source.name || getDateString();\r\n    } else if (isBase64DataURI(source)) {\r\n        // if is base64 data uri we need to determine the average size and type\r\n        data[1] = source.length;\r\n        data[2] = getMimeTypeFromBase64DataURI(source);\r\n    } else if (isString(source)) {\r\n        // url\r\n        data[0] = getFilenameFromURL(source);\r\n        data[1] = 0;\r\n        data[2] = 'application/octet-stream';\r\n    }\r\n\r\n    return {\r\n        name: data[0],\r\n        size: data[1],\r\n        type: data[2],\r\n    };\r\n};\r\n\r\nconst isFile = value => !!(value instanceof File || (value instanceof Blob && value.name));\r\n\r\nconst deepCloneObject = src => {\r\n    if (!isObject(src)) return src;\r\n    const target = isArray(src) ? [] : {};\r\n    for (const key in src) {\r\n        if (!src.hasOwnProperty(key)) continue;\r\n        const v = src[key];\r\n        target[key] = v && isObject(v) ? deepCloneObject(v) : v;\r\n    }\r\n    return target;\r\n};\r\n\r\nconst createItem = (origin = null, serverFileReference = null, file = null) => {\r\n    // unique id for this item, is used to identify the item across views\r\n    const id = getUniqueId();\r\n\r\n    /**\r\n     * Internal item state\r\n     */\r\n    const state = {\r\n        // is archived\r\n        archived: false,\r\n\r\n        // if is frozen, no longer fires events\r\n        frozen: false,\r\n\r\n        // removed from view\r\n        released: false,\r\n\r\n        // original source\r\n        source: null,\r\n\r\n        // file model reference\r\n        file,\r\n\r\n        // id of file on server\r\n        serverFileReference,\r\n\r\n        // id of file transfer on server\r\n        transferId: null,\r\n\r\n        // is aborted\r\n        processingAborted: false,\r\n\r\n        // current item status\r\n        status: serverFileReference ? ItemStatus.PROCESSING_COMPLETE : ItemStatus.INIT,\r\n\r\n        // active processes\r\n        activeLoader: null,\r\n        activeProcessor: null,\r\n    };\r\n\r\n    // callback used when abort processing is called to link back to the resolve method\r\n    let abortProcessingRequestComplete = null;\r\n\r\n    /**\r\n     * Externally added item metadata\r\n     */\r\n    const metadata = {};\r\n\r\n    // item data\r\n    const setStatus = status => (state.status = status);\r\n\r\n    // fire event unless the item has been archived\r\n    const fire = (event, ...params) => {\r\n        if (state.released || state.frozen) return;\r\n        api.fire(event, ...params);\r\n    };\r\n\r\n    // file data\r\n    const getFileExtension = () => getExtensionFromFilename(state.file.name);\r\n    const getFileType = () => state.file.type;\r\n    const getFileSize = () => state.file.size;\r\n    const getFile = () => state.file;\r\n\r\n    //\r\n    // logic to load a file\r\n    //\r\n    const load = (source, loader, onload) => {\r\n        // remember the original item source\r\n        state.source = source;\r\n\r\n        // source is known\r\n        api.fireSync('init');\r\n\r\n        // file stub is already there\r\n        if (state.file) {\r\n            api.fireSync('load-skip');\r\n            return;\r\n        }\r\n\r\n        // set a stub file object while loading the actual data\r\n        state.file = createFileStub(source);\r\n\r\n        // starts loading\r\n        loader.on('init', () => {\r\n            fire('load-init');\r\n        });\r\n\r\n        // we'eve received a size indication, let's update the stub\r\n        loader.on('meta', meta => {\r\n            // set size of file stub\r\n            state.file.size = meta.size;\r\n\r\n            // set name of file stub\r\n            state.file.filename = meta.filename;\r\n\r\n            // if has received source, we done\r\n            if (meta.source) {\r\n                origin = FileOrigin.LIMBO;\r\n                state.serverFileReference = meta.source;\r\n                state.status = ItemStatus.PROCESSING_COMPLETE;\r\n            }\r\n\r\n            // size has been updated\r\n            fire('load-meta');\r\n        });\r\n\r\n        // the file is now loading we need to update the progress indicators\r\n        loader.on('progress', progress => {\r\n            setStatus(ItemStatus.LOADING);\r\n\r\n            fire('load-progress', progress);\r\n        });\r\n\r\n        // an error was thrown while loading the file, we need to switch to error state\r\n        loader.on('error', error => {\r\n            setStatus(ItemStatus.LOAD_ERROR);\r\n\r\n            fire('load-request-error', error);\r\n        });\r\n\r\n        // user or another process aborted the file load (cannot retry)\r\n        loader.on('abort', () => {\r\n            setStatus(ItemStatus.INIT);\r\n            fire('load-abort');\r\n        });\r\n\r\n        // done loading\r\n        loader.on('load', file => {\r\n            // as we've now loaded the file the loader is no longer required\r\n            state.activeLoader = null;\r\n\r\n            // called when file has loaded succesfully\r\n            const success = result => {\r\n                // set (possibly) transformed file\r\n                state.file = isFile(result) ? result : state.file;\r\n\r\n                // file received\r\n                if (origin === FileOrigin.LIMBO && state.serverFileReference) {\r\n                    setStatus(ItemStatus.PROCESSING_COMPLETE);\r\n                } else {\r\n                    setStatus(ItemStatus.IDLE);\r\n                }\r\n\r\n                fire('load');\r\n            };\r\n\r\n            const error = result => {\r\n                // set original file\r\n                state.file = file;\r\n                fire('load-meta');\r\n\r\n                setStatus(ItemStatus.LOAD_ERROR);\r\n                fire('load-file-error', result);\r\n            };\r\n\r\n            // if we already have a server file reference, we don't need to call the onload method\r\n            if (state.serverFileReference) {\r\n                success(file);\r\n                return;\r\n            }\r\n\r\n            // no server id, let's give this file the full treatment\r\n            onload(file, success, error);\r\n        });\r\n\r\n        // set loader source data\r\n        loader.setSource(source);\r\n\r\n        // set as active loader\r\n        state.activeLoader = loader;\r\n\r\n        // load the source data\r\n        loader.load();\r\n    };\r\n\r\n    const retryLoad = () => {\r\n        if (!state.activeLoader) {\r\n            return;\r\n        }\r\n        state.activeLoader.load();\r\n    };\r\n\r\n    const abortLoad = () => {\r\n        if (state.activeLoader) {\r\n            state.activeLoader.abort();\r\n            return;\r\n        }\r\n        setStatus(ItemStatus.INIT);\r\n        fire('load-abort');\r\n    };\r\n\r\n    //\r\n    // logic to process a file\r\n    //\r\n    const process = (processor, onprocess) => {\r\n        // processing was aborted\r\n        if (state.processingAborted) {\r\n            state.processingAborted = false;\r\n            return;\r\n        }\r\n\r\n        // now processing\r\n        setStatus(ItemStatus.PROCESSING);\r\n\r\n        // reset abort callback\r\n        abortProcessingRequestComplete = null;\r\n\r\n        // if no file loaded we'll wait for the load event\r\n        if (!(state.file instanceof Blob)) {\r\n            api.on('load', () => {\r\n                process(processor, onprocess);\r\n            });\r\n            return;\r\n        }\r\n\r\n        // setup processor\r\n        processor.on('load', serverFileReference => {\r\n            // need this id to be able to revert the upload\r\n            state.transferId = null;\r\n            state.serverFileReference = serverFileReference;\r\n        });\r\n\r\n        // register transfer id\r\n        processor.on('transfer', transferId => {\r\n            // need this id to be able to revert the upload\r\n            state.transferId = transferId;\r\n        });\r\n\r\n        processor.on('load-perceived', serverFileReference => {\r\n            // no longer required\r\n            state.activeProcessor = null;\r\n\r\n            // need this id to be able to rever the upload\r\n            state.transferId = null;\r\n            state.serverFileReference = serverFileReference;\r\n\r\n            setStatus(ItemStatus.PROCESSING_COMPLETE);\r\n            fire('process-complete', serverFileReference);\r\n        });\r\n\r\n        processor.on('start', () => {\r\n            fire('process-start');\r\n        });\r\n\r\n        processor.on('error', error => {\r\n            state.activeProcessor = null;\r\n            setStatus(ItemStatus.PROCESSING_ERROR);\r\n            fire('process-error', error);\r\n        });\r\n\r\n        processor.on('abort', serverFileReference => {\r\n            state.activeProcessor = null;\r\n\r\n            // if file was uploaded but processing was cancelled during perceived processor time store file reference\r\n            state.serverFileReference = serverFileReference;\r\n\r\n            setStatus(ItemStatus.IDLE);\r\n            fire('process-abort');\r\n\r\n            // has timeout so doesn't interfere with remove action\r\n            if (abortProcessingRequestComplete) {\r\n                abortProcessingRequestComplete();\r\n            }\r\n        });\r\n\r\n        processor.on('progress', progress => {\r\n            fire('process-progress', progress);\r\n        });\r\n\r\n        // when successfully transformed\r\n        const success = file => {\r\n            // if was archived in the mean time, don't process\r\n            if (state.archived) return;\r\n\r\n            // process file!\r\n            processor.process(file, { ...metadata });\r\n        };\r\n\r\n        // something went wrong during transform phase\r\n        const error = console.error;\r\n\r\n        // start processing the file\r\n        onprocess(state.file, success, error);\r\n\r\n        // set as active processor\r\n        state.activeProcessor = processor;\r\n    };\r\n\r\n    const requestProcessing = () => {\r\n        state.processingAborted = false;\r\n        setStatus(ItemStatus.PROCESSING_QUEUED);\r\n    };\r\n\r\n    const abortProcessing = () =>\r\n        new Promise(resolve => {\r\n            if (!state.activeProcessor) {\r\n                state.processingAborted = true;\r\n\r\n                setStatus(ItemStatus.IDLE);\r\n                fire('process-abort');\r\n\r\n                resolve();\r\n                return;\r\n            }\r\n\r\n            abortProcessingRequestComplete = () => {\r\n                resolve();\r\n            };\r\n\r\n            state.activeProcessor.abort();\r\n        });\r\n\r\n    //\r\n    // logic to revert a processed file\r\n    //\r\n    const revert = (revertFileUpload, forceRevert) =>\r\n        new Promise((resolve, reject) => {\r\n            // a completed upload will have a serverFileReference, a failed chunked upload where\r\n            // getting a serverId succeeded but >=0 chunks have been uploaded will have transferId set\r\n            const serverTransferId =\r\n                state.serverFileReference !== null ? state.serverFileReference : state.transferId;\r\n\r\n            // cannot revert without a server id for this process\r\n            if (serverTransferId === null) {\r\n                resolve();\r\n                return;\r\n            }\r\n\r\n            // revert the upload (fire and forget)\r\n            revertFileUpload(\r\n                serverTransferId,\r\n                () => {\r\n                    // reset file server id and transfer id as now it's not available on the server\r\n                    state.serverFileReference = null;\r\n                    state.transferId = null;\r\n                    resolve();\r\n                },\r\n                error => {\r\n                    // don't set error state when reverting is optional, it will always resolve\r\n                    if (!forceRevert) {\r\n                        resolve();\r\n                        return;\r\n                    }\r\n\r\n                    // oh no errors\r\n                    setStatus(ItemStatus.PROCESSING_REVERT_ERROR);\r\n                    fire('process-revert-error');\r\n                    reject(error);\r\n                }\r\n            );\r\n\r\n            // fire event\r\n            setStatus(ItemStatus.IDLE);\r\n            fire('process-revert');\r\n        });\r\n\r\n    // exposed methods\r\n    const setMetadata = (key, value, silent) => {\r\n        const keys = key.split('.');\r\n        const root = keys[0];\r\n        const last = keys.pop();\r\n        let data = metadata;\r\n        keys.forEach(key => (data = data[key]));\r\n\r\n        // compare old value against new value, if they're the same, we're not updating\r\n        if (JSON.stringify(data[last]) === JSON.stringify(value)) return;\r\n\r\n        // update value\r\n        data[last] = value;\r\n\r\n        // fire update\r\n        fire('metadata-update', {\r\n            key: root,\r\n            value: metadata[root],\r\n            silent,\r\n        });\r\n    };\r\n\r\n    const getMetadata = key => deepCloneObject(key ? metadata[key] : metadata);\r\n\r\n    const api = {\r\n        id: { get: () => id },\r\n        origin: { get: () => origin, set: value => (origin = value) },\r\n        serverId: { get: () => state.serverFileReference },\r\n        transferId: { get: () => state.transferId },\r\n        status: { get: () => state.status },\r\n        filename: { get: () => state.file.name },\r\n        filenameWithoutExtension: { get: () => getFilenameWithoutExtension(state.file.name) },\r\n        fileExtension: { get: getFileExtension },\r\n        fileType: { get: getFileType },\r\n        fileSize: { get: getFileSize },\r\n        file: { get: getFile },\r\n        relativePath: { get: () => state.file._relativePath },\r\n\r\n        source: { get: () => state.source },\r\n\r\n        getMetadata,\r\n        setMetadata: (key, value, silent) => {\r\n            if (isObject(key)) {\r\n                const data = key;\r\n                Object.keys(data).forEach(key => {\r\n                    setMetadata(key, data[key], value);\r\n                });\r\n                return key;\r\n            }\r\n            setMetadata(key, value, silent);\r\n            return value;\r\n        },\r\n\r\n        extend: (name, handler) => (itemAPI[name] = handler),\r\n\r\n        abortLoad,\r\n        retryLoad,\r\n        requestProcessing,\r\n        abortProcessing,\r\n\r\n        load,\r\n        process,\r\n        revert,\r\n\r\n        ...on(),\r\n\r\n        freeze: () => (state.frozen = true),\r\n\r\n        release: () => (state.released = true),\r\n        released: { get: () => state.released },\r\n\r\n        archive: () => (state.archived = true),\r\n        archived: { get: () => state.archived },\r\n\r\n        // replace source and file object\r\n        setFile: file => (state.file = file),\r\n    };\r\n\r\n    // create it here instead of returning it instantly so we can extend it later\r\n    const itemAPI = createObject(api);\r\n\r\n    return itemAPI;\r\n};\r\n\r\nconst getItemIndexByQuery = (items, query) => {\r\n    // just return first index\r\n    if (isEmpty(query)) {\r\n        return 0;\r\n    }\r\n\r\n    // invalid queries\r\n    if (!isString(query)) {\r\n        return -1;\r\n    }\r\n\r\n    // return item by id (or -1 if not found)\r\n    return items.findIndex(item => item.id === query);\r\n};\r\n\r\nconst getItemById = (items, itemId) => {\r\n    const index = getItemIndexByQuery(items, itemId);\r\n    if (index < 0) {\r\n        return;\r\n    }\r\n    return items[index] || null;\r\n};\r\n\r\nconst fetchBlob = (url, load, error, progress, abort, headers) => {\r\n    const request = sendRequest(null, url, {\r\n        method: 'GET',\r\n        responseType: 'blob',\r\n    });\r\n\r\n    request.onload = xhr => {\r\n        // get headers\r\n        const headers = xhr.getAllResponseHeaders();\r\n\r\n        // get filename\r\n        const filename = getFileInfoFromHeaders(headers).name || getFilenameFromURL(url);\r\n\r\n        // create response\r\n        load(createResponse('load', xhr.status, getFileFromBlob(xhr.response, filename), headers));\r\n    };\r\n\r\n    request.onerror = xhr => {\r\n        error(createResponse('error', xhr.status, xhr.statusText, xhr.getAllResponseHeaders()));\r\n    };\r\n\r\n    request.onheaders = xhr => {\r\n        headers(createResponse('headers', xhr.status, null, xhr.getAllResponseHeaders()));\r\n    };\r\n\r\n    request.ontimeout = createTimeoutResponse(error);\r\n    request.onprogress = progress;\r\n    request.onabort = abort;\r\n\r\n    // should return request\r\n    return request;\r\n};\r\n\r\nconst getDomainFromURL = url => {\r\n    if (url.indexOf('//') === 0) {\r\n        url = location.protocol + url;\r\n    }\r\n    return url\r\n        .toLowerCase()\r\n        .replace('blob:', '')\r\n        .replace(/([a-z])?:\\/\\//, '$1')\r\n        .split('/')[0];\r\n};\r\n\r\nconst isExternalURL = url =>\r\n    (url.indexOf(':') > -1 || url.indexOf('//') > -1) &&\r\n    getDomainFromURL(location.href) !== getDomainFromURL(url);\r\n\r\nconst dynamicLabel = label => (...params) => (isFunction(label) ? label(...params) : label);\r\n\r\nconst isMockItem = item => !isFile(item.file);\r\n\r\nconst listUpdated = (dispatch, state) => {\r\n    clearTimeout(state.listUpdateTimeout);\r\n    state.listUpdateTimeout = setTimeout(() => {\r\n        dispatch('DID_UPDATE_ITEMS', { items: getActiveItems(state.items) });\r\n    }, 0);\r\n};\r\n\r\nconst optionalPromise = (fn, ...params) =>\r\n    new Promise(resolve => {\r\n        if (!fn) {\r\n            return resolve(true);\r\n        }\r\n\r\n        const result = fn(...params);\r\n\r\n        if (result == null) {\r\n            return resolve(true);\r\n        }\r\n\r\n        if (typeof result === 'boolean') {\r\n            return resolve(result);\r\n        }\r\n\r\n        if (typeof result.then === 'function') {\r\n            result.then(resolve);\r\n        }\r\n    });\r\n\r\nconst sortItems = (state, compare) => {\r\n    state.items.sort((a, b) => compare(createItemAPI(a), createItemAPI(b)));\r\n};\r\n\r\n// returns item based on state\r\nconst getItemByQueryFromState = (state, itemHandler) => ({\r\n    query,\r\n    success = () => {},\r\n    failure = () => {},\r\n    ...options\r\n} = {}) => {\r\n    const item = getItemByQuery(state.items, query);\r\n    if (!item) {\r\n        failure({\r\n            error: createResponse('error', 0, 'Item not found'),\r\n            file: null,\r\n        });\r\n        return;\r\n    }\r\n    itemHandler(item, success, failure, options || {});\r\n};\r\n\r\nconst actions = (dispatch, query, state) => ({\r\n    /**\r\n     * Aborts all ongoing processes\r\n     */\r\n    ABORT_ALL: () => {\r\n        getActiveItems(state.items).forEach(item => {\r\n            item.freeze();\r\n            item.abortLoad();\r\n            item.abortProcessing();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Sets initial files\r\n     */\r\n    DID_SET_FILES: ({ value = [] }) => {\r\n        // map values to file objects\r\n        const files = value.map(file => ({\r\n            source: file.source ? file.source : file,\r\n            options: file.options,\r\n        }));\r\n\r\n        // loop over files, if file is in list, leave it be, if not, remove\r\n        // test if items should be moved\r\n        let activeItems = getActiveItems(state.items);\r\n\r\n        activeItems.forEach(item => {\r\n            // if item not is in new value, remove\r\n            if (!files.find(file => file.source === item.source || file.source === item.file)) {\r\n                dispatch('REMOVE_ITEM', { query: item, remove: false });\r\n            }\r\n        });\r\n\r\n        // add new files\r\n        activeItems = getActiveItems(state.items);\r\n        files.forEach((file, index) => {\r\n            // if file is already in list\r\n            if (activeItems.find(item => item.source === file.source || item.file === file.source))\r\n                return;\r\n\r\n            // not in list, add\r\n            dispatch('ADD_ITEM', {\r\n                ...file,\r\n                interactionMethod: InteractionMethod.NONE,\r\n                index,\r\n            });\r\n        });\r\n    },\r\n\r\n    DID_UPDATE_ITEM_METADATA: ({ id, action, change }) => {\r\n        // don't do anything\r\n        if (change.silent) return;\r\n\r\n        // if is called multiple times in close succession we combined all calls together to save resources\r\n        clearTimeout(state.itemUpdateTimeout);\r\n        state.itemUpdateTimeout = setTimeout(() => {\r\n            const item = getItemById(state.items, id);\r\n\r\n            // only revert and attempt to upload when we're uploading to a server\r\n            if (!query('IS_ASYNC')) {\r\n                // should we update the output data\r\n                applyFilterChain('SHOULD_PREPARE_OUTPUT', false, {\r\n                    item,\r\n                    query,\r\n                    action,\r\n                    change,\r\n                }).then(shouldPrepareOutput => {\r\n                    // plugins determined the output data should be prepared (or not), can be adjusted with beforePrepareOutput hook\r\n                    const beforePrepareFile = query('GET_BEFORE_PREPARE_FILE');\r\n                    if (beforePrepareFile)\r\n                        shouldPrepareOutput = beforePrepareFile(item, shouldPrepareOutput);\r\n\r\n                    if (!shouldPrepareOutput) return;\r\n\r\n                    dispatch(\r\n                        'REQUEST_PREPARE_OUTPUT',\r\n                        {\r\n                            query: id,\r\n                            item,\r\n                            success: file => {\r\n                                dispatch('DID_PREPARE_OUTPUT', { id, file });\r\n                            },\r\n                        },\r\n                        true\r\n                    );\r\n                });\r\n\r\n                return;\r\n            }\r\n\r\n            // if is local item we need to enable upload button so change can be propagated to server\r\n            if (item.origin === FileOrigin.LOCAL) {\r\n                dispatch('DID_LOAD_ITEM', {\r\n                    id: item.id,\r\n                    error: null,\r\n                    serverFileReference: item.source,\r\n                });\r\n            }\r\n\r\n            // for async scenarios\r\n            const upload = () => {\r\n                // we push this forward a bit so the interface is updated correctly\r\n                setTimeout(() => {\r\n                    dispatch('REQUEST_ITEM_PROCESSING', { query: id });\r\n                }, 32);\r\n            };\r\n\r\n            const revert = doUpload => {\r\n                item.revert(\r\n                    createRevertFunction(state.options.server.url, state.options.server.revert),\r\n                    query('GET_FORCE_REVERT')\r\n                )\r\n                    .then(doUpload ? upload : () => {})\r\n                    .catch(() => {});\r\n            };\r\n\r\n            const abort = doUpload => {\r\n                item.abortProcessing().then(doUpload ? upload : () => {});\r\n            };\r\n\r\n            // if we should re-upload the file immediately\r\n            if (item.status === ItemStatus.PROCESSING_COMPLETE) {\r\n                return revert(state.options.instantUpload);\r\n            }\r\n\r\n            // if currently uploading, cancel upload\r\n            if (item.status === ItemStatus.PROCESSING) {\r\n                return abort(state.options.instantUpload);\r\n            }\r\n\r\n            if (state.options.instantUpload) {\r\n                upload();\r\n            }\r\n        }, 0);\r\n    },\r\n\r\n    MOVE_ITEM: ({ query, index }) => {\r\n        const item = getItemByQuery(state.items, query);\r\n        if (!item) return;\r\n        const currentIndex = state.items.indexOf(item);\r\n        index = limit(index, 0, state.items.length - 1);\r\n        if (currentIndex === index) return;\r\n        state.items.splice(index, 0, state.items.splice(currentIndex, 1)[0]);\r\n    },\r\n\r\n    SORT: ({ compare }) => {\r\n        sortItems(state, compare);\r\n        dispatch('DID_SORT_ITEMS', {\r\n            items: query('GET_ACTIVE_ITEMS'),\r\n        });\r\n    },\r\n\r\n    ADD_ITEMS: ({ items, index, interactionMethod, success = () => {}, failure = () => {} }) => {\r\n        let currentIndex = index;\r\n\r\n        if (index === -1 || typeof index === 'undefined') {\r\n            const insertLocation = query('GET_ITEM_INSERT_LOCATION');\r\n            const totalItems = query('GET_TOTAL_ITEMS');\r\n            currentIndex = insertLocation === 'before' ? 0 : totalItems;\r\n        }\r\n\r\n        const ignoredFiles = query('GET_IGNORED_FILES');\r\n        const isValidFile = source =>\r\n            isFile(source) ? !ignoredFiles.includes(source.name.toLowerCase()) : !isEmpty(source);\r\n        const validItems = items.filter(isValidFile);\r\n\r\n        const promises = validItems.map(\r\n            source =>\r\n                new Promise((resolve, reject) => {\r\n                    dispatch('ADD_ITEM', {\r\n                        interactionMethod,\r\n                        source: source.source || source,\r\n                        success: resolve,\r\n                        failure: reject,\r\n                        index: currentIndex++,\r\n                        options: source.options || {},\r\n                    });\r\n                })\r\n        );\r\n\r\n        Promise.all(promises)\r\n            .then(success)\r\n            .catch(failure);\r\n    },\r\n\r\n    /**\r\n     * @param source\r\n     * @param index\r\n     * @param interactionMethod\r\n     */\r\n    ADD_ITEM: ({\r\n        source,\r\n        index = -1,\r\n        interactionMethod,\r\n        success = () => {},\r\n        failure = () => {},\r\n        options = {},\r\n    }) => {\r\n        // if no source supplied\r\n        if (isEmpty(source)) {\r\n            failure({\r\n                error: createResponse('error', 0, 'No source'),\r\n                file: null,\r\n            });\r\n            return;\r\n        }\r\n\r\n        // filter out invalid file items, used to filter dropped directory contents\r\n        if (isFile(source) && state.options.ignoredFiles.includes(source.name.toLowerCase())) {\r\n            // fail silently\r\n            return;\r\n        }\r\n\r\n        // test if there's still room in the list of files\r\n        if (!hasRoomForItem(state)) {\r\n            // if multiple allowed, we can't replace\r\n            // or if only a single item is allowed but we're not allowed to replace it we exit\r\n            if (\r\n                state.options.allowMultiple ||\r\n                (!state.options.allowMultiple && !state.options.allowReplace)\r\n            ) {\r\n                const error = createResponse('warning', 0, 'Max files');\r\n\r\n                dispatch('DID_THROW_MAX_FILES', {\r\n                    source,\r\n                    error,\r\n                });\r\n\r\n                failure({ error, file: null });\r\n\r\n                return;\r\n            }\r\n\r\n            // let's replace the item\r\n            // id of first item we're about to remove\r\n            const item = getActiveItems(state.items)[0];\r\n\r\n            // if has been processed remove it from the server as well\r\n            if (\r\n                item.status === ItemStatus.PROCESSING_COMPLETE ||\r\n                item.status === ItemStatus.PROCESSING_REVERT_ERROR\r\n            ) {\r\n                const forceRevert = query('GET_FORCE_REVERT');\r\n                item.revert(\r\n                    createRevertFunction(state.options.server.url, state.options.server.revert),\r\n                    forceRevert\r\n                )\r\n                    .then(() => {\r\n                        if (!forceRevert) return;\r\n\r\n                        // try to add now\r\n                        dispatch('ADD_ITEM', {\r\n                            source,\r\n                            index,\r\n                            interactionMethod,\r\n                            success,\r\n                            failure,\r\n                            options,\r\n                        });\r\n                    })\r\n                    .catch(() => {}); // no need to handle this catch state for now\r\n\r\n                if (forceRevert) return;\r\n            }\r\n\r\n            // remove first item as it will be replaced by this item\r\n            dispatch('REMOVE_ITEM', { query: item.id });\r\n        }\r\n\r\n        // where did the file originate\r\n        const origin =\r\n            options.type === 'local'\r\n                ? FileOrigin.LOCAL\r\n                : options.type === 'limbo'\r\n                ? FileOrigin.LIMBO\r\n                : FileOrigin.INPUT;\r\n\r\n        // create a new blank item\r\n        const item = createItem(\r\n            // where did this file come from\r\n            origin,\r\n\r\n            // an input file never has a server file reference\r\n            origin === FileOrigin.INPUT ? null : source,\r\n\r\n            // file mock data, if defined\r\n            options.file\r\n        );\r\n\r\n        // set initial meta data\r\n        Object.keys(options.metadata || {}).forEach(key => {\r\n            item.setMetadata(key, options.metadata[key]);\r\n        });\r\n\r\n        // created the item, let plugins add methods\r\n        applyFilters('DID_CREATE_ITEM', item, { query, dispatch });\r\n\r\n        // where to insert new items\r\n        const itemInsertLocation = query('GET_ITEM_INSERT_LOCATION');\r\n\r\n        // adjust index if is not allowed to pick location\r\n        if (!state.options.itemInsertLocationFreedom) {\r\n            index = itemInsertLocation === 'before' ? -1 : state.items.length;\r\n        }\r\n\r\n        // add item to list\r\n        insertItem(state.items, item, index);\r\n\r\n        // sort items in list\r\n        if (isFunction(itemInsertLocation) && source) {\r\n            sortItems(state, itemInsertLocation);\r\n        }\r\n\r\n        // get a quick reference to the item id\r\n        const id = item.id;\r\n\r\n        // observe item events\r\n        item.on('init', () => {\r\n            dispatch('DID_INIT_ITEM', { id });\r\n        });\r\n\r\n        item.on('load-init', () => {\r\n            dispatch('DID_START_ITEM_LOAD', { id });\r\n        });\r\n\r\n        item.on('load-meta', () => {\r\n            dispatch('DID_UPDATE_ITEM_META', { id });\r\n        });\r\n\r\n        item.on('load-progress', progress => {\r\n            dispatch('DID_UPDATE_ITEM_LOAD_PROGRESS', { id, progress });\r\n        });\r\n\r\n        item.on('load-request-error', error => {\r\n            const mainStatus = dynamicLabel(state.options.labelFileLoadError)(error);\r\n\r\n            // is client error, no way to recover\r\n            if (error.code >= 400 && error.code < 500) {\r\n                dispatch('DID_THROW_ITEM_INVALID', {\r\n                    id,\r\n                    error,\r\n                    status: {\r\n                        main: mainStatus,\r\n                        sub: `${error.code} (${error.body})`,\r\n                    },\r\n                });\r\n\r\n                // reject the file so can be dealt with through API\r\n                failure({ error, file: createItemAPI(item) });\r\n                return;\r\n            }\r\n\r\n            // is possible server error, so might be possible to retry\r\n            dispatch('DID_THROW_ITEM_LOAD_ERROR', {\r\n                id,\r\n                error,\r\n                status: {\r\n                    main: mainStatus,\r\n                    sub: state.options.labelTapToRetry,\r\n                },\r\n            });\r\n        });\r\n\r\n        item.on('load-file-error', error => {\r\n            dispatch('DID_THROW_ITEM_INVALID', {\r\n                id,\r\n                error: error.status,\r\n                status: error.status,\r\n            });\r\n            failure({ error: error.status, file: createItemAPI(item) });\r\n        });\r\n\r\n        item.on('load-abort', () => {\r\n            dispatch('REMOVE_ITEM', { query: id });\r\n        });\r\n\r\n        item.on('load-skip', () => {\r\n            item.on('metadata-update', change => {\r\n                if (!isFile(item.file)) return;\r\n                dispatch('DID_UPDATE_ITEM_METADATA', { id, change });\r\n            });\r\n\r\n            dispatch('COMPLETE_LOAD_ITEM', {\r\n                query: id,\r\n                item,\r\n                data: {\r\n                    source,\r\n                    success,\r\n                },\r\n            });\r\n        });\r\n\r\n        item.on('load', () => {\r\n            const handleAdd = shouldAdd => {\r\n                // no should not add this file\r\n                if (!shouldAdd) {\r\n                    dispatch('REMOVE_ITEM', {\r\n                        query: id,\r\n                    });\r\n                    return;\r\n                }\r\n\r\n                // now interested in metadata updates\r\n                item.on('metadata-update', change => {\r\n                    dispatch('DID_UPDATE_ITEM_METADATA', { id, change });\r\n                });\r\n\r\n                // let plugins decide if the output data should be prepared at this point\r\n                // means we'll do this and wait for idle state\r\n                applyFilterChain('SHOULD_PREPARE_OUTPUT', false, { item, query }).then(\r\n                    shouldPrepareOutput => {\r\n                        // plugins determined the output data should be prepared (or not), can be adjusted with beforePrepareOutput hook\r\n                        const beforePrepareFile = query('GET_BEFORE_PREPARE_FILE');\r\n                        if (beforePrepareFile)\r\n                            shouldPrepareOutput = beforePrepareFile(item, shouldPrepareOutput);\r\n\r\n                        const loadComplete = () => {\r\n                            dispatch('COMPLETE_LOAD_ITEM', {\r\n                                query: id,\r\n                                item,\r\n                                data: {\r\n                                    source,\r\n                                    success,\r\n                                },\r\n                            });\r\n\r\n                            listUpdated(dispatch, state);\r\n                        };\r\n\r\n                        // exit\r\n                        if (shouldPrepareOutput) {\r\n                            // wait for idle state and then run PREPARE_OUTPUT\r\n                            dispatch(\r\n                                'REQUEST_PREPARE_OUTPUT',\r\n                                {\r\n                                    query: id,\r\n                                    item,\r\n                                    success: file => {\r\n                                        dispatch('DID_PREPARE_OUTPUT', { id, file });\r\n                                        loadComplete();\r\n                                    },\r\n                                },\r\n                                true\r\n                            );\r\n\r\n                            return;\r\n                        }\r\n\r\n                        loadComplete();\r\n                    }\r\n                );\r\n            };\r\n\r\n            // item loaded, allow plugins to\r\n            // - read data (quickly)\r\n            // - add metadata\r\n            applyFilterChain('DID_LOAD_ITEM', item, { query, dispatch })\r\n                .then(() => {\r\n                    optionalPromise(query('GET_BEFORE_ADD_FILE'), createItemAPI(item)).then(\r\n                        handleAdd\r\n                    );\r\n                })\r\n                .catch(e => {\r\n                    if (!e || !e.error || !e.status) return handleAdd(false);\r\n                    dispatch('DID_THROW_ITEM_INVALID', {\r\n                        id,\r\n                        error: e.error,\r\n                        status: e.status,\r\n                    });\r\n                });\r\n        });\r\n\r\n        item.on('process-start', () => {\r\n            dispatch('DID_START_ITEM_PROCESSING', { id });\r\n        });\r\n\r\n        item.on('process-progress', progress => {\r\n            dispatch('DID_UPDATE_ITEM_PROCESS_PROGRESS', { id, progress });\r\n        });\r\n\r\n        item.on('process-error', error => {\r\n            dispatch('DID_THROW_ITEM_PROCESSING_ERROR', {\r\n                id,\r\n                error,\r\n                status: {\r\n                    main: dynamicLabel(state.options.labelFileProcessingError)(error),\r\n                    sub: state.options.labelTapToRetry,\r\n                },\r\n            });\r\n        });\r\n\r\n        item.on('process-revert-error', error => {\r\n            dispatch('DID_THROW_ITEM_PROCESSING_REVERT_ERROR', {\r\n                id,\r\n                error,\r\n                status: {\r\n                    main: dynamicLabel(state.options.labelFileProcessingRevertError)(error),\r\n                    sub: state.options.labelTapToRetry,\r\n                },\r\n            });\r\n        });\r\n\r\n        item.on('process-complete', serverFileReference => {\r\n            dispatch('DID_COMPLETE_ITEM_PROCESSING', {\r\n                id,\r\n                error: null,\r\n                serverFileReference,\r\n            });\r\n            dispatch('DID_DEFINE_VALUE', { id, value: serverFileReference });\r\n        });\r\n\r\n        item.on('process-abort', () => {\r\n            dispatch('DID_ABORT_ITEM_PROCESSING', { id });\r\n        });\r\n\r\n        item.on('process-revert', () => {\r\n            dispatch('DID_REVERT_ITEM_PROCESSING', { id });\r\n            dispatch('DID_DEFINE_VALUE', { id, value: null });\r\n        });\r\n\r\n        // let view know the item has been inserted\r\n        dispatch('DID_ADD_ITEM', { id, index, interactionMethod });\r\n\r\n        listUpdated(dispatch, state);\r\n\r\n        // start loading the source\r\n        const { url, load, restore, fetch } = state.options.server || {};\r\n\r\n        item.load(\r\n            source,\r\n\r\n            // this creates a function that loads the file based on the type of file (string, base64, blob, file) and location of file (local, remote, limbo)\r\n            createFileLoader(\r\n                origin === FileOrigin.INPUT\r\n                    ? // input, if is remote, see if should use custom fetch, else use default fetchBlob\r\n                      isString(source) && isExternalURL(source)\r\n                        ? fetch\r\n                            ? createFetchFunction(url, fetch)\r\n                            : fetchBlob // remote url\r\n                        : fetchBlob // try to fetch url\r\n                    : // limbo or local\r\n                    origin === FileOrigin.LIMBO\r\n                    ? createFetchFunction(url, restore) // limbo\r\n                    : createFetchFunction(url, load) // local\r\n            ),\r\n\r\n            // called when the file is loaded so it can be piped through the filters\r\n            (file, success, error) => {\r\n                // let's process the file\r\n                applyFilterChain('LOAD_FILE', file, { query })\r\n                    .then(success)\r\n                    .catch(error);\r\n            }\r\n        );\r\n    },\r\n\r\n    REQUEST_PREPARE_OUTPUT: ({ item, success, failure = () => {} }) => {\r\n        // error response if item archived\r\n        const err = {\r\n            error: createResponse('error', 0, 'Item not found'),\r\n            file: null,\r\n        };\r\n\r\n        // don't handle archived items, an item could have been archived (load aborted) while waiting to be prepared\r\n        if (item.archived) return failure(err);\r\n\r\n        // allow plugins to alter the file data\r\n        applyFilterChain('PREPARE_OUTPUT', item.file, { query, item }).then(result => {\r\n            applyFilterChain('COMPLETE_PREPARE_OUTPUT', result, { query, item }).then(result => {\r\n                // don't handle archived items, an item could have been archived (load aborted) while being prepared\r\n                if (item.archived) return failure(err);\r\n\r\n                // we done!\r\n                success(result);\r\n            });\r\n        });\r\n    },\r\n\r\n    COMPLETE_LOAD_ITEM: ({ item, data }) => {\r\n        const { success, source } = data;\r\n\r\n        // sort items in list\r\n        const itemInsertLocation = query('GET_ITEM_INSERT_LOCATION');\r\n        if (isFunction(itemInsertLocation) && source) {\r\n            sortItems(state, itemInsertLocation);\r\n        }\r\n\r\n        // let interface know the item has loaded\r\n        dispatch('DID_LOAD_ITEM', {\r\n            id: item.id,\r\n            error: null,\r\n            serverFileReference: item.origin === FileOrigin.INPUT ? null : source,\r\n        });\r\n\r\n        // item has been successfully loaded and added to the\r\n        // list of items so can now be safely returned for use\r\n        success(createItemAPI(item));\r\n\r\n        // if this is a local server file we need to show a different state\r\n        if (item.origin === FileOrigin.LOCAL) {\r\n            dispatch('DID_LOAD_LOCAL_ITEM', { id: item.id });\r\n            return;\r\n        }\r\n\r\n        // if is a temp server file we prevent async upload call here (as the file is already on the server)\r\n        if (item.origin === FileOrigin.LIMBO) {\r\n            dispatch('DID_COMPLETE_ITEM_PROCESSING', {\r\n                id: item.id,\r\n                error: null,\r\n                serverFileReference: source,\r\n            });\r\n\r\n            dispatch('DID_DEFINE_VALUE', {\r\n                id: item.id,\r\n                value: item.serverId || source,\r\n            });\r\n            return;\r\n        }\r\n\r\n        // id we are allowed to upload the file immediately, lets do it\r\n        if (query('IS_ASYNC') && state.options.instantUpload) {\r\n            dispatch('REQUEST_ITEM_PROCESSING', { query: item.id });\r\n        }\r\n    },\r\n\r\n    RETRY_ITEM_LOAD: getItemByQueryFromState(state, item => {\r\n        // try loading the source one more time\r\n        item.retryLoad();\r\n    }),\r\n\r\n    REQUEST_ITEM_PREPARE: getItemByQueryFromState(state, (item, success, failure) => {\r\n        dispatch(\r\n            'REQUEST_PREPARE_OUTPUT',\r\n            {\r\n                query: item.id,\r\n                item,\r\n                success: file => {\r\n                    dispatch('DID_PREPARE_OUTPUT', { id: item.id, file });\r\n                    success({\r\n                        file: item,\r\n                        output: file,\r\n                    });\r\n                },\r\n                failure,\r\n            },\r\n            true\r\n        );\r\n    }),\r\n\r\n    REQUEST_ITEM_PROCESSING: getItemByQueryFromState(state, (item, success, failure) => {\r\n        // cannot be queued (or is already queued)\r\n        const itemCanBeQueuedForProcessing =\r\n            // waiting for something\r\n            item.status === ItemStatus.IDLE ||\r\n            // processing went wrong earlier\r\n            item.status === ItemStatus.PROCESSING_ERROR;\r\n\r\n        // not ready to be processed\r\n        if (!itemCanBeQueuedForProcessing) {\r\n            const processNow = () =>\r\n                dispatch('REQUEST_ITEM_PROCESSING', { query: item, success, failure });\r\n\r\n            const process = () => (document.hidden ? processNow() : setTimeout(processNow, 32));\r\n\r\n            // if already done processing or tried to revert but didn't work, try again\r\n            if (\r\n                item.status === ItemStatus.PROCESSING_COMPLETE ||\r\n                item.status === ItemStatus.PROCESSING_REVERT_ERROR\r\n            ) {\r\n                item.revert(\r\n                    createRevertFunction(state.options.server.url, state.options.server.revert),\r\n                    query('GET_FORCE_REVERT')\r\n                )\r\n                    .then(process)\r\n                    .catch(() => {}); // don't continue with processing if something went wrong\r\n            } else if (item.status === ItemStatus.PROCESSING) {\r\n                item.abortProcessing().then(process);\r\n            }\r\n\r\n            return;\r\n        }\r\n\r\n        // already queued for processing\r\n        if (item.status === ItemStatus.PROCESSING_QUEUED) return;\r\n\r\n        item.requestProcessing();\r\n\r\n        dispatch('DID_REQUEST_ITEM_PROCESSING', { id: item.id });\r\n\r\n        dispatch('PROCESS_ITEM', { query: item, success, failure }, true);\r\n    }),\r\n\r\n    PROCESS_ITEM: getItemByQueryFromState(state, (item, success, failure) => {\r\n        const maxParallelUploads = query('GET_MAX_PARALLEL_UPLOADS');\r\n        const totalCurrentUploads = query('GET_ITEMS_BY_STATUS', ItemStatus.PROCESSING).length;\r\n\r\n        // queue and wait till queue is freed up\r\n        if (totalCurrentUploads === maxParallelUploads) {\r\n            // queue for later processing\r\n            state.processingQueue.push({\r\n                id: item.id,\r\n                success,\r\n                failure,\r\n            });\r\n\r\n            // stop it!\r\n            return;\r\n        }\r\n\r\n        // if was not queued or is already processing exit here\r\n        if (item.status === ItemStatus.PROCESSING) return;\r\n\r\n        const processNext = () => {\r\n            // process queueud items\r\n            const queueEntry = state.processingQueue.shift();\r\n\r\n            // no items left\r\n            if (!queueEntry) return;\r\n\r\n            // get item reference\r\n            const { id, success, failure } = queueEntry;\r\n            const itemReference = getItemByQuery(state.items, id);\r\n\r\n            // if item was archived while in queue, jump to next\r\n            if (!itemReference || itemReference.archived) {\r\n                processNext();\r\n                return;\r\n            }\r\n\r\n            // process queued item\r\n            dispatch('PROCESS_ITEM', { query: id, success, failure }, true);\r\n        };\r\n\r\n        // we done function\r\n        item.onOnce('process-complete', () => {\r\n            success(createItemAPI(item));\r\n            processNext();\r\n\r\n            // if origin is local, and we're instant uploading, trigger remove of original\r\n            // as revert will remove file from list\r\n            const server = state.options.server;\r\n            const instantUpload = state.options.instantUpload;\r\n            if (instantUpload && item.origin === FileOrigin.LOCAL && isFunction(server.remove)) {\r\n                const noop = () => {};\r\n                item.origin = FileOrigin.LIMBO;\r\n                state.options.server.remove(item.source, noop, noop);\r\n            }\r\n\r\n            // All items processed? No errors?\r\n            const allItemsProcessed =\r\n                query('GET_ITEMS_BY_STATUS', ItemStatus.PROCESSING_COMPLETE).length ===\r\n                state.items.length;\r\n            if (allItemsProcessed) {\r\n                dispatch('DID_COMPLETE_ITEM_PROCESSING_ALL');\r\n            }\r\n        });\r\n\r\n        // we error function\r\n        item.onOnce('process-error', error => {\r\n            failure({ error, file: createItemAPI(item) });\r\n            processNext();\r\n        });\r\n\r\n        // start file processing\r\n        const options = state.options;\r\n        item.process(\r\n            createFileProcessor(\r\n                createProcessorFunction(options.server.url, options.server.process, options.name, {\r\n                    chunkTransferId: item.transferId,\r\n                    chunkServer: options.server.patch,\r\n                    chunkUploads: options.chunkUploads,\r\n                    chunkForce: options.chunkForce,\r\n                    chunkSize: options.chunkSize,\r\n                    chunkRetryDelays: options.chunkRetryDelays,\r\n                }),\r\n                {\r\n                    allowMinimumUploadDuration: query('GET_ALLOW_MINIMUM_UPLOAD_DURATION'),\r\n                }\r\n            ),\r\n            // called when the file is about to be processed so it can be piped through the transform filters\r\n            (file, success, error) => {\r\n                // allow plugins to alter the file data\r\n                applyFilterChain('PREPARE_OUTPUT', file, { query, item })\r\n                    .then(file => {\r\n                        dispatch('DID_PREPARE_OUTPUT', { id: item.id, file });\r\n\r\n                        success(file);\r\n                    })\r\n                    .catch(error);\r\n            }\r\n        );\r\n    }),\r\n\r\n    RETRY_ITEM_PROCESSING: getItemByQueryFromState(state, item => {\r\n        dispatch('REQUEST_ITEM_PROCESSING', { query: item });\r\n    }),\r\n\r\n    REQUEST_REMOVE_ITEM: getItemByQueryFromState(state, item => {\r\n        optionalPromise(query('GET_BEFORE_REMOVE_FILE'), createItemAPI(item)).then(shouldRemove => {\r\n            if (!shouldRemove) {\r\n                return;\r\n            }\r\n            dispatch('REMOVE_ITEM', { query: item });\r\n        });\r\n    }),\r\n\r\n    RELEASE_ITEM: getItemByQueryFromState(state, item => {\r\n        item.release();\r\n    }),\r\n\r\n    REMOVE_ITEM: getItemByQueryFromState(state, (item, success, failure, options) => {\r\n        const removeFromView = () => {\r\n            // get id reference\r\n            const id = item.id;\r\n\r\n            // archive the item, this does not remove it from the list\r\n            getItemById(state.items, id).archive();\r\n\r\n            // tell the view the item has been removed\r\n            dispatch('DID_REMOVE_ITEM', { error: null, id, item });\r\n\r\n            // now the list has been modified\r\n            listUpdated(dispatch, state);\r\n\r\n            // correctly removed\r\n            success(createItemAPI(item));\r\n        };\r\n\r\n        // if this is a local file and the `server.remove` function has been configured,\r\n        // send source there so dev can remove file from server\r\n        const server = state.options.server;\r\n        if (\r\n            item.origin === FileOrigin.LOCAL &&\r\n            server &&\r\n            isFunction(server.remove) &&\r\n            options.remove !== false\r\n        ) {\r\n            dispatch('DID_START_ITEM_REMOVE', { id: item.id });\r\n\r\n            server.remove(\r\n                item.source,\r\n                () => removeFromView(),\r\n                status => {\r\n                    dispatch('DID_THROW_ITEM_REMOVE_ERROR', {\r\n                        id: item.id,\r\n                        error: createResponse('error', 0, status, null),\r\n                        status: {\r\n                            main: dynamicLabel(state.options.labelFileRemoveError)(status),\r\n                            sub: state.options.labelTapToRetry,\r\n                        },\r\n                    });\r\n                }\r\n            );\r\n        } else {\r\n            // if is requesting revert and can revert need to call revert handler (not calling request_ because that would also trigger beforeRemoveHook)\r\n            if (\r\n                (options.revert && item.origin !== FileOrigin.LOCAL && item.serverId !== null) ||\r\n                // if chunked uploads are enabled and we're uploading in chunks for this specific file\r\n                // or if the file isn't big enough for chunked uploads but chunkForce is set then call\r\n                // revert before removing from the view...\r\n                (state.options.chunkUploads && item.file.size > state.options.chunkSize) ||\r\n                (state.options.chunkUploads && state.options.chunkForce)\r\n            ) {\r\n                item.revert(\r\n                    createRevertFunction(state.options.server.url, state.options.server.revert),\r\n                    query('GET_FORCE_REVERT')\r\n                );\r\n            }\r\n\r\n            // can now safely remove from view\r\n            removeFromView();\r\n        }\r\n    }),\r\n\r\n    ABORT_ITEM_LOAD: getItemByQueryFromState(state, item => {\r\n        item.abortLoad();\r\n    }),\r\n\r\n    ABORT_ITEM_PROCESSING: getItemByQueryFromState(state, item => {\r\n        // test if is already processed\r\n        if (item.serverId) {\r\n            dispatch('REVERT_ITEM_PROCESSING', { id: item.id });\r\n            return;\r\n        }\r\n\r\n        // abort\r\n        item.abortProcessing().then(() => {\r\n            const shouldRemove = state.options.instantUpload;\r\n            if (shouldRemove) {\r\n                dispatch('REMOVE_ITEM', { query: item.id });\r\n            }\r\n        });\r\n    }),\r\n\r\n    REQUEST_REVERT_ITEM_PROCESSING: getItemByQueryFromState(state, item => {\r\n        // not instant uploading, revert immediately\r\n        if (!state.options.instantUpload) {\r\n            dispatch('REVERT_ITEM_PROCESSING', { query: item });\r\n            return;\r\n        }\r\n\r\n        // if we're instant uploading the file will also be removed if we revert,\r\n        // so if a before remove file hook is defined we need to run it now\r\n        const handleRevert = shouldRevert => {\r\n            if (!shouldRevert) return;\r\n            dispatch('REVERT_ITEM_PROCESSING', { query: item });\r\n        };\r\n\r\n        const fn = query('GET_BEFORE_REMOVE_FILE');\r\n        if (!fn) {\r\n            return handleRevert(true);\r\n        }\r\n\r\n        const requestRemoveResult = fn(createItemAPI(item));\r\n        if (requestRemoveResult == null) {\r\n            // undefined or null\r\n            return handleRevert(true);\r\n        }\r\n\r\n        if (typeof requestRemoveResult === 'boolean') {\r\n            return handleRevert(requestRemoveResult);\r\n        }\r\n\r\n        if (typeof requestRemoveResult.then === 'function') {\r\n            requestRemoveResult.then(handleRevert);\r\n        }\r\n    }),\r\n\r\n    REVERT_ITEM_PROCESSING: getItemByQueryFromState(state, item => {\r\n        item.revert(\r\n            createRevertFunction(state.options.server.url, state.options.server.revert),\r\n            query('GET_FORCE_REVERT')\r\n        )\r\n            .then(() => {\r\n                const shouldRemove = state.options.instantUpload || isMockItem(item);\r\n                if (shouldRemove) {\r\n                    dispatch('REMOVE_ITEM', { query: item.id });\r\n                }\r\n            })\r\n            .catch(() => {});\r\n    }),\r\n\r\n    SET_OPTIONS: ({ options }) => {\r\n        // get all keys passed\r\n        const optionKeys = Object.keys(options);\r\n\r\n        // get prioritized keyed to include (remove once not in options object)\r\n        const prioritizedOptionKeys = PrioritizedOptions.filter(key => optionKeys.includes(key));\r\n\r\n        // order the keys, prioritized first, then rest\r\n        const orderedOptionKeys = [\r\n            // add prioritized first if passed to options, else remove\r\n            ...prioritizedOptionKeys,\r\n\r\n            // prevent duplicate keys\r\n            ...Object.keys(options).filter(key => !prioritizedOptionKeys.includes(key)),\r\n        ];\r\n\r\n        // dispatch set event for each option\r\n        orderedOptionKeys.forEach(key => {\r\n            dispatch(`SET_${fromCamels(key, '_').toUpperCase()}`, {\r\n                value: options[key],\r\n            });\r\n        });\r\n    },\r\n});\r\n\r\nconst PrioritizedOptions = [\r\n    'server', // must be processed before \"files\"\r\n];\r\n\r\nconst formatFilename = name => name;\r\n\r\nconst createElement$1 = tagName => {\r\n    return document.createElement(tagName);\r\n};\r\n\r\nconst text = (node, value) => {\r\n    let textNode = node.childNodes[0];\r\n    if (!textNode) {\r\n        textNode = document.createTextNode(value);\r\n        node.appendChild(textNode);\r\n    } else if (value !== textNode.nodeValue) {\r\n        textNode.nodeValue = value;\r\n    }\r\n};\r\n\r\nconst polarToCartesian = (centerX, centerY, radius, angleInDegrees) => {\r\n    const angleInRadians = (((angleInDegrees % 360) - 90) * Math.PI) / 180.0;\r\n    return {\r\n        x: centerX + radius * Math.cos(angleInRadians),\r\n        y: centerY + radius * Math.sin(angleInRadians),\r\n    };\r\n};\r\n\r\nconst describeArc = (x, y, radius, startAngle, endAngle, arcSweep) => {\r\n    const start = polarToCartesian(x, y, radius, endAngle);\r\n    const end = polarToCartesian(x, y, radius, startAngle);\r\n    return ['M', start.x, start.y, 'A', radius, radius, 0, arcSweep, 0, end.x, end.y].join(' ');\r\n};\r\n\r\nconst percentageArc = (x, y, radius, from, to) => {\r\n    let arcSweep = 1;\r\n    if (to > from && to - from <= 0.5) {\r\n        arcSweep = 0;\r\n    }\r\n    if (from > to && from - to >= 0.5) {\r\n        arcSweep = 0;\r\n    }\r\n    return describeArc(\r\n        x,\r\n        y,\r\n        radius,\r\n        Math.min(0.9999, from) * 360,\r\n        Math.min(0.9999, to) * 360,\r\n        arcSweep\r\n    );\r\n};\r\n\r\nconst create = ({ root, props }) => {\r\n    // start at 0\r\n    props.spin = false;\r\n    props.progress = 0;\r\n    props.opacity = 0;\r\n\r\n    // svg\r\n    const svg = createElement('svg');\r\n    root.ref.path = createElement('path', {\r\n        'stroke-width': 2,\r\n        'stroke-linecap': 'round',\r\n    });\r\n    svg.appendChild(root.ref.path);\r\n\r\n    root.ref.svg = svg;\r\n\r\n    root.appendChild(svg);\r\n};\r\n\r\nconst write = ({ root, props }) => {\r\n    if (props.opacity === 0) {\r\n        return;\r\n    }\r\n\r\n    if (props.align) {\r\n        root.element.dataset.align = props.align;\r\n    }\r\n\r\n    // get width of stroke\r\n    const ringStrokeWidth = parseInt(attr(root.ref.path, 'stroke-width'), 10);\r\n\r\n    // calculate size of ring\r\n    const size = root.rect.element.width * 0.5;\r\n\r\n    // ring state\r\n    let ringFrom = 0;\r\n    let ringTo = 0;\r\n\r\n    // now in busy mode\r\n    if (props.spin) {\r\n        ringFrom = 0;\r\n        ringTo = 0.5;\r\n    } else {\r\n        ringFrom = 0;\r\n        ringTo = props.progress;\r\n    }\r\n\r\n    // get arc path\r\n    const coordinates = percentageArc(size, size, size - ringStrokeWidth, ringFrom, ringTo);\r\n\r\n    // update progress bar\r\n    attr(root.ref.path, 'd', coordinates);\r\n\r\n    // hide while contains 0 value\r\n    attr(root.ref.path, 'stroke-opacity', props.spin || props.progress > 0 ? 1 : 0);\r\n};\r\n\r\nconst progressIndicator = createView({\r\n    tag: 'div',\r\n    name: 'progress-indicator',\r\n    ignoreRectUpdate: true,\r\n    ignoreRect: true,\r\n    create,\r\n    write,\r\n    mixins: {\r\n        apis: ['progress', 'spin', 'align'],\r\n        styles: ['opacity'],\r\n        animations: {\r\n            opacity: { type: 'tween', duration: 500 },\r\n            progress: {\r\n                type: 'spring',\r\n                stiffness: 0.95,\r\n                damping: 0.65,\r\n                mass: 10,\r\n            },\r\n        },\r\n    },\r\n});\r\n\r\nconst create$1 = ({ root, props }) => {\r\n    root.element.innerHTML = (props.icon || '') + `<span>${props.label}</span>`;\r\n\r\n    props.isDisabled = false;\r\n};\r\n\r\nconst write$1 = ({ root, props }) => {\r\n    const { isDisabled } = props;\r\n    const shouldDisable = root.query('GET_DISABLED') || props.opacity === 0;\r\n\r\n    if (shouldDisable && !isDisabled) {\r\n        props.isDisabled = true;\r\n        attr(root.element, 'disabled', 'disabled');\r\n    } else if (!shouldDisable && isDisabled) {\r\n        props.isDisabled = false;\r\n        root.element.removeAttribute('disabled');\r\n    }\r\n};\r\n\r\nconst fileActionButton = createView({\r\n    tag: 'button',\r\n    attributes: {\r\n        type: 'button',\r\n    },\r\n    ignoreRect: true,\r\n    ignoreRectUpdate: true,\r\n    name: 'file-action-button',\r\n    mixins: {\r\n        apis: ['label'],\r\n        styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity'],\r\n        animations: {\r\n            scaleX: 'spring',\r\n            scaleY: 'spring',\r\n            translateX: 'spring',\r\n            translateY: 'spring',\r\n            opacity: { type: 'tween', duration: 250 },\r\n        },\r\n        listeners: true,\r\n    },\r\n    create: create$1,\r\n    write: write$1,\r\n});\r\n\r\nconst toNaturalFileSize = (bytes, decimalSeparator = '.', base = 1000, options = {}) => {\r\n    const {\r\n        labelBytes = 'bytes',\r\n        labelKilobytes = 'KB',\r\n        labelMegabytes = 'MB',\r\n        labelGigabytes = 'GB',\r\n    } = options;\r\n\r\n    // no negative byte sizes\r\n    bytes = Math.round(Math.abs(bytes));\r\n\r\n    const KB = base;\r\n    const MB = base * base;\r\n    const GB = base * base * base;\r\n\r\n    // just bytes\r\n    if (bytes < KB) {\r\n        return `${bytes} ${labelBytes}`;\r\n    }\r\n\r\n    // kilobytes\r\n    if (bytes < MB) {\r\n        return `${Math.floor(bytes / KB)} ${labelKilobytes}`;\r\n    }\r\n\r\n    // megabytes\r\n    if (bytes < GB) {\r\n        return `${removeDecimalsWhenZero(bytes / MB, 1, decimalSeparator)} ${labelMegabytes}`;\r\n    }\r\n\r\n    // gigabytes\r\n    return `${removeDecimalsWhenZero(bytes / GB, 2, decimalSeparator)} ${labelGigabytes}`;\r\n};\r\n\r\nconst removeDecimalsWhenZero = (value, decimalCount, separator) => {\r\n    return value\r\n        .toFixed(decimalCount)\r\n        .split('.')\r\n        .filter(part => part !== '0')\r\n        .join(separator);\r\n};\r\n\r\nconst create$2 = ({ root, props }) => {\r\n    // filename\r\n    const fileName = createElement$1('span');\r\n    fileName.className = 'filepond--file-info-main';\r\n    // hide for screenreaders\r\n    // the file is contained in a fieldset with legend that contains the filename\r\n    // no need to read it twice\r\n    attr(fileName, 'aria-hidden', 'true');\r\n    root.appendChild(fileName);\r\n    root.ref.fileName = fileName;\r\n\r\n    // filesize\r\n    const fileSize = createElement$1('span');\r\n    fileSize.className = 'filepond--file-info-sub';\r\n    root.appendChild(fileSize);\r\n    root.ref.fileSize = fileSize;\r\n\r\n    // set initial values\r\n    text(fileSize, root.query('GET_LABEL_FILE_WAITING_FOR_SIZE'));\r\n    text(fileName, formatFilename(root.query('GET_ITEM_NAME', props.id)));\r\n};\r\n\r\nconst updateFile = ({ root, props }) => {\r\n    text(\r\n        root.ref.fileSize,\r\n        toNaturalFileSize(\r\n            root.query('GET_ITEM_SIZE', props.id),\r\n            '.',\r\n            root.query('GET_FILE_SIZE_BASE'),\r\n            root.query('GET_FILE_SIZE_LABELS', root.query)\r\n        )\r\n    );\r\n    text(root.ref.fileName, formatFilename(root.query('GET_ITEM_NAME', props.id)));\r\n};\r\n\r\nconst updateFileSizeOnError = ({ root, props }) => {\r\n    // if size is available don't fallback to unknown size message\r\n    if (isInt(root.query('GET_ITEM_SIZE', props.id))) {\r\n        updateFile({ root, props });\r\n        return;\r\n    }\r\n\r\n    text(root.ref.fileSize, root.query('GET_LABEL_FILE_SIZE_NOT_AVAILABLE'));\r\n};\r\n\r\nconst fileInfo = createView({\r\n    name: 'file-info',\r\n    ignoreRect: true,\r\n    ignoreRectUpdate: true,\r\n    write: createRoute({\r\n        DID_LOAD_ITEM: updateFile,\r\n        DID_UPDATE_ITEM_META: updateFile,\r\n        DID_THROW_ITEM_LOAD_ERROR: updateFileSizeOnError,\r\n        DID_THROW_ITEM_INVALID: updateFileSizeOnError,\r\n    }),\r\n    didCreateView: root => {\r\n        applyFilters('CREATE_VIEW', { ...root, view: root });\r\n    },\r\n    create: create$2,\r\n    mixins: {\r\n        styles: ['translateX', 'translateY'],\r\n        animations: {\r\n            translateX: 'spring',\r\n            translateY: 'spring',\r\n        },\r\n    },\r\n});\r\n\r\nconst toPercentage = value => Math.round(value * 100);\r\n\r\nconst create$3 = ({ root }) => {\r\n    // main status\r\n    const main = createElement$1('span');\r\n    main.className = 'filepond--file-status-main';\r\n    root.appendChild(main);\r\n    root.ref.main = main;\r\n\r\n    // sub status\r\n    const sub = createElement$1('span');\r\n    sub.className = 'filepond--file-status-sub';\r\n    root.appendChild(sub);\r\n    root.ref.sub = sub;\r\n\r\n    didSetItemLoadProgress({ root, action: { progress: null } });\r\n};\r\n\r\nconst didSetItemLoadProgress = ({ root, action }) => {\r\n    const title =\r\n        action.progress === null\r\n            ? root.query('GET_LABEL_FILE_LOADING')\r\n            : `${root.query('GET_LABEL_FILE_LOADING')} ${toPercentage(action.progress)}%`;\r\n    text(root.ref.main, title);\r\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\r\n};\r\n\r\nconst didSetItemProcessProgress = ({ root, action }) => {\r\n    const title =\r\n        action.progress === null\r\n            ? root.query('GET_LABEL_FILE_PROCESSING')\r\n            : `${root.query('GET_LABEL_FILE_PROCESSING')} ${toPercentage(action.progress)}%`;\r\n    text(root.ref.main, title);\r\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\r\n};\r\n\r\nconst didRequestItemProcessing = ({ root }) => {\r\n    text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING'));\r\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\r\n};\r\n\r\nconst didAbortItemProcessing = ({ root }) => {\r\n    text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING_ABORTED'));\r\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_RETRY'));\r\n};\r\n\r\nconst didCompleteItemProcessing = ({ root }) => {\r\n    text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING_COMPLETE'));\r\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_UNDO'));\r\n};\r\n\r\nconst clear = ({ root }) => {\r\n    text(root.ref.main, '');\r\n    text(root.ref.sub, '');\r\n};\r\n\r\nconst error = ({ root, action }) => {\r\n    text(root.ref.main, action.status.main);\r\n    text(root.ref.sub, action.status.sub);\r\n};\r\n\r\nconst fileStatus = createView({\r\n    name: 'file-status',\r\n    ignoreRect: true,\r\n    ignoreRectUpdate: true,\r\n    write: createRoute({\r\n        DID_LOAD_ITEM: clear,\r\n        DID_REVERT_ITEM_PROCESSING: clear,\r\n        DID_REQUEST_ITEM_PROCESSING: didRequestItemProcessing,\r\n        DID_ABORT_ITEM_PROCESSING: didAbortItemProcessing,\r\n        DID_COMPLETE_ITEM_PROCESSING: didCompleteItemProcessing,\r\n        DID_UPDATE_ITEM_PROCESS_PROGRESS: didSetItemProcessProgress,\r\n        DID_UPDATE_ITEM_LOAD_PROGRESS: didSetItemLoadProgress,\r\n        DID_THROW_ITEM_LOAD_ERROR: error,\r\n        DID_THROW_ITEM_INVALID: error,\r\n        DID_THROW_ITEM_PROCESSING_ERROR: error,\r\n        DID_THROW_ITEM_PROCESSING_REVERT_ERROR: error,\r\n        DID_THROW_ITEM_REMOVE_ERROR: error,\r\n    }),\r\n    didCreateView: root => {\r\n        applyFilters('CREATE_VIEW', { ...root, view: root });\r\n    },\r\n    create: create$3,\r\n    mixins: {\r\n        styles: ['translateX', 'translateY', 'opacity'],\r\n        animations: {\r\n            opacity: { type: 'tween', duration: 250 },\r\n            translateX: 'spring',\r\n            translateY: 'spring',\r\n        },\r\n    },\r\n});\r\n\r\n/**\r\n * Button definitions for the file view\r\n */\r\n\r\nconst Buttons = {\r\n    AbortItemLoad: {\r\n        label: 'GET_LABEL_BUTTON_ABORT_ITEM_LOAD',\r\n        action: 'ABORT_ITEM_LOAD',\r\n        className: 'filepond--action-abort-item-load',\r\n        align: 'LOAD_INDICATOR_POSITION', // right\r\n    },\r\n    RetryItemLoad: {\r\n        label: 'GET_LABEL_BUTTON_RETRY_ITEM_LOAD',\r\n        action: 'RETRY_ITEM_LOAD',\r\n        icon: 'GET_ICON_RETRY',\r\n        className: 'filepond--action-retry-item-load',\r\n        align: 'BUTTON_PROCESS_ITEM_POSITION', // right\r\n    },\r\n    RemoveItem: {\r\n        label: 'GET_LABEL_BUTTON_REMOVE_ITEM',\r\n        action: 'REQUEST_REMOVE_ITEM',\r\n        icon: 'GET_ICON_REMOVE',\r\n        className: 'filepond--action-remove-item',\r\n        align: 'BUTTON_REMOVE_ITEM_POSITION', // left\r\n    },\r\n    ProcessItem: {\r\n        label: 'GET_LABEL_BUTTON_PROCESS_ITEM',\r\n        action: 'REQUEST_ITEM_PROCESSING',\r\n        icon: 'GET_ICON_PROCESS',\r\n        className: 'filepond--action-process-item',\r\n        align: 'BUTTON_PROCESS_ITEM_POSITION', // right\r\n    },\r\n    AbortItemProcessing: {\r\n        label: 'GET_LABEL_BUTTON_ABORT_ITEM_PROCESSING',\r\n        action: 'ABORT_ITEM_PROCESSING',\r\n        className: 'filepond--action-abort-item-processing',\r\n        align: 'BUTTON_PROCESS_ITEM_POSITION', // right\r\n    },\r\n    RetryItemProcessing: {\r\n        label: 'GET_LABEL_BUTTON_RETRY_ITEM_PROCESSING',\r\n        action: 'RETRY_ITEM_PROCESSING',\r\n        icon: 'GET_ICON_RETRY',\r\n        className: 'filepond--action-retry-item-processing',\r\n        align: 'BUTTON_PROCESS_ITEM_POSITION', // right\r\n    },\r\n    RevertItemProcessing: {\r\n        label: 'GET_LABEL_BUTTON_UNDO_ITEM_PROCESSING',\r\n        action: 'REQUEST_REVERT_ITEM_PROCESSING',\r\n        icon: 'GET_ICON_UNDO',\r\n        className: 'filepond--action-revert-item-processing',\r\n        align: 'BUTTON_PROCESS_ITEM_POSITION', // right\r\n    },\r\n};\r\n\r\n// make a list of buttons, we can then remove buttons from this list if they're disabled\r\nconst ButtonKeys = [];\r\nforin(Buttons, key => {\r\n    ButtonKeys.push(key);\r\n});\r\n\r\nconst calculateFileInfoOffset = root => {\r\n    if (getRemoveIndicatorAligment(root) === 'right') return 0;\r\n    const buttonRect = root.ref.buttonRemoveItem.rect.element;\r\n    return buttonRect.hidden ? null : buttonRect.width + buttonRect.left;\r\n};\r\n\r\nconst calculateButtonWidth = root => {\r\n    const buttonRect = root.ref.buttonAbortItemLoad.rect.element;\r\n    return buttonRect.width;\r\n};\r\n\r\n// Force on full pixels so text stays crips\r\nconst calculateFileVerticalCenterOffset = root =>\r\n    Math.floor(root.ref.buttonRemoveItem.rect.element.height / 4);\r\nconst calculateFileHorizontalCenterOffset = root =>\r\n    Math.floor(root.ref.buttonRemoveItem.rect.element.left / 2);\r\n\r\nconst getLoadIndicatorAlignment = root => root.query('GET_STYLE_LOAD_INDICATOR_POSITION');\r\nconst getProcessIndicatorAlignment = root => root.query('GET_STYLE_PROGRESS_INDICATOR_POSITION');\r\nconst getRemoveIndicatorAligment = root => root.query('GET_STYLE_BUTTON_REMOVE_ITEM_POSITION');\r\n\r\nconst DefaultStyle = {\r\n    buttonAbortItemLoad: { opacity: 0 },\r\n    buttonRetryItemLoad: { opacity: 0 },\r\n    buttonRemoveItem: { opacity: 0 },\r\n    buttonProcessItem: { opacity: 0 },\r\n    buttonAbortItemProcessing: { opacity: 0 },\r\n    buttonRetryItemProcessing: { opacity: 0 },\r\n    buttonRevertItemProcessing: { opacity: 0 },\r\n    loadProgressIndicator: { opacity: 0, align: getLoadIndicatorAlignment },\r\n    processProgressIndicator: { opacity: 0, align: getProcessIndicatorAlignment },\r\n    processingCompleteIndicator: { opacity: 0, scaleX: 0.75, scaleY: 0.75 },\r\n    info: { translateX: 0, translateY: 0, opacity: 0 },\r\n    status: { translateX: 0, translateY: 0, opacity: 0 },\r\n};\r\n\r\nconst IdleStyle = {\r\n    buttonRemoveItem: { opacity: 1 },\r\n    buttonProcessItem: { opacity: 1 },\r\n    info: { translateX: calculateFileInfoOffset },\r\n    status: { translateX: calculateFileInfoOffset },\r\n};\r\n\r\nconst ProcessingStyle = {\r\n    buttonAbortItemProcessing: { opacity: 1 },\r\n    processProgressIndicator: { opacity: 1 },\r\n    status: { opacity: 1 },\r\n};\r\n\r\nconst StyleMap = {\r\n    DID_THROW_ITEM_INVALID: {\r\n        buttonRemoveItem: { opacity: 1 },\r\n        info: { translateX: calculateFileInfoOffset },\r\n        status: { translateX: calculateFileInfoOffset, opacity: 1 },\r\n    },\r\n    DID_START_ITEM_LOAD: {\r\n        buttonAbortItemLoad: { opacity: 1 },\r\n        loadProgressIndicator: { opacity: 1 },\r\n        status: { opacity: 1 },\r\n    },\r\n    DID_THROW_ITEM_LOAD_ERROR: {\r\n        buttonRetryItemLoad: { opacity: 1 },\r\n        buttonRemoveItem: { opacity: 1 },\r\n        info: { translateX: calculateFileInfoOffset },\r\n        status: { opacity: 1 },\r\n    },\r\n    DID_START_ITEM_REMOVE: {\r\n        processProgressIndicator: { opacity: 1, align: getRemoveIndicatorAligment },\r\n        info: { translateX: calculateFileInfoOffset },\r\n        status: { opacity: 0 },\r\n    },\r\n    DID_THROW_ITEM_REMOVE_ERROR: {\r\n        processProgressIndicator: { opacity: 0, align: getRemoveIndicatorAligment },\r\n        buttonRemoveItem: { opacity: 1 },\r\n        info: { translateX: calculateFileInfoOffset },\r\n        status: { opacity: 1, translateX: calculateFileInfoOffset },\r\n    },\r\n    DID_LOAD_ITEM: IdleStyle,\r\n    DID_LOAD_LOCAL_ITEM: {\r\n        buttonRemoveItem: { opacity: 1 },\r\n        info: { translateX: calculateFileInfoOffset },\r\n        status: { translateX: calculateFileInfoOffset },\r\n    },\r\n    DID_START_ITEM_PROCESSING: ProcessingStyle,\r\n    DID_REQUEST_ITEM_PROCESSING: ProcessingStyle,\r\n    DID_UPDATE_ITEM_PROCESS_PROGRESS: ProcessingStyle,\r\n    DID_COMPLETE_ITEM_PROCESSING: {\r\n        buttonRevertItemProcessing: { opacity: 1 },\r\n        info: { opacity: 1 },\r\n        status: { opacity: 1 },\r\n    },\r\n    DID_THROW_ITEM_PROCESSING_ERROR: {\r\n        buttonRemoveItem: { opacity: 1 },\r\n        buttonRetryItemProcessing: { opacity: 1 },\r\n        status: { opacity: 1 },\r\n        info: { translateX: calculateFileInfoOffset },\r\n    },\r\n    DID_THROW_ITEM_PROCESSING_REVERT_ERROR: {\r\n        buttonRevertItemProcessing: { opacity: 1 },\r\n        status: { opacity: 1 },\r\n        info: { opacity: 1 },\r\n    },\r\n    DID_ABORT_ITEM_PROCESSING: {\r\n        buttonRemoveItem: { opacity: 1 },\r\n        buttonProcessItem: { opacity: 1 },\r\n        info: { translateX: calculateFileInfoOffset },\r\n        status: { opacity: 1 },\r\n    },\r\n    DID_REVERT_ITEM_PROCESSING: IdleStyle,\r\n};\r\n\r\n// complete indicator view\r\nconst processingCompleteIndicatorView = createView({\r\n    create: ({ root }) => {\r\n        root.element.innerHTML = root.query('GET_ICON_DONE');\r\n    },\r\n    name: 'processing-complete-indicator',\r\n    ignoreRect: true,\r\n    mixins: {\r\n        styles: ['scaleX', 'scaleY', 'opacity'],\r\n        animations: {\r\n            scaleX: 'spring',\r\n            scaleY: 'spring',\r\n            opacity: { type: 'tween', duration: 250 },\r\n        },\r\n    },\r\n});\r\n\r\n/**\r\n * Creates the file view\r\n */\r\nconst create$4 = ({ root, props }) => {\r\n    // copy Buttons object\r\n    const LocalButtons = Object.keys(Buttons).reduce((prev, curr) => {\r\n        prev[curr] = { ...Buttons[curr] };\r\n        return prev;\r\n    }, {});\r\n\r\n    const { id } = props;\r\n\r\n    // allow reverting upload\r\n    const allowRevert = root.query('GET_ALLOW_REVERT');\r\n\r\n    // allow remove file\r\n    const allowRemove = root.query('GET_ALLOW_REMOVE');\r\n\r\n    // allow processing upload\r\n    const allowProcess = root.query('GET_ALLOW_PROCESS');\r\n\r\n    // is instant uploading, need this to determine the icon of the undo button\r\n    const instantUpload = root.query('GET_INSTANT_UPLOAD');\r\n\r\n    // is async set up\r\n    const isAsync = root.query('IS_ASYNC');\r\n\r\n    // should align remove item buttons\r\n    const alignRemoveItemButton = root.query('GET_STYLE_BUTTON_REMOVE_ITEM_ALIGN');\r\n\r\n    // enabled buttons array\r\n    let buttonFilter;\r\n    if (isAsync) {\r\n        if (allowProcess && !allowRevert) {\r\n            // only remove revert button\r\n            buttonFilter = key => !/RevertItemProcessing/.test(key);\r\n        } else if (!allowProcess && allowRevert) {\r\n            // only remove process button\r\n            buttonFilter = key => !/ProcessItem|RetryItemProcessing|AbortItemProcessing/.test(key);\r\n        } else if (!allowProcess && !allowRevert) {\r\n            // remove all process buttons\r\n            buttonFilter = key => !/Process/.test(key);\r\n        }\r\n    } else {\r\n        // no process controls available\r\n        buttonFilter = key => !/Process/.test(key);\r\n    }\r\n\r\n    const enabledButtons = buttonFilter ? ButtonKeys.filter(buttonFilter) : ButtonKeys.concat();\r\n\r\n    // update icon and label for revert button when instant uploading\r\n    if (instantUpload && allowRevert) {\r\n        LocalButtons['RevertItemProcessing'].label = 'GET_LABEL_BUTTON_REMOVE_ITEM';\r\n        LocalButtons['RevertItemProcessing'].icon = 'GET_ICON_REMOVE';\r\n    }\r\n\r\n    // remove last button (revert) if not allowed\r\n    if (isAsync && !allowRevert) {\r\n        const map = StyleMap['DID_COMPLETE_ITEM_PROCESSING'];\r\n        map.info.translateX = calculateFileHorizontalCenterOffset;\r\n        map.info.translateY = calculateFileVerticalCenterOffset;\r\n        map.status.translateY = calculateFileVerticalCenterOffset;\r\n        map.processingCompleteIndicator = { opacity: 1, scaleX: 1, scaleY: 1 };\r\n    }\r\n\r\n    // should align center\r\n    if (isAsync && !allowProcess) {\r\n        [\r\n            'DID_START_ITEM_PROCESSING',\r\n            'DID_REQUEST_ITEM_PROCESSING',\r\n            'DID_UPDATE_ITEM_PROCESS_PROGRESS',\r\n            'DID_THROW_ITEM_PROCESSING_ERROR',\r\n        ].forEach(key => {\r\n            StyleMap[key].status.translateY = calculateFileVerticalCenterOffset;\r\n        });\r\n        StyleMap['DID_THROW_ITEM_PROCESSING_ERROR'].status.translateX = calculateButtonWidth;\r\n    }\r\n\r\n    // move remove button to right\r\n    if (alignRemoveItemButton && allowRevert) {\r\n        LocalButtons['RevertItemProcessing'].align = 'BUTTON_REMOVE_ITEM_POSITION';\r\n        const map = StyleMap['DID_COMPLETE_ITEM_PROCESSING'];\r\n        map.info.translateX = calculateFileInfoOffset;\r\n        map.status.translateY = calculateFileVerticalCenterOffset;\r\n        map.processingCompleteIndicator = { opacity: 1, scaleX: 1, scaleY: 1 };\r\n    }\r\n\r\n    // show/hide RemoveItem button\r\n    if (!allowRemove) {\r\n        LocalButtons['RemoveItem'].disabled = true;\r\n    }\r\n\r\n    // create the button views\r\n    forin(LocalButtons, (key, definition) => {\r\n        // create button\r\n        const buttonView = root.createChildView(fileActionButton, {\r\n            label: root.query(definition.label),\r\n            icon: root.query(definition.icon),\r\n            opacity: 0,\r\n        });\r\n\r\n        // should be appended?\r\n        if (enabledButtons.includes(key)) {\r\n            root.appendChildView(buttonView);\r\n        }\r\n\r\n        // toggle\r\n        if (definition.disabled) {\r\n            buttonView.element.setAttribute('disabled', 'disabled');\r\n            buttonView.element.setAttribute('hidden', 'hidden');\r\n        }\r\n\r\n        // add position attribute\r\n        buttonView.element.dataset.align = root.query(`GET_STYLE_${definition.align}`);\r\n\r\n        // add class\r\n        buttonView.element.classList.add(definition.className);\r\n\r\n        // handle interactions\r\n        buttonView.on('click', e => {\r\n            e.stopPropagation();\r\n            if (definition.disabled) return;\r\n            root.dispatch(definition.action, { query: id });\r\n        });\r\n\r\n        // set reference\r\n        root.ref[`button${key}`] = buttonView;\r\n    });\r\n\r\n    // checkmark\r\n    root.ref.processingCompleteIndicator = root.appendChildView(\r\n        root.createChildView(processingCompleteIndicatorView)\r\n    );\r\n    root.ref.processingCompleteIndicator.element.dataset.align = root.query(\r\n        `GET_STYLE_BUTTON_PROCESS_ITEM_POSITION`\r\n    );\r\n\r\n    // create file info view\r\n    root.ref.info = root.appendChildView(root.createChildView(fileInfo, { id }));\r\n\r\n    // create file status view\r\n    root.ref.status = root.appendChildView(root.createChildView(fileStatus, { id }));\r\n\r\n    // add progress indicators\r\n    const loadIndicatorView = root.appendChildView(\r\n        root.createChildView(progressIndicator, {\r\n            opacity: 0,\r\n            align: root.query(`GET_STYLE_LOAD_INDICATOR_POSITION`),\r\n        })\r\n    );\r\n    loadIndicatorView.element.classList.add('filepond--load-indicator');\r\n    root.ref.loadProgressIndicator = loadIndicatorView;\r\n\r\n    const progressIndicatorView = root.appendChildView(\r\n        root.createChildView(progressIndicator, {\r\n            opacity: 0,\r\n            align: root.query(`GET_STYLE_PROGRESS_INDICATOR_POSITION`),\r\n        })\r\n    );\r\n    progressIndicatorView.element.classList.add('filepond--process-indicator');\r\n    root.ref.processProgressIndicator = progressIndicatorView;\r\n\r\n    // current active styles\r\n    root.ref.activeStyles = [];\r\n};\r\n\r\nconst write$2 = ({ root, actions, props }) => {\r\n    // route actions\r\n    route({ root, actions, props });\r\n\r\n    // select last state change action\r\n    let action = actions\r\n        .concat()\r\n        .filter(action => /^DID_/.test(action.type))\r\n        .reverse()\r\n        .find(action => StyleMap[action.type]);\r\n\r\n    // a new action happened, let's get the matching styles\r\n    if (action) {\r\n        // define new active styles\r\n        root.ref.activeStyles = [];\r\n\r\n        const stylesToApply = StyleMap[action.type];\r\n        forin(DefaultStyle, (name, defaultStyles) => {\r\n            // get reference to control\r\n            const control = root.ref[name];\r\n\r\n            // loop over all styles for this control\r\n            forin(defaultStyles, (key, defaultValue) => {\r\n                const value =\r\n                    stylesToApply[name] && typeof stylesToApply[name][key] !== 'undefined'\r\n                        ? stylesToApply[name][key]\r\n                        : defaultValue;\r\n                root.ref.activeStyles.push({ control, key, value });\r\n            });\r\n        });\r\n    }\r\n\r\n    // apply active styles to element\r\n    root.ref.activeStyles.forEach(({ control, key, value }) => {\r\n        control[key] = typeof value === 'function' ? value(root) : value;\r\n    });\r\n};\r\n\r\nconst route = createRoute({\r\n    DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING: ({ root, action }) => {\r\n        root.ref.buttonAbortItemProcessing.label = action.value;\r\n    },\r\n    DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD: ({ root, action }) => {\r\n        root.ref.buttonAbortItemLoad.label = action.value;\r\n    },\r\n    DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL: ({ root, action }) => {\r\n        root.ref.buttonAbortItemRemoval.label = action.value;\r\n    },\r\n    DID_REQUEST_ITEM_PROCESSING: ({ root }) => {\r\n        root.ref.processProgressIndicator.spin = true;\r\n        root.ref.processProgressIndicator.progress = 0;\r\n    },\r\n    DID_START_ITEM_LOAD: ({ root }) => {\r\n        root.ref.loadProgressIndicator.spin = true;\r\n        root.ref.loadProgressIndicator.progress = 0;\r\n    },\r\n    DID_START_ITEM_REMOVE: ({ root }) => {\r\n        root.ref.processProgressIndicator.spin = true;\r\n        root.ref.processProgressIndicator.progress = 0;\r\n    },\r\n    DID_UPDATE_ITEM_LOAD_PROGRESS: ({ root, action }) => {\r\n        root.ref.loadProgressIndicator.spin = false;\r\n        root.ref.loadProgressIndicator.progress = action.progress;\r\n    },\r\n    DID_UPDATE_ITEM_PROCESS_PROGRESS: ({ root, action }) => {\r\n        root.ref.processProgressIndicator.spin = false;\r\n        root.ref.processProgressIndicator.progress = action.progress;\r\n    },\r\n});\r\n\r\nconst file = createView({\r\n    create: create$4,\r\n    write: write$2,\r\n    didCreateView: root => {\r\n        applyFilters('CREATE_VIEW', { ...root, view: root });\r\n    },\r\n    name: 'file',\r\n});\r\n\r\n/**\r\n * Creates the file view\r\n */\r\nconst create$5 = ({ root, props }) => {\r\n    // filename\r\n    root.ref.fileName = createElement$1('legend');\r\n    root.appendChild(root.ref.fileName);\r\n\r\n    // file appended\r\n    root.ref.file = root.appendChildView(root.createChildView(file, { id: props.id }));\r\n\r\n    // data has moved to data.js\r\n    root.ref.data = false;\r\n};\r\n\r\n/**\r\n * Data storage\r\n */\r\nconst didLoadItem = ({ root, props }) => {\r\n    // updates the legend of the fieldset so screenreaders can better group buttons\r\n    text(root.ref.fileName, formatFilename(root.query('GET_ITEM_NAME', props.id)));\r\n};\r\n\r\nconst fileWrapper = createView({\r\n    create: create$5,\r\n    ignoreRect: true,\r\n    write: createRoute({\r\n        DID_LOAD_ITEM: didLoadItem,\r\n    }),\r\n    didCreateView: root => {\r\n        applyFilters('CREATE_VIEW', { ...root, view: root });\r\n    },\r\n    tag: 'fieldset',\r\n    name: 'file-wrapper',\r\n});\r\n\r\nconst PANEL_SPRING_PROPS = { type: 'spring', damping: 0.6, mass: 7 };\r\n\r\nconst create$6 = ({ root, props }) => {\r\n    [\r\n        {\r\n            name: 'top',\r\n        },\r\n        {\r\n            name: 'center',\r\n            props: {\r\n                translateY: null,\r\n                scaleY: null,\r\n            },\r\n            mixins: {\r\n                animations: {\r\n                    scaleY: PANEL_SPRING_PROPS,\r\n                },\r\n                styles: ['translateY', 'scaleY'],\r\n            },\r\n        },\r\n        {\r\n            name: 'bottom',\r\n            props: {\r\n                translateY: null,\r\n            },\r\n            mixins: {\r\n                animations: {\r\n                    translateY: PANEL_SPRING_PROPS,\r\n                },\r\n                styles: ['translateY'],\r\n            },\r\n        },\r\n    ].forEach(section => {\r\n        createSection(root, section, props.name);\r\n    });\r\n\r\n    root.element.classList.add(`filepond--${props.name}`);\r\n\r\n    root.ref.scalable = null;\r\n};\r\n\r\nconst createSection = (root, section, className) => {\r\n    const viewConstructor = createView({\r\n        name: `panel-${section.name} filepond--${className}`,\r\n        mixins: section.mixins,\r\n        ignoreRectUpdate: true,\r\n    });\r\n\r\n    const view = root.createChildView(viewConstructor, section.props);\r\n\r\n    root.ref[section.name] = root.appendChildView(view);\r\n};\r\n\r\nconst write$3 = ({ root, props }) => {\r\n    // update scalable state\r\n    if (root.ref.scalable === null || props.scalable !== root.ref.scalable) {\r\n        root.ref.scalable = isBoolean(props.scalable) ? props.scalable : true;\r\n        root.element.dataset.scalable = root.ref.scalable;\r\n    }\r\n\r\n    // no height, can't set\r\n    if (!props.height) return;\r\n\r\n    // get child rects\r\n    const topRect = root.ref.top.rect.element;\r\n    const bottomRect = root.ref.bottom.rect.element;\r\n\r\n    // make sure height never is smaller than bottom and top seciton heights combined (will probably never happen, but who knows)\r\n    const height = Math.max(topRect.height + bottomRect.height, props.height);\r\n\r\n    // offset center part\r\n    root.ref.center.translateY = topRect.height;\r\n\r\n    // scale center part\r\n    // use math ceil to prevent transparent lines because of rounding errors\r\n    root.ref.center.scaleY = (height - topRect.height - bottomRect.height) / 100;\r\n\r\n    // offset bottom part\r\n    root.ref.bottom.translateY = height - bottomRect.height;\r\n};\r\n\r\nconst panel = createView({\r\n    name: 'panel',\r\n    read: ({ root, props }) => (props.heightCurrent = root.ref.bottom.translateY),\r\n    write: write$3,\r\n    create: create$6,\r\n    ignoreRect: true,\r\n    mixins: {\r\n        apis: ['height', 'heightCurrent', 'scalable'],\r\n    },\r\n});\r\n\r\nconst createDragHelper = items => {\r\n    const itemIds = items.map(item => item.id);\r\n    let prevIndex = undefined;\r\n    return {\r\n        setIndex: index => {\r\n            prevIndex = index;\r\n        },\r\n        getIndex: () => prevIndex,\r\n        getItemIndex: item => itemIds.indexOf(item.id),\r\n    };\r\n};\r\n\r\nconst ITEM_TRANSLATE_SPRING = {\r\n    type: 'spring',\r\n    stiffness: 0.75,\r\n    damping: 0.45,\r\n    mass: 10,\r\n};\r\n\r\nconst ITEM_SCALE_SPRING = 'spring';\r\n\r\nconst StateMap = {\r\n    DID_START_ITEM_LOAD: 'busy',\r\n    DID_UPDATE_ITEM_LOAD_PROGRESS: 'loading',\r\n    DID_THROW_ITEM_INVALID: 'load-invalid',\r\n    DID_THROW_ITEM_LOAD_ERROR: 'load-error',\r\n    DID_LOAD_ITEM: 'idle',\r\n    DID_THROW_ITEM_REMOVE_ERROR: 'remove-error',\r\n    DID_START_ITEM_REMOVE: 'busy',\r\n    DID_START_ITEM_PROCESSING: 'busy processing',\r\n    DID_REQUEST_ITEM_PROCESSING: 'busy processing',\r\n    DID_UPDATE_ITEM_PROCESS_PROGRESS: 'processing',\r\n    DID_COMPLETE_ITEM_PROCESSING: 'processing-complete',\r\n    DID_THROW_ITEM_PROCESSING_ERROR: 'processing-error',\r\n    DID_THROW_ITEM_PROCESSING_REVERT_ERROR: 'processing-revert-error',\r\n    DID_ABORT_ITEM_PROCESSING: 'cancelled',\r\n    DID_REVERT_ITEM_PROCESSING: 'idle',\r\n};\r\n\r\n/**\r\n * Creates the file view\r\n */\r\nconst create$7 = ({ root, props }) => {\r\n    // select\r\n    root.ref.handleClick = e => root.dispatch('DID_ACTIVATE_ITEM', { id: props.id });\r\n\r\n    // set id\r\n    root.element.id = `filepond--item-${props.id}`;\r\n    root.element.addEventListener('click', root.ref.handleClick);\r\n\r\n    // file view\r\n    root.ref.container = root.appendChildView(root.createChildView(fileWrapper, { id: props.id }));\r\n\r\n    // file panel\r\n    root.ref.panel = root.appendChildView(root.createChildView(panel, { name: 'item-panel' }));\r\n\r\n    // default start height\r\n    root.ref.panel.height = null;\r\n\r\n    // by default not marked for removal\r\n    props.markedForRemoval = false;\r\n\r\n    // if not allowed to reorder file items, exit here\r\n    if (!root.query('GET_ALLOW_REORDER')) return;\r\n\r\n    // set to idle so shows grab cursor\r\n    root.element.dataset.dragState = 'idle';\r\n\r\n    const grab = e => {\r\n        if (!e.isPrimary) return;\r\n\r\n        let removedActivateListener = false;\r\n\r\n        const origin = {\r\n            x: e.pageX,\r\n            y: e.pageY,\r\n        };\r\n\r\n        props.dragOrigin = {\r\n            x: root.translateX,\r\n            y: root.translateY,\r\n        };\r\n\r\n        props.dragCenter = {\r\n            x: e.offsetX,\r\n            y: e.offsetY,\r\n        };\r\n\r\n        const dragState = createDragHelper(root.query('GET_ACTIVE_ITEMS'));\r\n\r\n        root.dispatch('DID_GRAB_ITEM', { id: props.id, dragState });\r\n\r\n        const drag = e => {\r\n            if (!e.isPrimary) return;\r\n\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n\r\n            props.dragOffset = {\r\n                x: e.pageX - origin.x,\r\n                y: e.pageY - origin.y,\r\n            };\r\n\r\n            // if dragged stop listening to clicks, will re-add when done dragging\r\n            const dist =\r\n                props.dragOffset.x * props.dragOffset.x + props.dragOffset.y * props.dragOffset.y;\r\n            if (dist > 16 && !removedActivateListener) {\r\n                removedActivateListener = true;\r\n                root.element.removeEventListener('click', root.ref.handleClick);\r\n            }\r\n\r\n            root.dispatch('DID_DRAG_ITEM', { id: props.id, dragState });\r\n        };\r\n\r\n        const drop = e => {\r\n            if (!e.isPrimary) return;\r\n\r\n            props.dragOffset = {\r\n                x: e.pageX - origin.x,\r\n                y: e.pageY - origin.y,\r\n            };\r\n\r\n            reset();\r\n        };\r\n\r\n        const cancel = () => {\r\n            reset();\r\n        };\r\n\r\n        const reset = () => {\r\n            document.removeEventListener('pointercancel', cancel);\r\n            document.removeEventListener('pointermove', drag);\r\n            document.removeEventListener('pointerup', drop);\r\n\r\n            root.dispatch('DID_DROP_ITEM', { id: props.id, dragState });\r\n\r\n            // start listening to clicks again\r\n            if (removedActivateListener) {\r\n                setTimeout(() => root.element.addEventListener('click', root.ref.handleClick), 0);\r\n            }\r\n        };\r\n\r\n        document.addEventListener('pointercancel', cancel);\r\n        document.addEventListener('pointermove', drag);\r\n        document.addEventListener('pointerup', drop);\r\n    };\r\n\r\n    root.element.addEventListener('pointerdown', grab);\r\n};\r\n\r\nconst route$1 = createRoute({\r\n    DID_UPDATE_PANEL_HEIGHT: ({ root, action }) => {\r\n        root.height = action.height;\r\n    },\r\n});\r\n\r\nconst write$4 = createRoute(\r\n    {\r\n        DID_GRAB_ITEM: ({ root, props }) => {\r\n            props.dragOrigin = {\r\n                x: root.translateX,\r\n                y: root.translateY,\r\n            };\r\n        },\r\n        DID_DRAG_ITEM: ({ root }) => {\r\n            root.element.dataset.dragState = 'drag';\r\n        },\r\n        DID_DROP_ITEM: ({ root, props }) => {\r\n            props.dragOffset = null;\r\n            props.dragOrigin = null;\r\n            root.element.dataset.dragState = 'drop';\r\n        },\r\n    },\r\n    ({ root, actions, props, shouldOptimize }) => {\r\n        if (root.element.dataset.dragState === 'drop') {\r\n            if (root.scaleX <= 1) {\r\n                root.element.dataset.dragState = 'idle';\r\n            }\r\n        }\r\n\r\n        // select last state change action\r\n        let action = actions\r\n            .concat()\r\n            .filter(action => /^DID_/.test(action.type))\r\n            .reverse()\r\n            .find(action => StateMap[action.type]);\r\n\r\n        // no need to set same state twice\r\n        if (action && action.type !== props.currentState) {\r\n            // set current state\r\n            props.currentState = action.type;\r\n\r\n            // set state\r\n            root.element.dataset.filepondItemState = StateMap[props.currentState] || '';\r\n        }\r\n\r\n        // route actions\r\n        const aspectRatio =\r\n            root.query('GET_ITEM_PANEL_ASPECT_RATIO') || root.query('GET_PANEL_ASPECT_RATIO');\r\n        if (!aspectRatio) {\r\n            route$1({ root, actions, props });\r\n            if (!root.height && root.ref.container.rect.element.height > 0) {\r\n                root.height = root.ref.container.rect.element.height;\r\n            }\r\n        } else if (!shouldOptimize) {\r\n            root.height = root.rect.element.width * aspectRatio;\r\n        }\r\n\r\n        // sync panel height with item height\r\n        if (shouldOptimize) {\r\n            root.ref.panel.height = null;\r\n        }\r\n\r\n        root.ref.panel.height = root.height;\r\n    }\r\n);\r\n\r\nconst item = createView({\r\n    create: create$7,\r\n    write: write$4,\r\n    destroy: ({ root, props }) => {\r\n        root.element.removeEventListener('click', root.ref.handleClick);\r\n        root.dispatch('RELEASE_ITEM', { query: props.id });\r\n    },\r\n    tag: 'li',\r\n    name: 'item',\r\n    mixins: {\r\n        apis: [\r\n            'id',\r\n            'interactionMethod',\r\n            'markedForRemoval',\r\n            'spawnDate',\r\n            'dragCenter',\r\n            'dragOrigin',\r\n            'dragOffset',\r\n        ],\r\n        styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity', 'height'],\r\n        animations: {\r\n            scaleX: ITEM_SCALE_SPRING,\r\n            scaleY: ITEM_SCALE_SPRING,\r\n            translateX: ITEM_TRANSLATE_SPRING,\r\n            translateY: ITEM_TRANSLATE_SPRING,\r\n            opacity: { type: 'tween', duration: 150 },\r\n        },\r\n    },\r\n});\r\n\r\nvar getItemsPerRow = (horizontalSpace, itemWidth) => {\r\n    // add one pixel leeway, when using percentages for item width total items can be 1.99 per row\r\n\r\n    return Math.max(1, Math.floor((horizontalSpace + 1) / itemWidth));\r\n};\r\n\r\nconst getItemIndexByPosition = (view, children, positionInView) => {\r\n    if (!positionInView) return;\r\n\r\n    const horizontalSpace = view.rect.element.width;\r\n    // const children = view.childViews;\r\n    const l = children.length;\r\n    let last = null;\r\n\r\n    // -1, don't move items to accomodate (either add to top or bottom)\r\n    if (l === 0 || positionInView.top < children[0].rect.element.top) return -1;\r\n\r\n    // let's get the item width\r\n    const item = children[0];\r\n    const itemRect = item.rect.element;\r\n    const itemHorizontalMargin = itemRect.marginLeft + itemRect.marginRight;\r\n    const itemWidth = itemRect.width + itemHorizontalMargin;\r\n    const itemsPerRow = getItemsPerRow(horizontalSpace, itemWidth);\r\n\r\n    // stack\r\n    if (itemsPerRow === 1) {\r\n        for (let index = 0; index < l; index++) {\r\n            const child = children[index];\r\n            const childMid = child.rect.outer.top + child.rect.element.height * 0.5;\r\n            if (positionInView.top < childMid) {\r\n                return index;\r\n            }\r\n        }\r\n        return l;\r\n    }\r\n\r\n    // grid\r\n    const itemVerticalMargin = itemRect.marginTop + itemRect.marginBottom;\r\n    const itemHeight = itemRect.height + itemVerticalMargin;\r\n    for (let index = 0; index < l; index++) {\r\n        const indexX = index % itemsPerRow;\r\n        const indexY = Math.floor(index / itemsPerRow);\r\n\r\n        const offsetX = indexX * itemWidth;\r\n        const offsetY = indexY * itemHeight;\r\n\r\n        const itemTop = offsetY - itemRect.marginTop;\r\n        const itemRight = offsetX + itemWidth;\r\n        const itemBottom = offsetY + itemHeight + itemRect.marginBottom;\r\n\r\n        if (positionInView.top < itemBottom && positionInView.top > itemTop) {\r\n            if (positionInView.left < itemRight) {\r\n                return index;\r\n            } else if (index !== l - 1) {\r\n                last = index;\r\n            } else {\r\n                last = null;\r\n            }\r\n        }\r\n    }\r\n\r\n    if (last !== null) {\r\n        return last;\r\n    }\r\n\r\n    return l;\r\n};\r\n\r\nconst dropAreaDimensions = {\r\n    height: 0,\r\n    width: 0,\r\n    get getHeight() {\r\n        return this.height;\r\n    },\r\n    set setHeight(val) {\r\n        if (this.height === 0 || val === 0) this.height = val;\r\n    },\r\n    get getWidth() {\r\n        return this.width;\r\n    },\r\n    set setWidth(val) {\r\n        if (this.width === 0 || val === 0) this.width = val;\r\n    },\r\n    setDimensions: function(height, width) {\r\n        if (this.height === 0 || height === 0) this.height = height;\r\n        if (this.width === 0 || width === 0) this.width = width;\r\n    },\r\n};\r\n\r\nconst create$8 = ({ root }) => {\r\n    // need to set role to list as otherwise it won't be read as a list by VoiceOver\r\n    attr(root.element, 'role', 'list');\r\n\r\n    root.ref.lastItemSpanwDate = Date.now();\r\n};\r\n\r\n/**\r\n * Inserts a new item\r\n * @param root\r\n * @param action\r\n */\r\nconst addItemView = ({ root, action }) => {\r\n    const { id, index, interactionMethod } = action;\r\n\r\n    root.ref.addIndex = index;\r\n\r\n    const now = Date.now();\r\n    let spawnDate = now;\r\n    let opacity = 1;\r\n\r\n    if (interactionMethod !== InteractionMethod.NONE) {\r\n        opacity = 0;\r\n        const cooldown = root.query('GET_ITEM_INSERT_INTERVAL');\r\n        const dist = now - root.ref.lastItemSpanwDate;\r\n        spawnDate = dist < cooldown ? now + (cooldown - dist) : now;\r\n    }\r\n\r\n    root.ref.lastItemSpanwDate = spawnDate;\r\n\r\n    root.appendChildView(\r\n        root.createChildView(\r\n            // view type\r\n            item,\r\n\r\n            // props\r\n            {\r\n                spawnDate,\r\n                id,\r\n                opacity,\r\n                interactionMethod,\r\n            }\r\n        ),\r\n        index\r\n    );\r\n};\r\n\r\nconst moveItem = (item, x, y, vx = 0, vy = 1) => {\r\n    // set to null to remove animation while dragging\r\n    if (item.dragOffset) {\r\n        item.translateX = null;\r\n        item.translateY = null;\r\n        item.translateX = item.dragOrigin.x + item.dragOffset.x;\r\n        item.translateY = item.dragOrigin.y + item.dragOffset.y;\r\n        item.scaleX = 1.025;\r\n        item.scaleY = 1.025;\r\n    } else {\r\n        item.translateX = x;\r\n        item.translateY = y;\r\n\r\n        if (Date.now() > item.spawnDate) {\r\n            // reveal element\r\n            if (item.opacity === 0) {\r\n                introItemView(item, x, y, vx, vy);\r\n            }\r\n\r\n            // make sure is default scale every frame\r\n            item.scaleX = 1;\r\n            item.scaleY = 1;\r\n            item.opacity = 1;\r\n        }\r\n    }\r\n};\r\n\r\nconst introItemView = (item, x, y, vx, vy) => {\r\n    if (item.interactionMethod === InteractionMethod.NONE) {\r\n        item.translateX = null;\r\n        item.translateX = x;\r\n        item.translateY = null;\r\n        item.translateY = y;\r\n    } else if (item.interactionMethod === InteractionMethod.DROP) {\r\n        item.translateX = null;\r\n        item.translateX = x - vx * 20;\r\n\r\n        item.translateY = null;\r\n        item.translateY = y - vy * 10;\r\n\r\n        item.scaleX = 0.8;\r\n        item.scaleY = 0.8;\r\n    } else if (item.interactionMethod === InteractionMethod.BROWSE) {\r\n        item.translateY = null;\r\n        item.translateY = y - 30;\r\n    } else if (item.interactionMethod === InteractionMethod.API) {\r\n        item.translateX = null;\r\n        item.translateX = x - 30;\r\n        item.translateY = null;\r\n    }\r\n};\r\n\r\n/**\r\n * Removes an existing item\r\n * @param root\r\n * @param action\r\n */\r\nconst removeItemView = ({ root, action }) => {\r\n    const { id } = action;\r\n\r\n    // get the view matching the given id\r\n    const view = root.childViews.find(child => child.id === id);\r\n\r\n    // if no view found, exit\r\n    if (!view) {\r\n        return;\r\n    }\r\n\r\n    // animate view out of view\r\n    view.scaleX = 0.9;\r\n    view.scaleY = 0.9;\r\n    view.opacity = 0;\r\n\r\n    // mark for removal\r\n    view.markedForRemoval = true;\r\n};\r\n\r\nconst getItemHeight = child =>\r\n    child.rect.element.height +\r\n    child.rect.element.marginBottom * 0.5 +\r\n    child.rect.element.marginTop * 0.5;\r\nconst getItemWidth = child =>\r\n    child.rect.element.width +\r\n    child.rect.element.marginLeft * 0.5 +\r\n    child.rect.element.marginRight * 0.5;\r\n\r\nconst dragItem = ({ root, action }) => {\r\n    const { id, dragState } = action;\r\n\r\n    // reference to item\r\n    const item = root.query('GET_ITEM', { id });\r\n\r\n    // get the view matching the given id\r\n    const view = root.childViews.find(child => child.id === id);\r\n\r\n    const numItems = root.childViews.length;\r\n    const oldIndex = dragState.getItemIndex(item);\r\n\r\n    // if no view found, exit\r\n    if (!view) return;\r\n\r\n    const dragPosition = {\r\n        x: view.dragOrigin.x + view.dragOffset.x + view.dragCenter.x,\r\n        y: view.dragOrigin.y + view.dragOffset.y + view.dragCenter.y,\r\n    };\r\n\r\n    // get drag area dimensions\r\n    const dragHeight = getItemHeight(view);\r\n    const dragWidth = getItemWidth(view);\r\n\r\n    // get rows and columns (There will always be at least one row and one column if a file is present)\r\n    let cols = Math.floor(root.rect.outer.width / dragWidth);\r\n    if (cols > numItems) cols = numItems;\r\n\r\n    // rows are used to find when we have left the preview area bounding box\r\n    const rows = Math.floor(numItems / cols + 1);\r\n\r\n    dropAreaDimensions.setHeight = dragHeight * rows;\r\n    dropAreaDimensions.setWidth = dragWidth * cols;\r\n\r\n    // get new index of dragged item\r\n    var location = {\r\n        y: Math.floor(dragPosition.y / dragHeight),\r\n        x: Math.floor(dragPosition.x / dragWidth),\r\n        getGridIndex: function getGridIndex() {\r\n            if (\r\n                dragPosition.y > dropAreaDimensions.getHeight ||\r\n                dragPosition.y < 0 ||\r\n                dragPosition.x > dropAreaDimensions.getWidth ||\r\n                dragPosition.x < 0\r\n            )\r\n                return oldIndex;\r\n            return this.y * cols + this.x;\r\n        },\r\n        getColIndex: function getColIndex() {\r\n            const items = root.query('GET_ACTIVE_ITEMS');\r\n            const visibleChildren = root.childViews.filter(child => child.rect.element.height);\r\n            const children = items.map(item =>\r\n                visibleChildren.find(childView => childView.id === item.id)\r\n            );\r\n            const currentIndex = children.findIndex(child => child === view);\r\n            const dragHeight = getItemHeight(view);\r\n            const l = children.length;\r\n            let idx = l;\r\n            let childHeight = 0;\r\n            let childBottom = 0;\r\n            let childTop = 0;\r\n            for (let i = 0; i < l; i++) {\r\n                childHeight = getItemHeight(children[i]);\r\n                childTop = childBottom;\r\n                childBottom = childTop + childHeight;\r\n                if (dragPosition.y < childBottom) {\r\n                    if (currentIndex > i) {\r\n                        if (dragPosition.y < childTop + dragHeight) {\r\n                            idx = i;\r\n                            break;\r\n                        }\r\n                        continue;\r\n                    }\r\n                    idx = i;\r\n                    break;\r\n                }\r\n            }\r\n            return idx;\r\n        },\r\n    };\r\n\r\n    // get new index\r\n    const index = cols > 1 ? location.getGridIndex() : location.getColIndex();\r\n    root.dispatch('MOVE_ITEM', { query: view, index });\r\n\r\n    // if the index of the item changed, dispatch reorder action\r\n    const currentIndex = dragState.getIndex();\r\n\r\n    if (currentIndex === undefined || currentIndex !== index) {\r\n        dragState.setIndex(index);\r\n\r\n        if (currentIndex === undefined) return;\r\n\r\n        root.dispatch('DID_REORDER_ITEMS', {\r\n            items: root.query('GET_ACTIVE_ITEMS'),\r\n            origin: oldIndex,\r\n            target: index,\r\n        });\r\n    }\r\n};\r\n\r\n/**\r\n * Setup action routes\r\n */\r\nconst route$2 = createRoute({\r\n    DID_ADD_ITEM: addItemView,\r\n    DID_REMOVE_ITEM: removeItemView,\r\n    DID_DRAG_ITEM: dragItem,\r\n});\r\n\r\n/**\r\n * Write to view\r\n * @param root\r\n * @param actions\r\n * @param props\r\n */\r\nconst write$5 = ({ root, props, actions, shouldOptimize }) => {\r\n    // route actions\r\n    route$2({ root, props, actions });\r\n\r\n    const { dragCoordinates } = props;\r\n\r\n    // available space on horizontal axis\r\n    const horizontalSpace = root.rect.element.width;\r\n\r\n    // only draw children that have dimensions\r\n    const visibleChildren = root.childViews.filter(child => child.rect.element.height);\r\n\r\n    // sort based on current active items\r\n    const children = root\r\n        .query('GET_ACTIVE_ITEMS')\r\n        .map(item => visibleChildren.find(child => child.id === item.id))\r\n        .filter(item => item);\r\n\r\n    // get index\r\n    const dragIndex = dragCoordinates\r\n        ? getItemIndexByPosition(root, children, dragCoordinates)\r\n        : null;\r\n\r\n    // add index is used to reserve the dropped/added item index till the actual item is rendered\r\n    const addIndex = root.ref.addIndex || null;\r\n\r\n    // add index no longer needed till possibly next draw\r\n    root.ref.addIndex = null;\r\n\r\n    let dragIndexOffset = 0;\r\n    let removeIndexOffset = 0;\r\n    let addIndexOffset = 0;\r\n\r\n    if (children.length === 0) return;\r\n\r\n    const childRect = children[0].rect.element;\r\n    const itemVerticalMargin = childRect.marginTop + childRect.marginBottom;\r\n    const itemHorizontalMargin = childRect.marginLeft + childRect.marginRight;\r\n    const itemWidth = childRect.width + itemHorizontalMargin;\r\n    const itemHeight = childRect.height + itemVerticalMargin;\r\n    const itemsPerRow = getItemsPerRow(horizontalSpace, itemWidth);\r\n\r\n    // stack\r\n    if (itemsPerRow === 1) {\r\n        let offsetY = 0;\r\n        let dragOffset = 0;\r\n\r\n        children.forEach((child, index) => {\r\n            if (dragIndex) {\r\n                let dist = index - dragIndex;\r\n                if (dist === -2) {\r\n                    dragOffset = -itemVerticalMargin * 0.25;\r\n                } else if (dist === -1) {\r\n                    dragOffset = -itemVerticalMargin * 0.75;\r\n                } else if (dist === 0) {\r\n                    dragOffset = itemVerticalMargin * 0.75;\r\n                } else if (dist === 1) {\r\n                    dragOffset = itemVerticalMargin * 0.25;\r\n                } else {\r\n                    dragOffset = 0;\r\n                }\r\n            }\r\n\r\n            if (shouldOptimize) {\r\n                child.translateX = null;\r\n                child.translateY = null;\r\n            }\r\n\r\n            if (!child.markedForRemoval) {\r\n                moveItem(child, 0, offsetY + dragOffset);\r\n            }\r\n\r\n            let itemHeight = child.rect.element.height + itemVerticalMargin;\r\n\r\n            let visualHeight = itemHeight * (child.markedForRemoval ? child.opacity : 1);\r\n\r\n            offsetY += visualHeight;\r\n        });\r\n    }\r\n    // grid\r\n    else {\r\n        let prevX = 0;\r\n        let prevY = 0;\r\n\r\n        children.forEach((child, index) => {\r\n            if (index === dragIndex) {\r\n                dragIndexOffset = 1;\r\n            }\r\n\r\n            if (index === addIndex) {\r\n                addIndexOffset += 1;\r\n            }\r\n\r\n            if (child.markedForRemoval && child.opacity < 0.5) {\r\n                removeIndexOffset -= 1;\r\n            }\r\n\r\n            const visualIndex = index + addIndexOffset + dragIndexOffset + removeIndexOffset;\r\n\r\n            const indexX = visualIndex % itemsPerRow;\r\n            const indexY = Math.floor(visualIndex / itemsPerRow);\r\n\r\n            const offsetX = indexX * itemWidth;\r\n            const offsetY = indexY * itemHeight;\r\n\r\n            const vectorX = Math.sign(offsetX - prevX);\r\n            const vectorY = Math.sign(offsetY - prevY);\r\n\r\n            prevX = offsetX;\r\n            prevY = offsetY;\r\n\r\n            if (child.markedForRemoval) return;\r\n\r\n            if (shouldOptimize) {\r\n                child.translateX = null;\r\n                child.translateY = null;\r\n            }\r\n\r\n            moveItem(child, offsetX, offsetY, vectorX, vectorY);\r\n        });\r\n    }\r\n};\r\n\r\n/**\r\n * Filters actions that are meant specifically for a certain child of the list\r\n * @param child\r\n * @param actions\r\n */\r\nconst filterSetItemActions = (child, actions) =>\r\n    actions.filter(action => {\r\n        // if action has an id, filter out actions that don't have this child id\r\n        if (action.data && action.data.id) {\r\n            return child.id === action.data.id;\r\n        }\r\n\r\n        // allow all other actions\r\n        return true;\r\n    });\r\n\r\nconst list = createView({\r\n    create: create$8,\r\n    write: write$5,\r\n    tag: 'ul',\r\n    name: 'list',\r\n    didWriteView: ({ root }) => {\r\n        root.childViews\r\n            .filter(view => view.markedForRemoval && view.opacity === 0 && view.resting)\r\n            .forEach(view => {\r\n                view._destroy();\r\n                root.removeChildView(view);\r\n            });\r\n    },\r\n    filterFrameActionsForChild: filterSetItemActions,\r\n    mixins: {\r\n        apis: ['dragCoordinates'],\r\n    },\r\n});\r\n\r\nconst create$9 = ({ root, props }) => {\r\n    root.ref.list = root.appendChildView(root.createChildView(list));\r\n    props.dragCoordinates = null;\r\n    props.overflowing = false;\r\n};\r\n\r\nconst storeDragCoordinates = ({ root, props, action }) => {\r\n    if (!root.query('GET_ITEM_INSERT_LOCATION_FREEDOM')) return;\r\n    props.dragCoordinates = {\r\n        left: action.position.scopeLeft - root.ref.list.rect.element.left,\r\n        top:\r\n            action.position.scopeTop -\r\n            (root.rect.outer.top + root.rect.element.marginTop + root.rect.element.scrollTop),\r\n    };\r\n};\r\n\r\nconst clearDragCoordinates = ({ props }) => {\r\n    props.dragCoordinates = null;\r\n};\r\n\r\nconst route$3 = createRoute({\r\n    DID_DRAG: storeDragCoordinates,\r\n    DID_END_DRAG: clearDragCoordinates,\r\n});\r\n\r\nconst write$6 = ({ root, props, actions }) => {\r\n    // route actions\r\n    route$3({ root, props, actions });\r\n\r\n    // current drag position\r\n    root.ref.list.dragCoordinates = props.dragCoordinates;\r\n\r\n    // if currently overflowing but no longer received overflow\r\n    if (props.overflowing && !props.overflow) {\r\n        props.overflowing = false;\r\n\r\n        // reset overflow state\r\n        root.element.dataset.state = '';\r\n        root.height = null;\r\n    }\r\n\r\n    // if is not overflowing currently but does receive overflow value\r\n    if (props.overflow) {\r\n        const newHeight = Math.round(props.overflow);\r\n        if (newHeight !== root.height) {\r\n            props.overflowing = true;\r\n            root.element.dataset.state = 'overflow';\r\n            root.height = newHeight;\r\n        }\r\n    }\r\n};\r\n\r\nconst listScroller = createView({\r\n    create: create$9,\r\n    write: write$6,\r\n    name: 'list-scroller',\r\n    mixins: {\r\n        apis: ['overflow', 'dragCoordinates'],\r\n        styles: ['height', 'translateY'],\r\n        animations: {\r\n            translateY: 'spring',\r\n        },\r\n    },\r\n});\r\n\r\nconst attrToggle = (element, name, state, enabledValue = '') => {\r\n    if (state) {\r\n        attr(element, name, enabledValue);\r\n    } else {\r\n        element.removeAttribute(name);\r\n    }\r\n};\r\n\r\nconst resetFileInput = input => {\r\n    // no value, no need to reset\r\n    if (!input || input.value === '') {\r\n        return;\r\n    }\r\n\r\n    try {\r\n        // for modern browsers\r\n        input.value = '';\r\n    } catch (err) {}\r\n\r\n    // for IE10\r\n    if (input.value) {\r\n        // quickly append input to temp form and reset form\r\n        const form = createElement$1('form');\r\n        const parentNode = input.parentNode;\r\n        const ref = input.nextSibling;\r\n        form.appendChild(input);\r\n        form.reset();\r\n\r\n        // re-inject input where it originally was\r\n        if (ref) {\r\n            parentNode.insertBefore(input, ref);\r\n        } else {\r\n            parentNode.appendChild(input);\r\n        }\r\n    }\r\n};\r\n\r\nconst create$a = ({ root, props }) => {\r\n    // set id so can be referenced from outside labels\r\n    root.element.id = `filepond--browser-${props.id}`;\r\n\r\n    // set name of element (is removed when a value is set)\r\n    attr(root.element, 'name', root.query('GET_NAME'));\r\n\r\n    // we have to link this element to the status element\r\n    attr(root.element, 'aria-controls', `filepond--assistant-${props.id}`);\r\n\r\n    // set label, we use labelled by as otherwise the screenreader does not read the \"browse\" text in the label (as it has tabindex: 0)\r\n    attr(root.element, 'aria-labelledby', `filepond--drop-label-${props.id}`);\r\n\r\n    // set configurable props\r\n    setAcceptedFileTypes({ root, action: { value: root.query('GET_ACCEPTED_FILE_TYPES') } });\r\n    toggleAllowMultiple({ root, action: { value: root.query('GET_ALLOW_MULTIPLE') } });\r\n    toggleDirectoryFilter({ root, action: { value: root.query('GET_ALLOW_DIRECTORIES_ONLY') } });\r\n    toggleDisabled({ root });\r\n    toggleRequired({ root, action: { value: root.query('GET_REQUIRED') } });\r\n    setCaptureMethod({ root, action: { value: root.query('GET_CAPTURE_METHOD') } });\r\n\r\n    // handle changes to the input field\r\n    root.ref.handleChange = e => {\r\n        if (!root.element.value) {\r\n            return;\r\n        }\r\n\r\n        // extract files and move value of webkitRelativePath path to _relativePath\r\n        const files = Array.from(root.element.files).map(file => {\r\n            file._relativePath = file.webkitRelativePath;\r\n            return file;\r\n        });\r\n\r\n        // we add a little delay so the OS file select window can move out of the way before we add our file\r\n        setTimeout(() => {\r\n            // load files\r\n            props.onload(files);\r\n\r\n            // reset input, it's just for exposing a method to drop files, should not retain any state\r\n            resetFileInput(root.element);\r\n        }, 250);\r\n    };\r\n\r\n    root.element.addEventListener('change', root.ref.handleChange);\r\n};\r\n\r\nconst setAcceptedFileTypes = ({ root, action }) => {\r\n    if (!root.query('GET_ALLOW_SYNC_ACCEPT_ATTRIBUTE')) return;\r\n    attrToggle(root.element, 'accept', !!action.value, action.value ? action.value.join(',') : '');\r\n};\r\n\r\nconst toggleAllowMultiple = ({ root, action }) => {\r\n    attrToggle(root.element, 'multiple', action.value);\r\n};\r\n\r\nconst toggleDirectoryFilter = ({ root, action }) => {\r\n    attrToggle(root.element, 'webkitdirectory', action.value);\r\n};\r\n\r\nconst toggleDisabled = ({ root }) => {\r\n    const isDisabled = root.query('GET_DISABLED');\r\n    const doesAllowBrowse = root.query('GET_ALLOW_BROWSE');\r\n    const disableField = isDisabled || !doesAllowBrowse;\r\n    attrToggle(root.element, 'disabled', disableField);\r\n};\r\n\r\nconst toggleRequired = ({ root, action }) => {\r\n    // want to remove required, always possible\r\n    if (!action.value) {\r\n        attrToggle(root.element, 'required', false);\r\n    }\r\n    // if want to make required, only possible when zero items\r\n    else if (root.query('GET_TOTAL_ITEMS') === 0) {\r\n        attrToggle(root.element, 'required', true);\r\n    }\r\n};\r\n\r\nconst setCaptureMethod = ({ root, action }) => {\r\n    attrToggle(root.element, 'capture', !!action.value, action.value === true ? '' : action.value);\r\n};\r\n\r\nconst updateRequiredStatus = ({ root }) => {\r\n    const { element } = root;\r\n    // always remove the required attribute when more than zero items\r\n    if (root.query('GET_TOTAL_ITEMS') > 0) {\r\n        attrToggle(element, 'required', false);\r\n        attrToggle(element, 'name', false);\r\n\r\n        // still has items\r\n        const activeItems = root.query('GET_ACTIVE_ITEMS');\r\n        let hasInvalidField = false;\r\n        for (let i = 0; i < activeItems.length; i++) {\r\n            if (activeItems[i].status === ItemStatus.LOAD_ERROR) {\r\n                hasInvalidField = true;\r\n            }\r\n        }\r\n        // set validity status\r\n        root.element.setCustomValidity(\r\n            hasInvalidField ? root.query('GET_LABEL_INVALID_FIELD') : ''\r\n        );\r\n    } else {\r\n        // add name attribute\r\n        attrToggle(element, 'name', true, root.query('GET_NAME'));\r\n\r\n        // remove any validation messages\r\n        const shouldCheckValidity = root.query('GET_CHECK_VALIDITY');\r\n        if (shouldCheckValidity) {\r\n            element.setCustomValidity('');\r\n        }\r\n\r\n        // we only add required if the field has been deemed required\r\n        if (root.query('GET_REQUIRED')) {\r\n            attrToggle(element, 'required', true);\r\n        }\r\n    }\r\n};\r\n\r\nconst updateFieldValidityStatus = ({ root }) => {\r\n    const shouldCheckValidity = root.query('GET_CHECK_VALIDITY');\r\n    if (!shouldCheckValidity) return;\r\n    root.element.setCustomValidity(root.query('GET_LABEL_INVALID_FIELD'));\r\n};\r\n\r\nconst browser = createView({\r\n    tag: 'input',\r\n    name: 'browser',\r\n    ignoreRect: true,\r\n    ignoreRectUpdate: true,\r\n    attributes: {\r\n        type: 'file',\r\n    },\r\n    create: create$a,\r\n    destroy: ({ root }) => {\r\n        root.element.removeEventListener('change', root.ref.handleChange);\r\n    },\r\n    write: createRoute({\r\n        DID_LOAD_ITEM: updateRequiredStatus,\r\n        DID_REMOVE_ITEM: updateRequiredStatus,\r\n        DID_THROW_ITEM_INVALID: updateFieldValidityStatus,\r\n\r\n        DID_SET_DISABLED: toggleDisabled,\r\n        DID_SET_ALLOW_BROWSE: toggleDisabled,\r\n        DID_SET_ALLOW_DIRECTORIES_ONLY: toggleDirectoryFilter,\r\n        DID_SET_ALLOW_MULTIPLE: toggleAllowMultiple,\r\n        DID_SET_ACCEPTED_FILE_TYPES: setAcceptedFileTypes,\r\n        DID_SET_CAPTURE_METHOD: setCaptureMethod,\r\n        DID_SET_REQUIRED: toggleRequired,\r\n    }),\r\n});\r\n\r\nconst Key = {\r\n    ENTER: 13,\r\n    SPACE: 32,\r\n};\r\n\r\nconst create$b = ({ root, props }) => {\r\n    // create the label and link it to the file browser\r\n    const label = createElement$1('label');\r\n    attr(label, 'for', `filepond--browser-${props.id}`);\r\n\r\n    // use for labeling file input (aria-labelledby on file input)\r\n    attr(label, 'id', `filepond--drop-label-${props.id}`);\r\n\r\n    // handle keys\r\n    root.ref.handleKeyDown = e => {\r\n        const isActivationKey = e.keyCode === Key.ENTER || e.keyCode === Key.SPACE;\r\n        if (!isActivationKey) return;\r\n        // stops from triggering the element a second time\r\n        e.preventDefault();\r\n\r\n        // click link (will then in turn activate file input)\r\n        root.ref.label.click();\r\n    };\r\n\r\n    root.ref.handleClick = e => {\r\n        const isLabelClick = e.target === label || label.contains(e.target);\r\n\r\n        // don't want to click twice\r\n        if (isLabelClick) return;\r\n\r\n        // click link (will then in turn activate file input)\r\n        root.ref.label.click();\r\n    };\r\n\r\n    // attach events\r\n    label.addEventListener('keydown', root.ref.handleKeyDown);\r\n    root.element.addEventListener('click', root.ref.handleClick);\r\n\r\n    // update\r\n    updateLabelValue(label, props.caption);\r\n\r\n    // add!\r\n    root.appendChild(label);\r\n    root.ref.label = label;\r\n};\r\n\r\nconst updateLabelValue = (label, value) => {\r\n    label.innerHTML = value;\r\n    const clickable = label.querySelector('.filepond--label-action');\r\n    if (clickable) {\r\n        attr(clickable, 'tabindex', '0');\r\n    }\r\n    return value;\r\n};\r\n\r\nconst dropLabel = createView({\r\n    name: 'drop-label',\r\n    ignoreRect: true,\r\n    create: create$b,\r\n    destroy: ({ root }) => {\r\n        root.ref.label.addEventListener('keydown', root.ref.handleKeyDown);\r\n        root.element.removeEventListener('click', root.ref.handleClick);\r\n    },\r\n    write: createRoute({\r\n        DID_SET_LABEL_IDLE: ({ root, action }) => {\r\n            updateLabelValue(root.ref.label, action.value);\r\n        },\r\n    }),\r\n    mixins: {\r\n        styles: ['opacity', 'translateX', 'translateY'],\r\n        animations: {\r\n            opacity: { type: 'tween', duration: 150 },\r\n            translateX: 'spring',\r\n            translateY: 'spring',\r\n        },\r\n    },\r\n});\r\n\r\nconst blob = createView({\r\n    name: 'drip-blob',\r\n    ignoreRect: true,\r\n    mixins: {\r\n        styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity'],\r\n        animations: {\r\n            scaleX: 'spring',\r\n            scaleY: 'spring',\r\n            translateX: 'spring',\r\n            translateY: 'spring',\r\n            opacity: { type: 'tween', duration: 250 },\r\n        },\r\n    },\r\n});\r\n\r\nconst addBlob = ({ root }) => {\r\n    const centerX = root.rect.element.width * 0.5;\r\n    const centerY = root.rect.element.height * 0.5;\r\n\r\n    root.ref.blob = root.appendChildView(\r\n        root.createChildView(blob, {\r\n            opacity: 0,\r\n            scaleX: 2.5,\r\n            scaleY: 2.5,\r\n            translateX: centerX,\r\n            translateY: centerY,\r\n        })\r\n    );\r\n};\r\n\r\nconst moveBlob = ({ root, action }) => {\r\n    if (!root.ref.blob) {\r\n        addBlob({ root });\r\n        return;\r\n    }\r\n\r\n    root.ref.blob.translateX = action.position.scopeLeft;\r\n    root.ref.blob.translateY = action.position.scopeTop;\r\n    root.ref.blob.scaleX = 1;\r\n    root.ref.blob.scaleY = 1;\r\n    root.ref.blob.opacity = 1;\r\n};\r\n\r\nconst hideBlob = ({ root }) => {\r\n    if (!root.ref.blob) {\r\n        return;\r\n    }\r\n    root.ref.blob.opacity = 0;\r\n};\r\n\r\nconst explodeBlob = ({ root }) => {\r\n    if (!root.ref.blob) {\r\n        return;\r\n    }\r\n    root.ref.blob.scaleX = 2.5;\r\n    root.ref.blob.scaleY = 2.5;\r\n    root.ref.blob.opacity = 0;\r\n};\r\n\r\nconst write$7 = ({ root, props, actions }) => {\r\n    route$4({ root, props, actions });\r\n\r\n    const { blob } = root.ref;\r\n\r\n    if (actions.length === 0 && blob && blob.opacity === 0) {\r\n        root.removeChildView(blob);\r\n        root.ref.blob = null;\r\n    }\r\n};\r\n\r\nconst route$4 = createRoute({\r\n    DID_DRAG: moveBlob,\r\n    DID_DROP: explodeBlob,\r\n    DID_END_DRAG: hideBlob,\r\n});\r\n\r\nconst drip = createView({\r\n    ignoreRect: true,\r\n    ignoreRectUpdate: true,\r\n    name: 'drip',\r\n    write: write$7,\r\n});\r\n\r\nconst setInputFiles = (element, files) => {\r\n    try {\r\n        // Create a DataTransfer instance and add a newly created file\r\n        const dataTransfer = new DataTransfer();\r\n        files.forEach(file => {\r\n            if (file instanceof File) {\r\n                dataTransfer.items.add(file);\r\n            } else {\r\n                dataTransfer.items.add(\r\n                    new File([file], file.name, {\r\n                        type: file.type,\r\n                    })\r\n                );\r\n            }\r\n        });\r\n\r\n        // Assign the DataTransfer files list to the file input\r\n        element.files = dataTransfer.files;\r\n    } catch (err) {\r\n        return false;\r\n    }\r\n    return true;\r\n};\r\n\r\nconst create$c = ({ root }) => {\r\n    root.ref.fields = {};\r\n    const legend = document.createElement('legend');\r\n    legend.textContent = 'Files';\r\n    root.element.appendChild(legend);\r\n};\r\n\r\nconst getField = (root, id) => root.ref.fields[id];\r\n\r\nconst syncFieldPositionsWithItems = root => {\r\n    root.query('GET_ACTIVE_ITEMS').forEach(item => {\r\n        if (!root.ref.fields[item.id]) return;\r\n        root.element.appendChild(root.ref.fields[item.id]);\r\n    });\r\n};\r\n\r\nconst didReorderItems = ({ root }) => syncFieldPositionsWithItems(root);\r\n\r\nconst didAddItem = ({ root, action }) => {\r\n    const fileItem = root.query('GET_ITEM', action.id);\r\n    const isLocalFile = fileItem.origin === FileOrigin.LOCAL;\r\n    const shouldUseFileInput = !isLocalFile && root.query('SHOULD_UPDATE_FILE_INPUT');\r\n    const dataContainer = createElement$1('input');\r\n    dataContainer.type = shouldUseFileInput ? 'file' : 'hidden';\r\n    dataContainer.name = root.query('GET_NAME');\r\n    root.ref.fields[action.id] = dataContainer;\r\n    syncFieldPositionsWithItems(root);\r\n};\r\n\r\nconst didLoadItem$1 = ({ root, action }) => {\r\n    const field = getField(root, action.id);\r\n    if (!field) return;\r\n\r\n    // store server ref in hidden input\r\n    if (action.serverFileReference !== null) field.value = action.serverFileReference;\r\n\r\n    // store file item in file input\r\n    if (!root.query('SHOULD_UPDATE_FILE_INPUT')) return;\r\n\r\n    const fileItem = root.query('GET_ITEM', action.id);\r\n    setInputFiles(field, [fileItem.file]);\r\n};\r\n\r\nconst didPrepareOutput = ({ root, action }) => {\r\n    // this timeout pushes the handler after 'load'\r\n    if (!root.query('SHOULD_UPDATE_FILE_INPUT')) return;\r\n    setTimeout(() => {\r\n        const field = getField(root, action.id);\r\n        if (!field) return;\r\n        setInputFiles(field, [action.file]);\r\n    }, 0);\r\n};\r\n\r\nconst didSetDisabled = ({ root }) => {\r\n    root.element.disabled = root.query('GET_DISABLED');\r\n};\r\n\r\nconst didRemoveItem = ({ root, action }) => {\r\n    const field = getField(root, action.id);\r\n    if (!field) return;\r\n    if (field.parentNode) field.parentNode.removeChild(field);\r\n    delete root.ref.fields[action.id];\r\n};\r\n\r\n// only runs for server files. will refuse to update the value if the field\r\n// is a file field\r\nconst didDefineValue = ({ root, action }) => {\r\n    const field = getField(root, action.id);\r\n    if (!field) return;\r\n    if (action.value === null) {\r\n        // clear field value\r\n        field.removeAttribute('value');\r\n    } else {\r\n        // set field value\r\n        if (field.type != 'file') {\r\n            field.value = action.value;\r\n        }\r\n    }\r\n    syncFieldPositionsWithItems(root);\r\n};\r\n\r\nconst write$8 = createRoute({\r\n    DID_SET_DISABLED: didSetDisabled,\r\n    DID_ADD_ITEM: didAddItem,\r\n    DID_LOAD_ITEM: didLoadItem$1,\r\n    DID_REMOVE_ITEM: didRemoveItem,\r\n    DID_DEFINE_VALUE: didDefineValue,\r\n    DID_PREPARE_OUTPUT: didPrepareOutput,\r\n    DID_REORDER_ITEMS: didReorderItems,\r\n    DID_SORT_ITEMS: didReorderItems,\r\n});\r\n\r\nconst data = createView({\r\n    tag: 'fieldset',\r\n    name: 'data',\r\n    create: create$c,\r\n    write: write$8,\r\n    ignoreRect: true,\r\n});\r\n\r\nconst getRootNode = element => ('getRootNode' in element ? element.getRootNode() : document);\r\n\r\nconst images = ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp', 'svg', 'tiff'];\r\nconst text$1 = ['css', 'csv', 'html', 'txt'];\r\nconst map = {\r\n    zip: 'zip|compressed',\r\n    epub: 'application/epub+zip',\r\n};\r\n\r\nconst guesstimateMimeType = (extension = '') => {\r\n    extension = extension.toLowerCase();\r\n    if (images.includes(extension)) {\r\n        return (\r\n            'image/' + (extension === 'jpg' ? 'jpeg' : extension === 'svg' ? 'svg+xml' : extension)\r\n        );\r\n    }\r\n    if (text$1.includes(extension)) {\r\n        return 'text/' + extension;\r\n    }\r\n\r\n    return map[extension] || '';\r\n};\r\n\r\nconst requestDataTransferItems = dataTransfer =>\r\n    new Promise((resolve, reject) => {\r\n        // try to get links from transfer, if found we'll exit immediately (unless a file is in the dataTransfer as well, this is because Firefox could represent the file as a URL and a file object at the same time)\r\n        const links = getLinks(dataTransfer);\r\n        if (links.length && !hasFiles(dataTransfer)) {\r\n            return resolve(links);\r\n        }\r\n        // try to get files from the transfer\r\n        getFiles(dataTransfer).then(resolve);\r\n    });\r\n\r\n/**\r\n * Test if datatransfer has files\r\n */\r\nconst hasFiles = dataTransfer => {\r\n    if (dataTransfer.files) return dataTransfer.files.length > 0;\r\n    return false;\r\n};\r\n\r\n/**\r\n * Extracts files from a DataTransfer object\r\n */\r\nconst getFiles = dataTransfer =>\r\n    new Promise((resolve, reject) => {\r\n        // get the transfer items as promises\r\n        const promisedFiles = (dataTransfer.items ? Array.from(dataTransfer.items) : [])\r\n\r\n            // only keep file system items (files and directories)\r\n            .filter(item => isFileSystemItem(item))\r\n\r\n            // map each item to promise\r\n            .map(item => getFilesFromItem(item));\r\n\r\n        // if is empty, see if we can extract some info from the files property as a fallback\r\n        if (!promisedFiles.length) {\r\n            // TODO: test for directories (should not be allowed)\r\n            // Use FileReader, problem is that the files property gets lost in the process\r\n            resolve(dataTransfer.files ? Array.from(dataTransfer.files) : []);\r\n            return;\r\n        }\r\n\r\n        // done!\r\n        Promise.all(promisedFiles)\r\n            .then(returnedFileGroups => {\r\n                // flatten groups\r\n                const files = [];\r\n                returnedFileGroups.forEach(group => {\r\n                    files.push.apply(files, group);\r\n                });\r\n\r\n                // done (filter out empty files)!\r\n                resolve(\r\n                    files\r\n                        .filter(file => file)\r\n                        .map(file => {\r\n                            if (!file._relativePath) file._relativePath = file.webkitRelativePath;\r\n                            return file;\r\n                        })\r\n                );\r\n            })\r\n            .catch(console.error);\r\n    });\r\n\r\nconst isFileSystemItem = item => {\r\n    if (isEntry(item)) {\r\n        const entry = getAsEntry(item);\r\n        if (entry) {\r\n            return entry.isFile || entry.isDirectory;\r\n        }\r\n    }\r\n    return item.kind === 'file';\r\n};\r\n\r\nconst getFilesFromItem = item =>\r\n    new Promise((resolve, reject) => {\r\n        if (isDirectoryEntry(item)) {\r\n            getFilesInDirectory(getAsEntry(item))\r\n                .then(resolve)\r\n                .catch(reject);\r\n            return;\r\n        }\r\n\r\n        resolve([item.getAsFile()]);\r\n    });\r\n\r\nconst getFilesInDirectory = entry =>\r\n    new Promise((resolve, reject) => {\r\n        const files = [];\r\n\r\n        // the total entries to read\r\n        let dirCounter = 0;\r\n        let fileCounter = 0;\r\n\r\n        const resolveIfDone = () => {\r\n            if (fileCounter === 0 && dirCounter === 0) {\r\n                resolve(files);\r\n            }\r\n        };\r\n\r\n        // the recursive function\r\n        const readEntries = dirEntry => {\r\n            dirCounter++;\r\n\r\n            const directoryReader = dirEntry.createReader();\r\n\r\n            // directories are returned in batches, we need to process all batches before we're done\r\n            const readBatch = () => {\r\n                directoryReader.readEntries(entries => {\r\n                    if (entries.length === 0) {\r\n                        dirCounter--;\r\n                        resolveIfDone();\r\n                        return;\r\n                    }\r\n\r\n                    entries.forEach(entry => {\r\n                        // recursively read more directories\r\n                        if (entry.isDirectory) {\r\n                            readEntries(entry);\r\n                        } else {\r\n                            // read as file\r\n                            fileCounter++;\r\n\r\n                            entry.file(file => {\r\n                                const correctedFile = correctMissingFileType(file);\r\n                                if (entry.fullPath) correctedFile._relativePath = entry.fullPath;\r\n                                files.push(correctedFile);\r\n                                fileCounter--;\r\n                                resolveIfDone();\r\n                            });\r\n                        }\r\n                    });\r\n\r\n                    // try to get next batch of files\r\n                    readBatch();\r\n                }, reject);\r\n            };\r\n\r\n            // read first batch of files\r\n            readBatch();\r\n        };\r\n\r\n        // go!\r\n        readEntries(entry);\r\n    });\r\n\r\nconst correctMissingFileType = file => {\r\n    if (file.type.length) return file;\r\n    const date = file.lastModifiedDate;\r\n    const name = file.name;\r\n    const type = guesstimateMimeType(getExtensionFromFilename(file.name));\r\n    if (!type.length) return file;\r\n    file = file.slice(0, file.size, type);\r\n    file.name = name;\r\n    file.lastModifiedDate = date;\r\n    return file;\r\n};\r\n\r\nconst isDirectoryEntry = item => isEntry(item) && (getAsEntry(item) || {}).isDirectory;\r\n\r\nconst isEntry = item => 'webkitGetAsEntry' in item;\r\n\r\nconst getAsEntry = item => item.webkitGetAsEntry();\r\n\r\n/**\r\n * Extracts links from a DataTransfer object\r\n */\r\nconst getLinks = dataTransfer => {\r\n    let links = [];\r\n    try {\r\n        // look in meta data property\r\n        links = getLinksFromTransferMetaData(dataTransfer);\r\n        if (links.length) {\r\n            return links;\r\n        }\r\n        links = getLinksFromTransferURLData(dataTransfer);\r\n    } catch (e) {\r\n        // nope nope nope (probably IE trouble)\r\n    }\r\n    return links;\r\n};\r\n\r\nconst getLinksFromTransferURLData = dataTransfer => {\r\n    let data = dataTransfer.getData('url');\r\n    if (typeof data === 'string' && data.length) {\r\n        return [data];\r\n    }\r\n    return [];\r\n};\r\n\r\nconst getLinksFromTransferMetaData = dataTransfer => {\r\n    let data = dataTransfer.getData('text/html');\r\n    if (typeof data === 'string' && data.length) {\r\n        const matches = data.match(/src\\s*=\\s*\"(.+?)\"/);\r\n        if (matches) {\r\n            return [matches[1]];\r\n        }\r\n    }\r\n    return [];\r\n};\r\n\r\nconst dragNDropObservers = [];\r\n\r\nconst eventPosition = e => ({\r\n    pageLeft: e.pageX,\r\n    pageTop: e.pageY,\r\n    scopeLeft: e.offsetX || e.layerX,\r\n    scopeTop: e.offsetY || e.layerY,\r\n});\r\n\r\nconst createDragNDropClient = (element, scopeToObserve, filterElement) => {\r\n    const observer = getDragNDropObserver(scopeToObserve);\r\n\r\n    const client = {\r\n        element,\r\n        filterElement,\r\n        state: null,\r\n        ondrop: () => {},\r\n        onenter: () => {},\r\n        ondrag: () => {},\r\n        onexit: () => {},\r\n        onload: () => {},\r\n        allowdrop: () => {},\r\n    };\r\n\r\n    client.destroy = observer.addListener(client);\r\n\r\n    return client;\r\n};\r\n\r\nconst getDragNDropObserver = element => {\r\n    // see if already exists, if so, return\r\n    const observer = dragNDropObservers.find(item => item.element === element);\r\n    if (observer) {\r\n        return observer;\r\n    }\r\n\r\n    // create new observer, does not yet exist for this element\r\n    const newObserver = createDragNDropObserver(element);\r\n    dragNDropObservers.push(newObserver);\r\n    return newObserver;\r\n};\r\n\r\nconst createDragNDropObserver = element => {\r\n    const clients = [];\r\n\r\n    const routes = {\r\n        dragenter,\r\n        dragover,\r\n        dragleave,\r\n        drop,\r\n    };\r\n\r\n    const handlers = {};\r\n\r\n    forin(routes, (event, createHandler) => {\r\n        handlers[event] = createHandler(element, clients);\r\n        element.addEventListener(event, handlers[event], false);\r\n    });\r\n\r\n    const observer = {\r\n        element,\r\n        addListener: client => {\r\n            // add as client\r\n            clients.push(client);\r\n\r\n            // return removeListener function\r\n            return () => {\r\n                // remove client\r\n                clients.splice(clients.indexOf(client), 1);\r\n\r\n                // if no more clients, clean up observer\r\n                if (clients.length === 0) {\r\n                    dragNDropObservers.splice(dragNDropObservers.indexOf(observer), 1);\r\n\r\n                    forin(routes, event => {\r\n                        element.removeEventListener(event, handlers[event], false);\r\n                    });\r\n                }\r\n            };\r\n        },\r\n    };\r\n\r\n    return observer;\r\n};\r\n\r\nconst elementFromPoint = (root, point) => {\r\n    if (!('elementFromPoint' in root)) {\r\n        root = document;\r\n    }\r\n    return root.elementFromPoint(point.x, point.y);\r\n};\r\n\r\nconst isEventTarget = (e, target) => {\r\n    // get root\r\n    const root = getRootNode(target);\r\n\r\n    // get element at position\r\n    // if root is not actual shadow DOM and does not have elementFromPoint method, use the one on document\r\n    const elementAtPosition = elementFromPoint(root, {\r\n        x: e.pageX - window.pageXOffset,\r\n        y: e.pageY - window.pageYOffset,\r\n    });\r\n\r\n    // test if target is the element or if one of its children is\r\n    return elementAtPosition === target || target.contains(elementAtPosition);\r\n};\r\n\r\nlet initialTarget = null;\r\n\r\nconst setDropEffect = (dataTransfer, effect) => {\r\n    // is in try catch as IE11 will throw error if not\r\n    try {\r\n        dataTransfer.dropEffect = effect;\r\n    } catch (e) {}\r\n};\r\n\r\nconst dragenter = (root, clients) => e => {\r\n    e.preventDefault();\r\n\r\n    initialTarget = e.target;\r\n\r\n    clients.forEach(client => {\r\n        const { element, onenter } = client;\r\n\r\n        if (isEventTarget(e, element)) {\r\n            client.state = 'enter';\r\n\r\n            // fire enter event\r\n            onenter(eventPosition(e));\r\n        }\r\n    });\r\n};\r\n\r\nconst dragover = (root, clients) => e => {\r\n    e.preventDefault();\r\n\r\n    const dataTransfer = e.dataTransfer;\r\n\r\n    requestDataTransferItems(dataTransfer).then(items => {\r\n        let overDropTarget = false;\r\n\r\n        clients.some(client => {\r\n            const { filterElement, element, onenter, onexit, ondrag, allowdrop } = client;\r\n\r\n            // by default we can drop\r\n            setDropEffect(dataTransfer, 'copy');\r\n\r\n            // allow transfer of these items\r\n            const allowsTransfer = allowdrop(items);\r\n\r\n            // only used when can be dropped on page\r\n            if (!allowsTransfer) {\r\n                setDropEffect(dataTransfer, 'none');\r\n                return;\r\n            }\r\n\r\n            // targetting this client\r\n            if (isEventTarget(e, element)) {\r\n                overDropTarget = true;\r\n\r\n                // had no previous state, means we are entering this client\r\n                if (client.state === null) {\r\n                    client.state = 'enter';\r\n                    onenter(eventPosition(e));\r\n                    return;\r\n                }\r\n\r\n                // now over element (no matter if it allows the drop or not)\r\n                client.state = 'over';\r\n\r\n                // needs to allow transfer\r\n                if (filterElement && !allowsTransfer) {\r\n                    setDropEffect(dataTransfer, 'none');\r\n                    return;\r\n                }\r\n\r\n                // dragging\r\n                ondrag(eventPosition(e));\r\n            } else {\r\n                // should be over an element to drop\r\n                if (filterElement && !overDropTarget) {\r\n                    setDropEffect(dataTransfer, 'none');\r\n                }\r\n\r\n                // might have just left this client?\r\n                if (client.state) {\r\n                    client.state = null;\r\n                    onexit(eventPosition(e));\r\n                }\r\n            }\r\n        });\r\n    });\r\n};\r\n\r\nconst drop = (root, clients) => e => {\r\n    e.preventDefault();\r\n\r\n    const dataTransfer = e.dataTransfer;\r\n\r\n    requestDataTransferItems(dataTransfer).then(items => {\r\n        clients.forEach(client => {\r\n            const { filterElement, element, ondrop, onexit, allowdrop } = client;\r\n\r\n            client.state = null;\r\n\r\n            // if we're filtering on element we need to be over the element to drop\r\n            if (filterElement && !isEventTarget(e, element)) return;\r\n\r\n            // no transfer for this client\r\n            if (!allowdrop(items)) return onexit(eventPosition(e));\r\n\r\n            // we can drop these items on this client\r\n            ondrop(eventPosition(e), items);\r\n        });\r\n    });\r\n};\r\n\r\nconst dragleave = (root, clients) => e => {\r\n    if (initialTarget !== e.target) {\r\n        return;\r\n    }\r\n\r\n    clients.forEach(client => {\r\n        const { onexit } = client;\r\n\r\n        client.state = null;\r\n\r\n        onexit(eventPosition(e));\r\n    });\r\n};\r\n\r\nconst createHopper = (scope, validateItems, options) => {\r\n    // is now hopper scope\r\n    scope.classList.add('filepond--hopper');\r\n\r\n    // shortcuts\r\n    const { catchesDropsOnPage, requiresDropOnElement, filterItems = items => items } = options;\r\n\r\n    // create a dnd client\r\n    const client = createDragNDropClient(\r\n        scope,\r\n        catchesDropsOnPage ? document.documentElement : scope,\r\n        requiresDropOnElement\r\n    );\r\n\r\n    // current client state\r\n    let lastState = '';\r\n    let currentState = '';\r\n\r\n    // determines if a file may be dropped\r\n    client.allowdrop = items => {\r\n        // TODO: if we can, throw error to indicate the items cannot by dropped\r\n\r\n        return validateItems(filterItems(items));\r\n    };\r\n\r\n    client.ondrop = (position, items) => {\r\n        const filteredItems = filterItems(items);\r\n\r\n        if (!validateItems(filteredItems)) {\r\n            api.ondragend(position);\r\n            return;\r\n        }\r\n\r\n        currentState = 'drag-drop';\r\n\r\n        api.onload(filteredItems, position);\r\n    };\r\n\r\n    client.ondrag = position => {\r\n        api.ondrag(position);\r\n    };\r\n\r\n    client.onenter = position => {\r\n        currentState = 'drag-over';\r\n\r\n        api.ondragstart(position);\r\n    };\r\n\r\n    client.onexit = position => {\r\n        currentState = 'drag-exit';\r\n\r\n        api.ondragend(position);\r\n    };\r\n\r\n    const api = {\r\n        updateHopperState: () => {\r\n            if (lastState !== currentState) {\r\n                scope.dataset.hopperState = currentState;\r\n                lastState = currentState;\r\n            }\r\n        },\r\n        onload: () => {},\r\n        ondragstart: () => {},\r\n        ondrag: () => {},\r\n        ondragend: () => {},\r\n        destroy: () => {\r\n            // destroy client\r\n            client.destroy();\r\n        },\r\n    };\r\n\r\n    return api;\r\n};\r\n\r\nlet listening = false;\r\nconst listeners$1 = [];\r\n\r\nconst handlePaste = e => {\r\n    // if is pasting in input or textarea and the target is outside of a filepond scope, ignore\r\n    const activeEl = document.activeElement;\r\n    const isActiveElementEditable =\r\n        activeEl &&\r\n        (/textarea|input/i.test(activeEl.nodeName) ||\r\n            activeEl.getAttribute('contenteditable') === 'true' ||\r\n            activeEl.getAttribute('contenteditable') === '');\r\n\r\n    if (isActiveElementEditable) {\r\n        // test textarea or input is contained in filepond root\r\n        let inScope = false;\r\n        let element = activeEl;\r\n        while (element !== document.body) {\r\n            if (element.classList.contains('filepond--root')) {\r\n                inScope = true;\r\n                break;\r\n            }\r\n            element = element.parentNode;\r\n        }\r\n\r\n        if (!inScope) return;\r\n    }\r\n\r\n    requestDataTransferItems(e.clipboardData).then(files => {\r\n        // no files received\r\n        if (!files.length) {\r\n            return;\r\n        }\r\n\r\n        // notify listeners of received files\r\n        listeners$1.forEach(listener => listener(files));\r\n    });\r\n};\r\n\r\nconst listen = cb => {\r\n    // can't add twice\r\n    if (listeners$1.includes(cb)) {\r\n        return;\r\n    }\r\n\r\n    // add initial listener\r\n    listeners$1.push(cb);\r\n\r\n    // setup paste listener for entire page\r\n    if (listening) {\r\n        return;\r\n    }\r\n\r\n    listening = true;\r\n    document.addEventListener('paste', handlePaste);\r\n};\r\n\r\nconst unlisten = listener => {\r\n    arrayRemove(listeners$1, listeners$1.indexOf(listener));\r\n\r\n    // clean up\r\n    if (listeners$1.length === 0) {\r\n        document.removeEventListener('paste', handlePaste);\r\n        listening = false;\r\n    }\r\n};\r\n\r\nconst createPaster = () => {\r\n    const cb = files => {\r\n        api.onload(files);\r\n    };\r\n\r\n    const api = {\r\n        destroy: () => {\r\n            unlisten(cb);\r\n        },\r\n        onload: () => {},\r\n    };\r\n\r\n    listen(cb);\r\n\r\n    return api;\r\n};\r\n\r\n/**\r\n * Creates the file view\r\n */\r\nconst create$d = ({ root, props }) => {\r\n    root.element.id = `filepond--assistant-${props.id}`;\r\n    attr(root.element, 'role', 'alert');\r\n    attr(root.element, 'aria-live', 'polite');\r\n    attr(root.element, 'aria-relevant', 'additions');\r\n};\r\n\r\nlet addFilesNotificationTimeout = null;\r\nlet notificationClearTimeout = null;\r\n\r\nconst filenames = [];\r\n\r\nconst assist = (root, message) => {\r\n    root.element.textContent = message;\r\n};\r\n\r\nconst clear$1 = root => {\r\n    root.element.textContent = '';\r\n};\r\n\r\nconst listModified = (root, filename, label) => {\r\n    const total = root.query('GET_TOTAL_ITEMS');\r\n    assist(\r\n        root,\r\n        `${label} ${filename}, ${total} ${\r\n            total === 1\r\n                ? root.query('GET_LABEL_FILE_COUNT_SINGULAR')\r\n                : root.query('GET_LABEL_FILE_COUNT_PLURAL')\r\n        }`\r\n    );\r\n\r\n    // clear group after set amount of time so the status is not read twice\r\n    clearTimeout(notificationClearTimeout);\r\n    notificationClearTimeout = setTimeout(() => {\r\n        clear$1(root);\r\n    }, 1500);\r\n};\r\n\r\nconst isUsingFilePond = root => root.element.parentNode.contains(document.activeElement);\r\n\r\nconst itemAdded = ({ root, action }) => {\r\n    if (!isUsingFilePond(root)) {\r\n        return;\r\n    }\r\n\r\n    root.element.textContent = '';\r\n    const item = root.query('GET_ITEM', action.id);\r\n    filenames.push(item.filename);\r\n\r\n    clearTimeout(addFilesNotificationTimeout);\r\n    addFilesNotificationTimeout = setTimeout(() => {\r\n        listModified(root, filenames.join(', '), root.query('GET_LABEL_FILE_ADDED'));\r\n        filenames.length = 0;\r\n    }, 750);\r\n};\r\n\r\nconst itemRemoved = ({ root, action }) => {\r\n    if (!isUsingFilePond(root)) {\r\n        return;\r\n    }\r\n\r\n    const item = action.item;\r\n    listModified(root, item.filename, root.query('GET_LABEL_FILE_REMOVED'));\r\n};\r\n\r\nconst itemProcessed = ({ root, action }) => {\r\n    // will also notify the user when FilePond is not being used, as the user might be occupied with other activities while uploading a file\r\n\r\n    const item = root.query('GET_ITEM', action.id);\r\n    const filename = item.filename;\r\n    const label = root.query('GET_LABEL_FILE_PROCESSING_COMPLETE');\r\n\r\n    assist(root, `${filename} ${label}`);\r\n};\r\n\r\nconst itemProcessedUndo = ({ root, action }) => {\r\n    const item = root.query('GET_ITEM', action.id);\r\n    const filename = item.filename;\r\n    const label = root.query('GET_LABEL_FILE_PROCESSING_ABORTED');\r\n\r\n    assist(root, `${filename} ${label}`);\r\n};\r\n\r\nconst itemError = ({ root, action }) => {\r\n    const item = root.query('GET_ITEM', action.id);\r\n    const filename = item.filename;\r\n\r\n    // will also notify the user when FilePond is not being used, as the user might be occupied with other activities while uploading a file\r\n\r\n    assist(root, `${action.status.main} ${filename} ${action.status.sub}`);\r\n};\r\n\r\nconst assistant = createView({\r\n    create: create$d,\r\n    ignoreRect: true,\r\n    ignoreRectUpdate: true,\r\n    write: createRoute({\r\n        DID_LOAD_ITEM: itemAdded,\r\n        DID_REMOVE_ITEM: itemRemoved,\r\n        DID_COMPLETE_ITEM_PROCESSING: itemProcessed,\r\n\r\n        DID_ABORT_ITEM_PROCESSING: itemProcessedUndo,\r\n        DID_REVERT_ITEM_PROCESSING: itemProcessedUndo,\r\n\r\n        DID_THROW_ITEM_REMOVE_ERROR: itemError,\r\n        DID_THROW_ITEM_LOAD_ERROR: itemError,\r\n        DID_THROW_ITEM_INVALID: itemError,\r\n        DID_THROW_ITEM_PROCESSING_ERROR: itemError,\r\n    }),\r\n    tag: 'span',\r\n    name: 'assistant',\r\n});\r\n\r\nconst toCamels = (string, separator = '-') =>\r\n    string.replace(new RegExp(`${separator}.`, 'g'), sub => sub.charAt(1).toUpperCase());\r\n\r\nconst debounce = (func, interval = 16, immidiateOnly = true) => {\r\n    let last = Date.now();\r\n    let timeout = null;\r\n\r\n    return (...args) => {\r\n        clearTimeout(timeout);\r\n\r\n        const dist = Date.now() - last;\r\n\r\n        const fn = () => {\r\n            last = Date.now();\r\n            func(...args);\r\n        };\r\n\r\n        if (dist < interval) {\r\n            // we need to delay by the difference between interval and dist\r\n            // for example: if distance is 10 ms and interval is 16 ms,\r\n            // we need to wait an additional 6ms before calling the function)\r\n            if (!immidiateOnly) {\r\n                timeout = setTimeout(fn, interval - dist);\r\n            }\r\n        } else {\r\n            // go!\r\n            fn();\r\n        }\r\n    };\r\n};\r\n\r\nconst MAX_FILES_LIMIT = 1000000;\r\n\r\nconst prevent = e => e.preventDefault();\r\n\r\nconst create$e = ({ root, props }) => {\r\n    // Add id\r\n    const id = root.query('GET_ID');\r\n    if (id) {\r\n        root.element.id = id;\r\n    }\r\n\r\n    // Add className\r\n    const className = root.query('GET_CLASS_NAME');\r\n    if (className) {\r\n        className\r\n            .split(' ')\r\n            .filter(name => name.length)\r\n            .forEach(name => {\r\n                root.element.classList.add(name);\r\n            });\r\n    }\r\n\r\n    // Field label\r\n    root.ref.label = root.appendChildView(\r\n        root.createChildView(dropLabel, {\r\n            ...props,\r\n            translateY: null,\r\n            caption: root.query('GET_LABEL_IDLE'),\r\n        })\r\n    );\r\n\r\n    // List of items\r\n    root.ref.list = root.appendChildView(root.createChildView(listScroller, { translateY: null }));\r\n\r\n    // Background panel\r\n    root.ref.panel = root.appendChildView(root.createChildView(panel, { name: 'panel-root' }));\r\n\r\n    // Assistant notifies assistive tech when content changes\r\n    root.ref.assistant = root.appendChildView(root.createChildView(assistant, { ...props }));\r\n\r\n    // Data\r\n    root.ref.data = root.appendChildView(root.createChildView(data, { ...props }));\r\n\r\n    // Measure (tests if fixed height was set)\r\n    // DOCTYPE needs to be set for this to work\r\n    root.ref.measure = createElement$1('div');\r\n    root.ref.measure.style.height = '100%';\r\n    root.element.appendChild(root.ref.measure);\r\n\r\n    // information on the root height or fixed height status\r\n    root.ref.bounds = null;\r\n\r\n    // apply initial style properties\r\n    root.query('GET_STYLES')\r\n        .filter(style => !isEmpty(style.value))\r\n        .map(({ name, value }) => {\r\n            root.element.dataset[name] = value;\r\n        });\r\n\r\n    // determine if width changed\r\n    root.ref.widthPrevious = null;\r\n    root.ref.widthUpdated = debounce(() => {\r\n        root.ref.updateHistory = [];\r\n        root.dispatch('DID_RESIZE_ROOT');\r\n    }, 250);\r\n\r\n    // history of updates\r\n    root.ref.previousAspectRatio = null;\r\n    root.ref.updateHistory = [];\r\n\r\n    // prevent scrolling and zooming on iOS (only if supports pointer events, for then we can enable reorder)\r\n    const canHover = window.matchMedia('(pointer: fine) and (hover: hover)').matches;\r\n    const hasPointerEvents = 'PointerEvent' in window;\r\n    if (root.query('GET_ALLOW_REORDER') && hasPointerEvents && !canHover) {\r\n        root.element.addEventListener('touchmove', prevent, { passive: false });\r\n        root.element.addEventListener('gesturestart', prevent);\r\n    }\r\n\r\n    // add credits\r\n    const credits = root.query('GET_CREDITS');\r\n    const hasCredits = credits.length === 2;\r\n    if (hasCredits) {\r\n        const frag = document.createElement('a');\r\n        frag.className = 'filepond--credits';\r\n        frag.href = credits[0];\r\n        frag.tabIndex = -1;\r\n        frag.target = '_blank';\r\n        frag.rel = 'noopener noreferrer nofollow';\r\n        frag.textContent = credits[1];\r\n        root.element.appendChild(frag);\r\n        root.ref.credits = frag;\r\n    }\r\n};\r\n\r\nconst write$9 = ({ root, props, actions }) => {\r\n    // route actions\r\n    route$5({ root, props, actions });\r\n\r\n    // apply style properties\r\n    actions\r\n        .filter(action => /^DID_SET_STYLE_/.test(action.type))\r\n        .filter(action => !isEmpty(action.data.value))\r\n        .map(({ type, data }) => {\r\n            const name = toCamels(type.substring(8).toLowerCase(), '_');\r\n            root.element.dataset[name] = data.value;\r\n            root.invalidateLayout();\r\n        });\r\n\r\n    if (root.rect.element.hidden) return;\r\n\r\n    if (root.rect.element.width !== root.ref.widthPrevious) {\r\n        root.ref.widthPrevious = root.rect.element.width;\r\n        root.ref.widthUpdated();\r\n    }\r\n\r\n    // get box bounds, we do this only once\r\n    let bounds = root.ref.bounds;\r\n    if (!bounds) {\r\n        bounds = root.ref.bounds = calculateRootBoundingBoxHeight(root);\r\n\r\n        // destroy measure element\r\n        root.element.removeChild(root.ref.measure);\r\n        root.ref.measure = null;\r\n    }\r\n\r\n    // get quick references to various high level parts of the upload tool\r\n    const { hopper, label, list, panel } = root.ref;\r\n\r\n    // sets correct state to hopper scope\r\n    if (hopper) {\r\n        hopper.updateHopperState();\r\n    }\r\n\r\n    // bool to indicate if we're full or not\r\n    const aspectRatio = root.query('GET_PANEL_ASPECT_RATIO');\r\n    const isMultiItem = root.query('GET_ALLOW_MULTIPLE');\r\n    const totalItems = root.query('GET_TOTAL_ITEMS');\r\n    const maxItems = isMultiItem ? root.query('GET_MAX_FILES') || MAX_FILES_LIMIT : 1;\r\n    const atMaxCapacity = totalItems === maxItems;\r\n\r\n    // action used to add item\r\n    const addAction = actions.find(action => action.type === 'DID_ADD_ITEM');\r\n\r\n    // if reached max capacity and we've just reached it\r\n    if (atMaxCapacity && addAction) {\r\n        // get interaction type\r\n        const interactionMethod = addAction.data.interactionMethod;\r\n\r\n        // hide label\r\n        label.opacity = 0;\r\n\r\n        if (isMultiItem) {\r\n            label.translateY = -40;\r\n        } else {\r\n            if (interactionMethod === InteractionMethod.API) {\r\n                label.translateX = 40;\r\n            } else if (interactionMethod === InteractionMethod.BROWSE) {\r\n                label.translateY = 40;\r\n            } else {\r\n                label.translateY = 30;\r\n            }\r\n        }\r\n    } else if (!atMaxCapacity) {\r\n        label.opacity = 1;\r\n        label.translateX = 0;\r\n        label.translateY = 0;\r\n    }\r\n\r\n    const listItemMargin = calculateListItemMargin(root);\r\n\r\n    const listHeight = calculateListHeight(root);\r\n\r\n    const labelHeight = label.rect.element.height;\r\n    const currentLabelHeight = !isMultiItem || atMaxCapacity ? 0 : labelHeight;\r\n\r\n    const listMarginTop = atMaxCapacity ? list.rect.element.marginTop : 0;\r\n    const listMarginBottom = totalItems === 0 ? 0 : list.rect.element.marginBottom;\r\n\r\n    const visualHeight = currentLabelHeight + listMarginTop + listHeight.visual + listMarginBottom;\r\n    const boundsHeight = currentLabelHeight + listMarginTop + listHeight.bounds + listMarginBottom;\r\n\r\n    // link list to label bottom position\r\n    list.translateY =\r\n        Math.max(0, currentLabelHeight - list.rect.element.marginTop) - listItemMargin.top;\r\n\r\n    if (aspectRatio) {\r\n        // fixed aspect ratio\r\n\r\n        // calculate height based on width\r\n        const width = root.rect.element.width;\r\n        const height = width * aspectRatio;\r\n\r\n        // clear history if aspect ratio has changed\r\n        if (aspectRatio !== root.ref.previousAspectRatio) {\r\n            root.ref.previousAspectRatio = aspectRatio;\r\n            root.ref.updateHistory = [];\r\n        }\r\n\r\n        // remember this width\r\n        const history = root.ref.updateHistory;\r\n        history.push(width);\r\n\r\n        const MAX_BOUNCES = 2;\r\n        if (history.length > MAX_BOUNCES * 2) {\r\n            const l = history.length;\r\n            const bottom = l - 10;\r\n            let bounces = 0;\r\n            for (let i = l; i >= bottom; i--) {\r\n                if (history[i] === history[i - 2]) {\r\n                    bounces++;\r\n                }\r\n\r\n                if (bounces >= MAX_BOUNCES) {\r\n                    // dont adjust height\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n\r\n        // fix height of panel so it adheres to aspect ratio\r\n        panel.scalable = false;\r\n        panel.height = height;\r\n\r\n        // available height for list\r\n        const listAvailableHeight =\r\n            // the height of the panel minus the label height\r\n            height -\r\n            currentLabelHeight -\r\n            // the room we leave open between the end of the list and the panel bottom\r\n            (listMarginBottom - listItemMargin.bottom) -\r\n            // if we're full we need to leave some room between the top of the panel and the list\r\n            (atMaxCapacity ? listMarginTop : 0);\r\n\r\n        if (listHeight.visual > listAvailableHeight) {\r\n            list.overflow = listAvailableHeight;\r\n        } else {\r\n            list.overflow = null;\r\n        }\r\n\r\n        // set container bounds (so pushes siblings downwards)\r\n        root.height = height;\r\n    } else if (bounds.fixedHeight) {\r\n        // fixed height\r\n\r\n        // fix height of panel\r\n        panel.scalable = false;\r\n\r\n        // available height for list\r\n        const listAvailableHeight =\r\n            // the height of the panel minus the label height\r\n            bounds.fixedHeight -\r\n            currentLabelHeight -\r\n            // the room we leave open between the end of the list and the panel bottom\r\n            (listMarginBottom - listItemMargin.bottom) -\r\n            // if we're full we need to leave some room between the top of the panel and the list\r\n            (atMaxCapacity ? listMarginTop : 0);\r\n\r\n        // set list height\r\n        if (listHeight.visual > listAvailableHeight) {\r\n            list.overflow = listAvailableHeight;\r\n        } else {\r\n            list.overflow = null;\r\n        }\r\n\r\n        // no need to set container bounds as these are handles by CSS fixed height\r\n    } else if (bounds.cappedHeight) {\r\n        // max-height\r\n\r\n        // not a fixed height panel\r\n        const isCappedHeight = visualHeight >= bounds.cappedHeight;\r\n        const panelHeight = Math.min(bounds.cappedHeight, visualHeight);\r\n        panel.scalable = true;\r\n        panel.height = isCappedHeight\r\n            ? panelHeight\r\n            : panelHeight - listItemMargin.top - listItemMargin.bottom;\r\n\r\n        // available height for list\r\n        const listAvailableHeight =\r\n            // the height of the panel minus the label height\r\n            panelHeight -\r\n            currentLabelHeight -\r\n            // the room we leave open between the end of the list and the panel bottom\r\n            (listMarginBottom - listItemMargin.bottom) -\r\n            // if we're full we need to leave some room between the top of the panel and the list\r\n            (atMaxCapacity ? listMarginTop : 0);\r\n\r\n        // set list height (if is overflowing)\r\n        if (visualHeight > bounds.cappedHeight && listHeight.visual > listAvailableHeight) {\r\n            list.overflow = listAvailableHeight;\r\n        } else {\r\n            list.overflow = null;\r\n        }\r\n\r\n        // set container bounds (so pushes siblings downwards)\r\n        root.height = Math.min(\r\n            bounds.cappedHeight,\r\n            boundsHeight - listItemMargin.top - listItemMargin.bottom\r\n        );\r\n    } else {\r\n        // flexible height\r\n\r\n        // not a fixed height panel\r\n        const itemMargin = totalItems > 0 ? listItemMargin.top + listItemMargin.bottom : 0;\r\n        panel.scalable = true;\r\n        panel.height = Math.max(labelHeight, visualHeight - itemMargin);\r\n\r\n        // set container bounds (so pushes siblings downwards)\r\n        root.height = Math.max(labelHeight, boundsHeight - itemMargin);\r\n    }\r\n\r\n    // move credits to bottom\r\n    if (root.ref.credits && panel.heightCurrent)\r\n        root.ref.credits.style.transform = `translateY(${panel.heightCurrent}px)`;\r\n};\r\n\r\nconst calculateListItemMargin = root => {\r\n    const item = root.ref.list.childViews[0].childViews[0];\r\n    return item\r\n        ? {\r\n              top: item.rect.element.marginTop,\r\n              bottom: item.rect.element.marginBottom,\r\n          }\r\n        : {\r\n              top: 0,\r\n              bottom: 0,\r\n          };\r\n};\r\n\r\nconst calculateListHeight = root => {\r\n    let visual = 0;\r\n    let bounds = 0;\r\n\r\n    // get file list reference\r\n    const scrollList = root.ref.list;\r\n    const itemList = scrollList.childViews[0];\r\n    const visibleChildren = itemList.childViews.filter(child => child.rect.element.height);\r\n    const children = root\r\n        .query('GET_ACTIVE_ITEMS')\r\n        .map(item => visibleChildren.find(child => child.id === item.id))\r\n        .filter(item => item);\r\n\r\n    // no children, done!\r\n    if (children.length === 0) return { visual, bounds };\r\n\r\n    const horizontalSpace = itemList.rect.element.width;\r\n    const dragIndex = getItemIndexByPosition(itemList, children, scrollList.dragCoordinates);\r\n\r\n    const childRect = children[0].rect.element;\r\n\r\n    const itemVerticalMargin = childRect.marginTop + childRect.marginBottom;\r\n    const itemHorizontalMargin = childRect.marginLeft + childRect.marginRight;\r\n\r\n    const itemWidth = childRect.width + itemHorizontalMargin;\r\n    const itemHeight = childRect.height + itemVerticalMargin;\r\n\r\n    const newItem = typeof dragIndex !== 'undefined' && dragIndex >= 0 ? 1 : 0;\r\n    const removedItem = children.find(child => child.markedForRemoval && child.opacity < 0.45)\r\n        ? -1\r\n        : 0;\r\n    const verticalItemCount = children.length + newItem + removedItem;\r\n    const itemsPerRow = getItemsPerRow(horizontalSpace, itemWidth);\r\n\r\n    // stack\r\n    if (itemsPerRow === 1) {\r\n        children.forEach(item => {\r\n            const height = item.rect.element.height + itemVerticalMargin;\r\n            bounds += height;\r\n            visual += height * item.opacity;\r\n        });\r\n    }\r\n    // grid\r\n    else {\r\n        bounds = Math.ceil(verticalItemCount / itemsPerRow) * itemHeight;\r\n        visual = bounds;\r\n    }\r\n\r\n    return { visual, bounds };\r\n};\r\n\r\nconst calculateRootBoundingBoxHeight = root => {\r\n    const height = root.ref.measureHeight || null;\r\n    const cappedHeight = parseInt(root.style.maxHeight, 10) || null;\r\n    const fixedHeight = height === 0 ? null : height;\r\n\r\n    return {\r\n        cappedHeight,\r\n        fixedHeight,\r\n    };\r\n};\r\n\r\nconst exceedsMaxFiles = (root, items) => {\r\n    const allowReplace = root.query('GET_ALLOW_REPLACE');\r\n    const allowMultiple = root.query('GET_ALLOW_MULTIPLE');\r\n    const totalItems = root.query('GET_TOTAL_ITEMS');\r\n    let maxItems = root.query('GET_MAX_FILES');\r\n\r\n    // total amount of items being dragged\r\n    const totalBrowseItems = items.length;\r\n\r\n    // if does not allow multiple items and dragging more than one item\r\n    if (!allowMultiple && totalBrowseItems > 1) {\r\n        root.dispatch('DID_THROW_MAX_FILES', {\r\n            source: items,\r\n            error: createResponse('warning', 0, 'Max files'),\r\n        });\r\n        return true;\r\n    }\r\n\r\n    // limit max items to one if not allowed to drop multiple items\r\n    maxItems = allowMultiple ? maxItems : 1;\r\n\r\n    if (!allowMultiple && allowReplace) {\r\n        // There is only one item, so there is room to replace or add an item\r\n        return false;\r\n    }\r\n\r\n    // no more room?\r\n    const hasMaxItems = isInt(maxItems);\r\n    if (hasMaxItems && totalItems + totalBrowseItems > maxItems) {\r\n        root.dispatch('DID_THROW_MAX_FILES', {\r\n            source: items,\r\n            error: createResponse('warning', 0, 'Max files'),\r\n        });\r\n        return true;\r\n    }\r\n\r\n    return false;\r\n};\r\n\r\nconst getDragIndex = (list, children, position) => {\r\n    const itemList = list.childViews[0];\r\n    return getItemIndexByPosition(itemList, children, {\r\n        left: position.scopeLeft - itemList.rect.element.left,\r\n        top:\r\n            position.scopeTop -\r\n            (list.rect.outer.top + list.rect.element.marginTop + list.rect.element.scrollTop),\r\n    });\r\n};\r\n\r\n/**\r\n * Enable or disable file drop functionality\r\n */\r\nconst toggleDrop = root => {\r\n    const isAllowed = root.query('GET_ALLOW_DROP');\r\n    const isDisabled = root.query('GET_DISABLED');\r\n    const enabled = isAllowed && !isDisabled;\r\n    if (enabled && !root.ref.hopper) {\r\n        const hopper = createHopper(\r\n            root.element,\r\n            items => {\r\n                // allow quick validation of dropped items\r\n                const beforeDropFile = root.query('GET_BEFORE_DROP_FILE') || (() => true);\r\n\r\n                // all items should be validated by all filters as valid\r\n                const dropValidation = root.query('GET_DROP_VALIDATION');\r\n                return dropValidation\r\n                    ? items.every(\r\n                          item =>\r\n                              applyFilters('ALLOW_HOPPER_ITEM', item, {\r\n                                  query: root.query,\r\n                              }).every(result => result === true) && beforeDropFile(item)\r\n                      )\r\n                    : true;\r\n            },\r\n            {\r\n                filterItems: items => {\r\n                    const ignoredFiles = root.query('GET_IGNORED_FILES');\r\n                    return items.filter(item => {\r\n                        if (isFile(item)) {\r\n                            return !ignoredFiles.includes(item.name.toLowerCase());\r\n                        }\r\n                        return true;\r\n                    });\r\n                },\r\n                catchesDropsOnPage: root.query('GET_DROP_ON_PAGE'),\r\n                requiresDropOnElement: root.query('GET_DROP_ON_ELEMENT'),\r\n            }\r\n        );\r\n\r\n        hopper.onload = (items, position) => {\r\n            // get item children elements and sort based on list sort\r\n            const list = root.ref.list.childViews[0];\r\n            const visibleChildren = list.childViews.filter(child => child.rect.element.height);\r\n            const children = root\r\n                .query('GET_ACTIVE_ITEMS')\r\n                .map(item => visibleChildren.find(child => child.id === item.id))\r\n                .filter(item => item);\r\n\r\n            applyFilterChain('ADD_ITEMS', items, { dispatch: root.dispatch }).then(queue => {\r\n                // these files don't fit so stop here\r\n                if (exceedsMaxFiles(root, queue)) return false;\r\n\r\n                // go\r\n                root.dispatch('ADD_ITEMS', {\r\n                    items: queue,\r\n                    index: getDragIndex(root.ref.list, children, position),\r\n                    interactionMethod: InteractionMethod.DROP,\r\n                });\r\n            });\r\n\r\n            root.dispatch('DID_DROP', { position });\r\n\r\n            root.dispatch('DID_END_DRAG', { position });\r\n        };\r\n\r\n        hopper.ondragstart = position => {\r\n            root.dispatch('DID_START_DRAG', { position });\r\n        };\r\n\r\n        hopper.ondrag = debounce(position => {\r\n            root.dispatch('DID_DRAG', { position });\r\n        });\r\n\r\n        hopper.ondragend = position => {\r\n            root.dispatch('DID_END_DRAG', { position });\r\n        };\r\n\r\n        root.ref.hopper = hopper;\r\n\r\n        root.ref.drip = root.appendChildView(root.createChildView(drip));\r\n    } else if (!enabled && root.ref.hopper) {\r\n        root.ref.hopper.destroy();\r\n        root.ref.hopper = null;\r\n        root.removeChildView(root.ref.drip);\r\n    }\r\n};\r\n\r\n/**\r\n * Enable or disable browse functionality\r\n */\r\nconst toggleBrowse = (root, props) => {\r\n    const isAllowed = root.query('GET_ALLOW_BROWSE');\r\n    const isDisabled = root.query('GET_DISABLED');\r\n    const enabled = isAllowed && !isDisabled;\r\n    if (enabled && !root.ref.browser) {\r\n        root.ref.browser = root.appendChildView(\r\n            root.createChildView(browser, {\r\n                ...props,\r\n                onload: items => {\r\n                    applyFilterChain('ADD_ITEMS', items, {\r\n                        dispatch: root.dispatch,\r\n                    }).then(queue => {\r\n                        // these files don't fit so stop here\r\n                        if (exceedsMaxFiles(root, queue)) return false;\r\n\r\n                        // add items!\r\n                        root.dispatch('ADD_ITEMS', {\r\n                            items: queue,\r\n                            index: -1,\r\n                            interactionMethod: InteractionMethod.BROWSE,\r\n                        });\r\n                    });\r\n                },\r\n            }),\r\n            0\r\n        );\r\n    } else if (!enabled && root.ref.browser) {\r\n        root.removeChildView(root.ref.browser);\r\n        root.ref.browser = null;\r\n    }\r\n};\r\n\r\n/**\r\n * Enable or disable paste functionality\r\n */\r\nconst togglePaste = root => {\r\n    const isAllowed = root.query('GET_ALLOW_PASTE');\r\n    const isDisabled = root.query('GET_DISABLED');\r\n    const enabled = isAllowed && !isDisabled;\r\n    if (enabled && !root.ref.paster) {\r\n        root.ref.paster = createPaster();\r\n        root.ref.paster.onload = items => {\r\n            applyFilterChain('ADD_ITEMS', items, { dispatch: root.dispatch }).then(queue => {\r\n                // these files don't fit so stop here\r\n                if (exceedsMaxFiles(root, queue)) return false;\r\n\r\n                // add items!\r\n                root.dispatch('ADD_ITEMS', {\r\n                    items: queue,\r\n                    index: -1,\r\n                    interactionMethod: InteractionMethod.PASTE,\r\n                });\r\n            });\r\n        };\r\n    } else if (!enabled && root.ref.paster) {\r\n        root.ref.paster.destroy();\r\n        root.ref.paster = null;\r\n    }\r\n};\r\n\r\n/**\r\n * Route actions\r\n */\r\nconst route$5 = createRoute({\r\n    DID_SET_ALLOW_BROWSE: ({ root, props }) => {\r\n        toggleBrowse(root, props);\r\n    },\r\n    DID_SET_ALLOW_DROP: ({ root }) => {\r\n        toggleDrop(root);\r\n    },\r\n    DID_SET_ALLOW_PASTE: ({ root }) => {\r\n        togglePaste(root);\r\n    },\r\n    DID_SET_DISABLED: ({ root, props }) => {\r\n        toggleDrop(root);\r\n        togglePaste(root);\r\n        toggleBrowse(root, props);\r\n        const isDisabled = root.query('GET_DISABLED');\r\n        if (isDisabled) {\r\n            root.element.dataset.disabled = 'disabled';\r\n        } else {\r\n            // delete root.element.dataset.disabled; <= this does not work on iOS 10\r\n            root.element.removeAttribute('data-disabled');\r\n        }\r\n    },\r\n});\r\n\r\nconst root = createView({\r\n    name: 'root',\r\n    read: ({ root }) => {\r\n        if (root.ref.measure) {\r\n            root.ref.measureHeight = root.ref.measure.offsetHeight;\r\n        }\r\n    },\r\n    create: create$e,\r\n    write: write$9,\r\n    destroy: ({ root }) => {\r\n        if (root.ref.paster) {\r\n            root.ref.paster.destroy();\r\n        }\r\n        if (root.ref.hopper) {\r\n            root.ref.hopper.destroy();\r\n        }\r\n        root.element.removeEventListener('touchmove', prevent);\r\n        root.element.removeEventListener('gesturestart', prevent);\r\n    },\r\n    mixins: {\r\n        styles: ['height'],\r\n    },\r\n});\r\n\r\n// creates the app\r\nconst createApp = (initialOptions = {}) => {\r\n    // let element\r\n    let originalElement = null;\r\n\r\n    // get default options\r\n    const defaultOptions = getOptions();\r\n\r\n    // create the data store, this will contain all our app info\r\n    const store = createStore(\r\n        // initial state (should be serializable)\r\n        createInitialState(defaultOptions),\r\n\r\n        // queries\r\n        [queries, createOptionQueries(defaultOptions)],\r\n\r\n        // action handlers\r\n        [actions, createOptionActions(defaultOptions)]\r\n    );\r\n\r\n    // set initial options\r\n    store.dispatch('SET_OPTIONS', { options: initialOptions });\r\n\r\n    // kick thread if visibility changes\r\n    const visibilityHandler = () => {\r\n        if (document.hidden) return;\r\n        store.dispatch('KICK');\r\n    };\r\n    document.addEventListener('visibilitychange', visibilityHandler);\r\n\r\n    // re-render on window resize start and finish\r\n    let resizeDoneTimer = null;\r\n    let isResizing = false;\r\n    let isResizingHorizontally = false;\r\n    let initialWindowWidth = null;\r\n    let currentWindowWidth = null;\r\n    const resizeHandler = () => {\r\n        if (!isResizing) {\r\n            isResizing = true;\r\n        }\r\n        clearTimeout(resizeDoneTimer);\r\n        resizeDoneTimer = setTimeout(() => {\r\n            isResizing = false;\r\n            initialWindowWidth = null;\r\n            currentWindowWidth = null;\r\n            if (isResizingHorizontally) {\r\n                isResizingHorizontally = false;\r\n                store.dispatch('DID_STOP_RESIZE');\r\n            }\r\n        }, 500);\r\n    };\r\n    window.addEventListener('resize', resizeHandler);\r\n\r\n    // render initial view\r\n    const view = root(store, { id: getUniqueId() });\r\n\r\n    //\r\n    // PRIVATE API -------------------------------------------------------------------------------------\r\n    //\r\n    let isResting = false;\r\n    let isHidden = false;\r\n\r\n    const readWriteApi = {\r\n        // necessary for update loop\r\n\r\n        /**\r\n         * Reads from dom (never call manually)\r\n         * @private\r\n         */\r\n        _read: () => {\r\n            // test if we're resizing horizontally\r\n            // TODO: see if we can optimize this by measuring root rect\r\n            if (isResizing) {\r\n                currentWindowWidth = window.innerWidth;\r\n                if (!initialWindowWidth) {\r\n                    initialWindowWidth = currentWindowWidth;\r\n                }\r\n\r\n                if (!isResizingHorizontally && currentWindowWidth !== initialWindowWidth) {\r\n                    store.dispatch('DID_START_RESIZE');\r\n                    isResizingHorizontally = true;\r\n                }\r\n            }\r\n\r\n            if (isHidden && isResting) {\r\n                // test if is no longer hidden\r\n                isResting = view.element.offsetParent === null;\r\n            }\r\n\r\n            // if resting, no need to read as numbers will still all be correct\r\n            if (isResting) return;\r\n\r\n            // read view data\r\n            view._read();\r\n\r\n            // if is hidden we need to know so we exit rest mode when revealed\r\n            isHidden = view.rect.element.hidden;\r\n        },\r\n\r\n        /**\r\n         * Writes to dom (never call manually)\r\n         * @private\r\n         */\r\n        _write: ts => {\r\n            // get all actions from store\r\n            const actions = store\r\n                .processActionQueue()\r\n\r\n                // filter out set actions (these will automatically trigger DID_SET)\r\n                .filter(action => !/^SET_/.test(action.type));\r\n\r\n            // if was idling and no actions stop here\r\n            if (isResting && !actions.length) return;\r\n\r\n            // some actions might trigger events\r\n            routeActionsToEvents(actions);\r\n\r\n            // update the view\r\n            isResting = view._write(ts, actions, isResizingHorizontally);\r\n\r\n            // will clean up all archived items\r\n            removeReleasedItems(store.query('GET_ITEMS'));\r\n\r\n            // now idling\r\n            if (isResting) {\r\n                store.processDispatchQueue();\r\n            }\r\n        },\r\n    };\r\n\r\n    //\r\n    // EXPOSE EVENTS -------------------------------------------------------------------------------------\r\n    //\r\n    const createEvent = name => data => {\r\n        // create default event\r\n        const event = {\r\n            type: name,\r\n        };\r\n\r\n        // no data to add\r\n        if (!data) {\r\n            return event;\r\n        }\r\n\r\n        // copy relevant props\r\n        if (data.hasOwnProperty('error')) {\r\n            event.error = data.error ? { ...data.error } : null;\r\n        }\r\n\r\n        if (data.status) {\r\n            event.status = { ...data.status };\r\n        }\r\n\r\n        if (data.file) {\r\n            event.output = data.file;\r\n        }\r\n\r\n        // only source is available, else add item if possible\r\n        if (data.source) {\r\n            event.file = data.source;\r\n        } else if (data.item || data.id) {\r\n            const item = data.item ? data.item : store.query('GET_ITEM', data.id);\r\n            event.file = item ? createItemAPI(item) : null;\r\n        }\r\n\r\n        // map all items in a possible items array\r\n        if (data.items) {\r\n            event.items = data.items.map(createItemAPI);\r\n        }\r\n\r\n        // if this is a progress event add the progress amount\r\n        if (/progress/.test(name)) {\r\n            event.progress = data.progress;\r\n        }\r\n\r\n        // copy relevant props\r\n        if (data.hasOwnProperty('origin') && data.hasOwnProperty('target')) {\r\n            event.origin = data.origin;\r\n            event.target = data.target;\r\n        }\r\n\r\n        return event;\r\n    };\r\n\r\n    const eventRoutes = {\r\n        DID_DESTROY: createEvent('destroy'),\r\n\r\n        DID_INIT: createEvent('init'),\r\n\r\n        DID_THROW_MAX_FILES: createEvent('warning'),\r\n\r\n        DID_INIT_ITEM: createEvent('initfile'),\r\n        DID_START_ITEM_LOAD: createEvent('addfilestart'),\r\n        DID_UPDATE_ITEM_LOAD_PROGRESS: createEvent('addfileprogress'),\r\n        DID_LOAD_ITEM: createEvent('addfile'),\r\n\r\n        DID_THROW_ITEM_INVALID: [createEvent('error'), createEvent('addfile')],\r\n\r\n        DID_THROW_ITEM_LOAD_ERROR: [createEvent('error'), createEvent('addfile')],\r\n\r\n        DID_THROW_ITEM_REMOVE_ERROR: [createEvent('error'), createEvent('removefile')],\r\n\r\n        DID_PREPARE_OUTPUT: createEvent('preparefile'),\r\n\r\n        DID_START_ITEM_PROCESSING: createEvent('processfilestart'),\r\n        DID_UPDATE_ITEM_PROCESS_PROGRESS: createEvent('processfileprogress'),\r\n        DID_ABORT_ITEM_PROCESSING: createEvent('processfileabort'),\r\n        DID_COMPLETE_ITEM_PROCESSING: createEvent('processfile'),\r\n        DID_COMPLETE_ITEM_PROCESSING_ALL: createEvent('processfiles'),\r\n        DID_REVERT_ITEM_PROCESSING: createEvent('processfilerevert'),\r\n\r\n        DID_THROW_ITEM_PROCESSING_ERROR: [createEvent('error'), createEvent('processfile')],\r\n\r\n        DID_REMOVE_ITEM: createEvent('removefile'),\r\n\r\n        DID_UPDATE_ITEMS: createEvent('updatefiles'),\r\n\r\n        DID_ACTIVATE_ITEM: createEvent('activatefile'),\r\n\r\n        DID_REORDER_ITEMS: createEvent('reorderfiles'),\r\n    };\r\n\r\n    const exposeEvent = event => {\r\n        // create event object to be dispatched\r\n        const detail = { pond: exports, ...event };\r\n        delete detail.type;\r\n        view.element.dispatchEvent(\r\n            new CustomEvent(`FilePond:${event.type}`, {\r\n                // event info\r\n                detail,\r\n\r\n                // event behaviour\r\n                bubbles: true,\r\n                cancelable: true,\r\n                composed: true, // triggers listeners outside of shadow root\r\n            })\r\n        );\r\n\r\n        // event object to params used for `on()` event handlers and callbacks `oninit()`\r\n        const params = [];\r\n\r\n        // if is possible error event, make it the first param\r\n        if (event.hasOwnProperty('error')) {\r\n            params.push(event.error);\r\n        }\r\n\r\n        // file is always section\r\n        if (event.hasOwnProperty('file')) {\r\n            params.push(event.file);\r\n        }\r\n\r\n        // append other props\r\n        const filtered = ['type', 'error', 'file'];\r\n        Object.keys(event)\r\n            .filter(key => !filtered.includes(key))\r\n            .forEach(key => params.push(event[key]));\r\n\r\n        // on(type, () => { })\r\n        exports.fire(event.type, ...params);\r\n\r\n        // oninit = () => {}\r\n        const handler = store.query(`GET_ON${event.type.toUpperCase()}`);\r\n        if (handler) {\r\n            handler(...params);\r\n        }\r\n    };\r\n\r\n    const routeActionsToEvents = actions => {\r\n        if (!actions.length) return;\r\n        actions\r\n            .filter(action => eventRoutes[action.type])\r\n            .forEach(action => {\r\n                const routes = eventRoutes[action.type];\r\n                (Array.isArray(routes) ? routes : [routes]).forEach(route => {\r\n                    // this isn't fantastic, but because of the stacking of settimeouts plugins can handle the did_load before the did_init\r\n                    if (action.type === 'DID_INIT_ITEM') {\r\n                        exposeEvent(route(action.data));\r\n                    } else {\r\n                        setTimeout(() => {\r\n                            exposeEvent(route(action.data));\r\n                        }, 0);\r\n                    }\r\n                });\r\n            });\r\n    };\r\n\r\n    //\r\n    // PUBLIC API -------------------------------------------------------------------------------------\r\n    //\r\n    const setOptions = options => store.dispatch('SET_OPTIONS', { options });\r\n\r\n    const getFile = query => store.query('GET_ACTIVE_ITEM', query);\r\n\r\n    const prepareFile = query =>\r\n        new Promise((resolve, reject) => {\r\n            store.dispatch('REQUEST_ITEM_PREPARE', {\r\n                query,\r\n                success: item => {\r\n                    resolve(item);\r\n                },\r\n                failure: error => {\r\n                    reject(error);\r\n                },\r\n            });\r\n        });\r\n\r\n    const addFile = (source, options = {}) =>\r\n        new Promise((resolve, reject) => {\r\n            addFiles([{ source, options }], { index: options.index })\r\n                .then(items => resolve(items && items[0]))\r\n                .catch(reject);\r\n        });\r\n\r\n    const isFilePondFile = obj => obj.file && obj.id;\r\n\r\n    const removeFile = (query, options) => {\r\n        // if only passed options\r\n        if (typeof query === 'object' && !isFilePondFile(query) && !options) {\r\n            options = query;\r\n            query = undefined;\r\n        }\r\n\r\n        // request item removal\r\n        store.dispatch('REMOVE_ITEM', { ...options, query });\r\n\r\n        // see if item has been removed\r\n        return store.query('GET_ACTIVE_ITEM', query) === null;\r\n    };\r\n\r\n    const addFiles = (...args) =>\r\n        new Promise((resolve, reject) => {\r\n            const sources = [];\r\n            const options = {};\r\n\r\n            // user passed a sources array\r\n            if (isArray(args[0])) {\r\n                sources.push.apply(sources, args[0]);\r\n                Object.assign(options, args[1] || {});\r\n            } else {\r\n                // user passed sources as arguments, last one might be options object\r\n                const lastArgument = args[args.length - 1];\r\n                if (typeof lastArgument === 'object' && !(lastArgument instanceof Blob)) {\r\n                    Object.assign(options, args.pop());\r\n                }\r\n\r\n                // add rest to sources\r\n                sources.push(...args);\r\n            }\r\n\r\n            store.dispatch('ADD_ITEMS', {\r\n                items: sources,\r\n                index: options.index,\r\n                interactionMethod: InteractionMethod.API,\r\n                success: resolve,\r\n                failure: reject,\r\n            });\r\n        });\r\n\r\n    const getFiles = () => store.query('GET_ACTIVE_ITEMS');\r\n\r\n    const processFile = query =>\r\n        new Promise((resolve, reject) => {\r\n            store.dispatch('REQUEST_ITEM_PROCESSING', {\r\n                query,\r\n                success: item => {\r\n                    resolve(item);\r\n                },\r\n                failure: error => {\r\n                    reject(error);\r\n                },\r\n            });\r\n        });\r\n\r\n    const prepareFiles = (...args) => {\r\n        const queries = Array.isArray(args[0]) ? args[0] : args;\r\n        const items = queries.length ? queries : getFiles();\r\n        return Promise.all(items.map(prepareFile));\r\n    };\r\n\r\n    const processFiles = (...args) => {\r\n        const queries = Array.isArray(args[0]) ? args[0] : args;\r\n        if (!queries.length) {\r\n            const files = getFiles().filter(\r\n                item =>\r\n                    !(item.status === ItemStatus.IDLE && item.origin === FileOrigin.LOCAL) &&\r\n                    item.status !== ItemStatus.PROCESSING &&\r\n                    item.status !== ItemStatus.PROCESSING_COMPLETE &&\r\n                    item.status !== ItemStatus.PROCESSING_REVERT_ERROR\r\n            );\r\n            return Promise.all(files.map(processFile));\r\n        }\r\n        return Promise.all(queries.map(processFile));\r\n    };\r\n\r\n    const removeFiles = (...args) => {\r\n        const queries = Array.isArray(args[0]) ? args[0] : args;\r\n\r\n        let options;\r\n        if (typeof queries[queries.length - 1] === 'object') {\r\n            options = queries.pop();\r\n        } else if (Array.isArray(args[0])) {\r\n            options = args[1];\r\n        }\r\n\r\n        const files = getFiles();\r\n\r\n        if (!queries.length) return Promise.all(files.map(file => removeFile(file, options)));\r\n\r\n        // when removing by index the indexes shift after each file removal so we need to convert indexes to ids\r\n        const mappedQueries = queries\r\n            .map(query => (isNumber(query) ? (files[query] ? files[query].id : null) : query))\r\n            .filter(query => query);\r\n\r\n        return mappedQueries.map(q => removeFile(q, options));\r\n    };\r\n\r\n    const exports = {\r\n        // supports events\r\n        ...on(),\r\n\r\n        // inject private api methods\r\n        ...readWriteApi,\r\n\r\n        // inject all getters and setters\r\n        ...createOptionAPI(store, defaultOptions),\r\n\r\n        /**\r\n         * Override options defined in options object\r\n         * @param options\r\n         */\r\n        setOptions,\r\n\r\n        /**\r\n         * Load the given file\r\n         * @param source - the source of the file (either a File, base64 data uri or url)\r\n         * @param options - object, { index: 0 }\r\n         */\r\n        addFile,\r\n\r\n        /**\r\n         * Load the given files\r\n         * @param sources - the sources of the files to load\r\n         * @param options - object, { index: 0 }\r\n         */\r\n        addFiles,\r\n\r\n        /**\r\n         * Returns the file objects matching the given query\r\n         * @param query { string, number, null }\r\n         */\r\n        getFile,\r\n\r\n        /**\r\n         * Upload file with given name\r\n         * @param query { string, number, null  }\r\n         */\r\n        processFile,\r\n\r\n        /**\r\n         * Request prepare output for file with given name\r\n         * @param query { string, number, null  }\r\n         */\r\n        prepareFile,\r\n\r\n        /**\r\n         * Removes a file by its name\r\n         * @param query { string, number, null  }\r\n         */\r\n        removeFile,\r\n\r\n        /**\r\n         * Moves a file to a new location in the files list\r\n         */\r\n        moveFile: (query, index) => store.dispatch('MOVE_ITEM', { query, index }),\r\n\r\n        /**\r\n         * Returns all files (wrapped in public api)\r\n         */\r\n        getFiles,\r\n\r\n        /**\r\n         * Starts uploading all files\r\n         */\r\n        processFiles,\r\n\r\n        /**\r\n         * Clears all files from the files list\r\n         */\r\n        removeFiles,\r\n\r\n        /**\r\n         * Starts preparing output of all files\r\n         */\r\n        prepareFiles,\r\n\r\n        /**\r\n         * Sort list of files\r\n         */\r\n        sort: compare => store.dispatch('SORT', { compare }),\r\n\r\n        /**\r\n         * Browse the file system for a file\r\n         */\r\n        browse: () => {\r\n            // needs to be trigger directly as user action needs to be traceable (is not traceable in requestAnimationFrame)\r\n            var input = view.element.querySelector('input[type=file]');\r\n            if (input) {\r\n                input.click();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Destroys the app\r\n         */\r\n        destroy: () => {\r\n            // request destruction\r\n            exports.fire('destroy', view.element);\r\n\r\n            // stop active processes (file uploads, fetches, stuff like that)\r\n            // loop over items and depending on states call abort for ongoing processes\r\n            store.dispatch('ABORT_ALL');\r\n\r\n            // destroy view\r\n            view._destroy();\r\n\r\n            // stop listening to resize\r\n            window.removeEventListener('resize', resizeHandler);\r\n\r\n            // stop listening to the visiblitychange event\r\n            document.removeEventListener('visibilitychange', visibilityHandler);\r\n\r\n            // dispatch destroy\r\n            store.dispatch('DID_DESTROY');\r\n        },\r\n\r\n        /**\r\n         * Inserts the plugin before the target element\r\n         */\r\n        insertBefore: element => insertBefore(view.element, element),\r\n\r\n        /**\r\n         * Inserts the plugin after the target element\r\n         */\r\n        insertAfter: element => insertAfter(view.element, element),\r\n\r\n        /**\r\n         * Appends the plugin to the target element\r\n         */\r\n        appendTo: element => element.appendChild(view.element),\r\n\r\n        /**\r\n         * Replaces an element with the app\r\n         */\r\n        replaceElement: element => {\r\n            // insert the app before the element\r\n            insertBefore(view.element, element);\r\n\r\n            // remove the original element\r\n            element.parentNode.removeChild(element);\r\n\r\n            // remember original element\r\n            originalElement = element;\r\n        },\r\n\r\n        /**\r\n         * Restores the original element\r\n         */\r\n        restoreElement: () => {\r\n            if (!originalElement) {\r\n                return; // no element to restore\r\n            }\r\n\r\n            // restore original element\r\n            insertAfter(originalElement, view.element);\r\n\r\n            // remove our element\r\n            view.element.parentNode.removeChild(view.element);\r\n\r\n            // remove reference\r\n            originalElement = null;\r\n        },\r\n\r\n        /**\r\n         * Returns true if the app root is attached to given element\r\n         * @param element\r\n         */\r\n        isAttachedTo: element => view.element === element || originalElement === element,\r\n\r\n        /**\r\n         * Returns the root element\r\n         */\r\n        element: {\r\n            get: () => view.element,\r\n        },\r\n\r\n        /**\r\n         * Returns the current pond status\r\n         */\r\n        status: {\r\n            get: () => store.query('GET_STATUS'),\r\n        },\r\n    };\r\n\r\n    // Done!\r\n    store.dispatch('DID_INIT');\r\n\r\n    // create actual api object\r\n    return createObject(exports);\r\n};\r\n\r\nconst createAppObject = (customOptions = {}) => {\r\n    // default options\r\n    const defaultOptions = {};\r\n    forin(getOptions(), (key, value) => {\r\n        defaultOptions[key] = value[0];\r\n    });\r\n\r\n    // set app options\r\n    const app = createApp({\r\n        // default options\r\n        ...defaultOptions,\r\n\r\n        // custom options\r\n        ...customOptions,\r\n    });\r\n\r\n    // return the plugin instance\r\n    return app;\r\n};\r\n\r\nconst lowerCaseFirstLetter = string => string.charAt(0).toLowerCase() + string.slice(1);\r\n\r\nconst attributeNameToPropertyName = attributeName => toCamels(attributeName.replace(/^data-/, ''));\r\n\r\nconst mapObject = (object, propertyMap) => {\r\n    // remove unwanted\r\n    forin(propertyMap, (selector, mapping) => {\r\n        forin(object, (property, value) => {\r\n            // create regexp shortcut\r\n            const selectorRegExp = new RegExp(selector);\r\n\r\n            // tests if\r\n            const matches = selectorRegExp.test(property);\r\n\r\n            // no match, skip\r\n            if (!matches) {\r\n                return;\r\n            }\r\n\r\n            // if there's a mapping, the original property is always removed\r\n            delete object[property];\r\n\r\n            // should only remove, we done!\r\n            if (mapping === false) {\r\n                return;\r\n            }\r\n\r\n            // move value to new property\r\n            if (isString(mapping)) {\r\n                object[mapping] = value;\r\n                return;\r\n            }\r\n\r\n            // move to group\r\n            const group = mapping.group;\r\n            if (isObject(mapping) && !object[group]) {\r\n                object[group] = {};\r\n            }\r\n\r\n            object[group][lowerCaseFirstLetter(property.replace(selectorRegExp, ''))] = value;\r\n        });\r\n\r\n        // do submapping\r\n        if (mapping.mapping) {\r\n            mapObject(object[mapping.group], mapping.mapping);\r\n        }\r\n    });\r\n};\r\n\r\nconst getAttributesAsObject = (node, attributeMapping = {}) => {\r\n    // turn attributes into object\r\n    const attributes = [];\r\n    forin(node.attributes, index => {\r\n        attributes.push(node.attributes[index]);\r\n    });\r\n\r\n    const output = attributes\r\n        .filter(attribute => attribute.name)\r\n        .reduce((obj, attribute) => {\r\n            const value = attr(node, attribute.name);\r\n\r\n            obj[attributeNameToPropertyName(attribute.name)] =\r\n                value === attribute.name ? true : value;\r\n            return obj;\r\n        }, {});\r\n\r\n    // do mapping of object properties\r\n    mapObject(output, attributeMapping);\r\n\r\n    return output;\r\n};\r\n\r\nconst createAppAtElement = (element, options = {}) => {\r\n    // how attributes of the input element are mapped to the options for the plugin\r\n    const attributeMapping = {\r\n        // translate to other name\r\n        '^class$': 'className',\r\n        '^multiple$': 'allowMultiple',\r\n        '^capture$': 'captureMethod',\r\n        '^webkitdirectory$': 'allowDirectoriesOnly',\r\n\r\n        // group under single property\r\n        '^server': {\r\n            group: 'server',\r\n            mapping: {\r\n                '^process': {\r\n                    group: 'process',\r\n                },\r\n                '^revert': {\r\n                    group: 'revert',\r\n                },\r\n                '^fetch': {\r\n                    group: 'fetch',\r\n                },\r\n                '^restore': {\r\n                    group: 'restore',\r\n                },\r\n                '^load': {\r\n                    group: 'load',\r\n                },\r\n            },\r\n        },\r\n\r\n        // don't include in object\r\n        '^type$': false,\r\n        '^files$': false,\r\n    };\r\n\r\n    // add additional option translators\r\n    applyFilters('SET_ATTRIBUTE_TO_OPTION_MAP', attributeMapping);\r\n\r\n    // create final options object by setting options object and then overriding options supplied on element\r\n    const mergedOptions = {\r\n        ...options,\r\n    };\r\n\r\n    const attributeOptions = getAttributesAsObject(\r\n        element.nodeName === 'FIELDSET' ? element.querySelector('input[type=file]') : element,\r\n        attributeMapping\r\n    );\r\n\r\n    // merge with options object\r\n    Object.keys(attributeOptions).forEach(key => {\r\n        if (isObject(attributeOptions[key])) {\r\n            if (!isObject(mergedOptions[key])) {\r\n                mergedOptions[key] = {};\r\n            }\r\n            Object.assign(mergedOptions[key], attributeOptions[key]);\r\n        } else {\r\n            mergedOptions[key] = attributeOptions[key];\r\n        }\r\n    });\r\n\r\n    // if parent is a fieldset, get files from parent by selecting all input fields that are not file upload fields\r\n    // these will then be automatically set to the initial files\r\n    mergedOptions.files = (options.files || []).concat(\r\n        Array.from(element.querySelectorAll('input:not([type=file])')).map(input => ({\r\n            source: input.value,\r\n            options: {\r\n                type: input.dataset.type,\r\n            },\r\n        }))\r\n    );\r\n\r\n    // build plugin\r\n    const app = createAppObject(mergedOptions);\r\n\r\n    // add already selected files\r\n    if (element.files) {\r\n        Array.from(element.files).forEach(file => {\r\n            app.addFile(file);\r\n        });\r\n    }\r\n\r\n    // replace the target element\r\n    app.replaceElement(element);\r\n\r\n    // expose\r\n    return app;\r\n};\r\n\r\n// if an element is passed, we create the instance at that element, if not, we just create an up object\r\nconst createApp$1 = (...args) =>\r\n    isNode(args[0]) ? createAppAtElement(...args) : createAppObject(...args);\r\n\r\nconst PRIVATE_METHODS = ['fire', '_read', '_write'];\r\n\r\nconst createAppAPI = app => {\r\n    const api = {};\r\n\r\n    copyObjectPropertiesToObject(app, api, PRIVATE_METHODS);\r\n\r\n    return api;\r\n};\r\n\r\n/**\r\n * Replaces placeholders in given string with replacements\r\n * @param string - \"Foo {bar}\"\"\r\n * @param replacements - { \"bar\": 10 }\r\n */\r\nconst replaceInString = (string, replacements) =>\r\n    string.replace(/(?:{([a-zA-Z]+)})/g, (match, group) => replacements[group]);\r\n\r\nconst createWorker = fn => {\r\n    const workerBlob = new Blob(['(', fn.toString(), ')()'], {\r\n        type: 'application/javascript',\r\n    });\r\n    const workerURL = URL.createObjectURL(workerBlob);\r\n    const worker = new Worker(workerURL);\r\n\r\n    return {\r\n        transfer: (message, cb) => {},\r\n        post: (message, cb, transferList) => {\r\n            const id = getUniqueId();\r\n\r\n            worker.onmessage = e => {\r\n                if (e.data.id === id) {\r\n                    cb(e.data.message);\r\n                }\r\n            };\r\n\r\n            worker.postMessage(\r\n                {\r\n                    id,\r\n                    message,\r\n                },\r\n                transferList\r\n            );\r\n        },\r\n        terminate: () => {\r\n            worker.terminate();\r\n            URL.revokeObjectURL(workerURL);\r\n        },\r\n    };\r\n};\r\n\r\nconst loadImage = url =>\r\n    new Promise((resolve, reject) => {\r\n        const img = new Image();\r\n        img.onload = () => {\r\n            resolve(img);\r\n        };\r\n        img.onerror = e => {\r\n            reject(e);\r\n        };\r\n        img.src = url;\r\n    });\r\n\r\nconst renameFile = (file, name) => {\r\n    const renamedFile = file.slice(0, file.size, file.type);\r\n    renamedFile.lastModifiedDate = file.lastModifiedDate;\r\n    renamedFile.name = name;\r\n    return renamedFile;\r\n};\r\n\r\nconst copyFile = file => renameFile(file, file.name);\r\n\r\n// already registered plugins (can't register twice)\r\nconst registeredPlugins = [];\r\n\r\n// pass utils to plugin\r\nconst createAppPlugin = plugin => {\r\n    // already registered\r\n    if (registeredPlugins.includes(plugin)) {\r\n        return;\r\n    }\r\n\r\n    // remember this plugin\r\n    registeredPlugins.push(plugin);\r\n\r\n    // setup!\r\n    const pluginOutline = plugin({\r\n        addFilter,\r\n        utils: {\r\n            Type,\r\n            forin,\r\n            isString,\r\n            isFile,\r\n            toNaturalFileSize,\r\n            replaceInString,\r\n            getExtensionFromFilename,\r\n            getFilenameWithoutExtension,\r\n            guesstimateMimeType,\r\n            getFileFromBlob,\r\n            getFilenameFromURL,\r\n            createRoute,\r\n            createWorker,\r\n            createView,\r\n            createItemAPI,\r\n            loadImage,\r\n            copyFile,\r\n            renameFile,\r\n            createBlob,\r\n            applyFilterChain,\r\n            text,\r\n            getNumericAspectRatioFromString,\r\n        },\r\n        views: {\r\n            fileActionButton,\r\n        },\r\n    });\r\n\r\n    // add plugin options to default options\r\n    extendDefaultOptions(pluginOutline.options);\r\n};\r\n\r\n// feature detection used by supported() method\r\nconst isOperaMini = () => Object.prototype.toString.call(window.operamini) === '[object OperaMini]';\r\nconst hasPromises = () => 'Promise' in window;\r\nconst hasBlobSlice = () => 'slice' in Blob.prototype;\r\nconst hasCreateObjectURL = () => 'URL' in window && 'createObjectURL' in window.URL;\r\nconst hasVisibility = () => 'visibilityState' in document;\r\nconst hasTiming = () => 'performance' in window; // iOS 8.x\r\nconst hasCSSSupports = () => 'supports' in (window.CSS || {}); // use to detect Safari 9+\r\nconst isIE11 = () => /MSIE|Trident/.test(window.navigator.userAgent);\r\n\r\nconst supported = (() => {\r\n    // Runs immediately and then remembers result for subsequent calls\r\n    const isSupported =\r\n        // Has to be a browser\r\n        isBrowser() &&\r\n        // Can't run on Opera Mini due to lack of everything\r\n        !isOperaMini() &&\r\n        // Require these APIs to feature detect a modern browser\r\n        hasVisibility() &&\r\n        hasPromises() &&\r\n        hasBlobSlice() &&\r\n        hasCreateObjectURL() &&\r\n        hasTiming() &&\r\n        // doesn't need CSSSupports but is a good way to detect Safari 9+ (we do want to support IE11 though)\r\n        (hasCSSSupports() || isIE11());\r\n\r\n    return () => isSupported;\r\n})();\r\n\r\n/**\r\n * Plugin internal state (over all instances)\r\n */\r\nconst state = {\r\n    // active app instances, used to redraw the apps and to find the later\r\n    apps: [],\r\n};\r\n\r\n// plugin name\r\nconst name = 'filepond';\r\n\r\n/**\r\n * Public Plugin methods\r\n */\r\nconst fn = () => {};\r\nlet Status$1 = {};\r\nlet FileStatus = {};\r\nlet FileOrigin$1 = {};\r\nlet OptionTypes = {};\r\nlet create$f = fn;\r\nlet destroy = fn;\r\nlet parse = fn;\r\nlet find = fn;\r\nlet registerPlugin = fn;\r\nlet getOptions$1 = fn;\r\nlet setOptions$1 = fn;\r\n\r\n// if not supported, no API\r\nif (supported()) {\r\n    // start painter and fire load event\r\n    createPainter(\r\n        () => {\r\n            state.apps.forEach(app => app._read());\r\n        },\r\n        ts => {\r\n            state.apps.forEach(app => app._write(ts));\r\n        }\r\n    );\r\n\r\n    // fire loaded event so we know when FilePond is available\r\n    const dispatch = () => {\r\n        // let others know we have area ready\r\n        document.dispatchEvent(\r\n            new CustomEvent('FilePond:loaded', {\r\n                detail: {\r\n                    supported,\r\n                    create: create$f,\r\n                    destroy,\r\n                    parse,\r\n                    find,\r\n                    registerPlugin,\r\n                    setOptions: setOptions$1,\r\n                },\r\n            })\r\n        );\r\n\r\n        // clean up event\r\n        document.removeEventListener('DOMContentLoaded', dispatch);\r\n    };\r\n\r\n    if (document.readyState !== 'loading') {\r\n        // move to back of execution queue, FilePond should have been exported by then\r\n        setTimeout(() => dispatch(), 0);\r\n    } else {\r\n        document.addEventListener('DOMContentLoaded', dispatch);\r\n    }\r\n\r\n    // updates the OptionTypes object based on the current options\r\n    const updateOptionTypes = () =>\r\n        forin(getOptions(), (key, value) => {\r\n            OptionTypes[key] = value[1];\r\n        });\r\n\r\n    Status$1 = { ...Status };\r\n    FileOrigin$1 = { ...FileOrigin };\r\n    FileStatus = { ...ItemStatus };\r\n\r\n    OptionTypes = {};\r\n    updateOptionTypes();\r\n\r\n    // create method, creates apps and adds them to the app array\r\n    create$f = (...args) => {\r\n        const app = createApp$1(...args);\r\n        app.on('destroy', destroy);\r\n        state.apps.push(app);\r\n        return createAppAPI(app);\r\n    };\r\n\r\n    // destroys apps and removes them from the app array\r\n    destroy = hook => {\r\n        // returns true if the app was destroyed successfully\r\n        const indexToRemove = state.apps.findIndex(app => app.isAttachedTo(hook));\r\n        if (indexToRemove >= 0) {\r\n            // remove from apps\r\n            const app = state.apps.splice(indexToRemove, 1)[0];\r\n\r\n            // restore original dom element\r\n            app.restoreElement();\r\n\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    // parses the given context for plugins (does not include the context element itself)\r\n    parse = context => {\r\n        // get all possible hooks\r\n        const matchedHooks = Array.from(context.querySelectorAll(`.${name}`));\r\n\r\n        // filter out already active hooks\r\n        const newHooks = matchedHooks.filter(\r\n            newHook => !state.apps.find(app => app.isAttachedTo(newHook))\r\n        );\r\n\r\n        // create new instance for each hook\r\n        return newHooks.map(hook => create$f(hook));\r\n    };\r\n\r\n    // returns an app based on the given element hook\r\n    find = hook => {\r\n        const app = state.apps.find(app => app.isAttachedTo(hook));\r\n        if (!app) {\r\n            return null;\r\n        }\r\n        return createAppAPI(app);\r\n    };\r\n\r\n    // adds a plugin extension\r\n    registerPlugin = (...plugins) => {\r\n        // register plugins\r\n        plugins.forEach(createAppPlugin);\r\n\r\n        // update OptionTypes, each plugin might have extended the default options\r\n        updateOptionTypes();\r\n    };\r\n\r\n    getOptions$1 = () => {\r\n        const opts = {};\r\n        forin(getOptions(), (key, value) => {\r\n            opts[key] = value[0];\r\n        });\r\n        return opts;\r\n    };\r\n\r\n    setOptions$1 = opts => {\r\n        if (isObject(opts)) {\r\n            // update existing plugins\r\n            state.apps.forEach(app => {\r\n                app.setOptions(opts);\r\n            });\r\n\r\n            // override defaults\r\n            setOptions(opts);\r\n        }\r\n\r\n        // return new options\r\n        return getOptions$1();\r\n    };\r\n}\r\n\r\nexport {\r\n    FileOrigin$1 as FileOrigin,\r\n    FileStatus,\r\n    OptionTypes,\r\n    Status$1 as Status,\r\n    create$f as create,\r\n    destroy,\r\n    find,\r\n    getOptions$1 as getOptions,\r\n    parse,\r\n    registerPlugin,\r\n    setOptions$1 as setOptions,\r\n    supported,\r\n};\r\n"],
  "mappings": "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",
  "names": ["queries", "actions", "state", "data", "query", "name", "name", "animations", "animator", "fn", "styles", "write", "create", "destroy", "actions", "state", "store", "props", "read", "root", "listeners", "item", "value", "error", "option", "blob", "file", "data", "res", "headers", "chunk", "ondata", "onerror", "onload", "serverFileReference", "key", "query", "success", "result", "failure", "isAsync", "map", "action", "e", "drop", "location", "currentIndex", "dragHeight", "itemHeight", "entry", "list", "panel", "defaultOptions", "route", "setOptions", "getFiles", "queries", "isSupported", "app", "React", "name"]
}
