import {
  n
} from "./chunk-374ZSSDZ.js";
import {
  y
} from "./chunk-PM2IHWHB.js";
import {
  h,
  w
} from "./chunk-MVM2C7P2.js";
import {
  x
} from "./chunk-7EER3O2F.js";
import {
  ae
} from "./chunk-NMWROSO4.js";
import {
  require_react
} from "./chunk-4373DSHM.js";
import {
  __toESM
} from "./chunk-SNAQBZPT.js";

// node_modules/dgz-ui/dist/index-DqTIeHVj.js
var o = __toESM(require_react(), 1);
function U(r, e = globalThis == null ? void 0 : globalThis.document) {
  const s = n(r);
  o.useEffect(() => {
    const n2 = (t) => {
      t.key === "Escape" && s(t);
    };
    return e.addEventListener("keydown", n2, { capture: true }), () => e.removeEventListener("keydown", n2, { capture: true });
  }, [s, e]);
}
var j = "DismissableLayer";
var p = "dismissableLayer.update";
var z = "dismissableLayer.pointerDownOutside";
var H = "dismissableLayer.focusOutside";
var O;
var T = o.createContext({
  layers: /* @__PURE__ */ new Set(),
  layersWithOutsidePointerEventsDisabled: /* @__PURE__ */ new Set(),
  branches: /* @__PURE__ */ new Set()
});
var M = o.forwardRef(
  (r, e) => {
    const {
      disableOutsidePointerEvents: s = false,
      onEscapeKeyDown: n2,
      onPointerDownOutside: t,
      onFocusOutside: a,
      onInteractOutside: l,
      onDismiss: d,
      ...E
    } = r, c = o.useContext(T), [u, S] = o.useState(null), f = (u == null ? void 0 : u.ownerDocument) ?? (globalThis == null ? void 0 : globalThis.document), [, F] = o.useState({}), W = x(e, (i) => S(i)), b = Array.from(c.layers), [k] = [...c.layersWithOutsidePointerEventsDisabled].slice(-1), A = b.indexOf(k), P = u ? b.indexOf(u) : -1, N = c.layersWithOutsidePointerEventsDisabled.size > 0, D = P >= A, I = Y((i) => {
      const v = i.target, C = [...c.branches].some((h2) => h2.contains(v));
      !D || C || (t == null || t(i), l == null || l(i), i.defaultPrevented || d == null || d());
    }, f), L = q((i) => {
      const v = i.target;
      [...c.branches].some((h2) => h2.contains(v)) || (a == null || a(i), l == null || l(i), i.defaultPrevented || d == null || d());
    }, f);
    return U((i) => {
      P === c.layers.size - 1 && (n2 == null || n2(i), !i.defaultPrevented && d && (i.preventDefault(), d()));
    }, f), o.useEffect(() => {
      if (u)
        return s && (c.layersWithOutsidePointerEventsDisabled.size === 0 && (O = f.body.style.pointerEvents, f.body.style.pointerEvents = "none"), c.layersWithOutsidePointerEventsDisabled.add(u)), c.layers.add(u), g(), () => {
          s && c.layersWithOutsidePointerEventsDisabled.size === 1 && (f.body.style.pointerEvents = O);
        };
    }, [u, f, s, c]), o.useEffect(() => () => {
      u && (c.layers.delete(u), c.layersWithOutsidePointerEventsDisabled.delete(u), g());
    }, [u, c]), o.useEffect(() => {
      const i = () => F({});
      return document.addEventListener(p, i), () => document.removeEventListener(p, i);
    }, []), ae.jsx(
      h.div,
      {
        ...E,
        ref: W,
        style: {
          pointerEvents: N ? D ? "auto" : "none" : void 0,
          ...r.style
        },
        onFocusCapture: y(r.onFocusCapture, L.onFocusCapture),
        onBlurCapture: y(r.onBlurCapture, L.onBlurCapture),
        onPointerDownCapture: y(
          r.onPointerDownCapture,
          I.onPointerDownCapture
        )
      }
    );
  }
);
M.displayName = j;
var K = "DismissableLayerBranch";
var X = o.forwardRef((r, e) => {
  const s = o.useContext(T), n2 = o.useRef(null), t = x(e, n2);
  return o.useEffect(() => {
    const a = n2.current;
    if (a)
      return s.branches.add(a), () => {
        s.branches.delete(a);
      };
  }, [s.branches]), ae.jsx(h.div, { ...r, ref: t });
});
X.displayName = K;
function Y(r, e = globalThis == null ? void 0 : globalThis.document) {
  const s = n(r), n2 = o.useRef(false), t = o.useRef(() => {
  });
  return o.useEffect(() => {
    const a = (d) => {
      if (d.target && !n2.current) {
        let E = function() {
          B(
            z,
            s,
            c,
            { discrete: true }
          );
        };
        const c = { originalEvent: d };
        d.pointerType === "touch" ? (e.removeEventListener("click", t.current), t.current = E, e.addEventListener("click", t.current, { once: true })) : E();
      } else
        e.removeEventListener("click", t.current);
      n2.current = false;
    }, l = window.setTimeout(() => {
      e.addEventListener("pointerdown", a);
    }, 0);
    return () => {
      window.clearTimeout(l), e.removeEventListener("pointerdown", a), e.removeEventListener("click", t.current);
    };
  }, [e, s]), {
    // ensures we check React component tree (not just DOM tree)
    onPointerDownCapture: () => n2.current = true
  };
}
function q(r, e = globalThis == null ? void 0 : globalThis.document) {
  const s = n(r), n2 = o.useRef(false);
  return o.useEffect(() => {
    const t = (a) => {
      a.target && !n2.current && B(H, s, { originalEvent: a }, {
        discrete: false
      });
    };
    return e.addEventListener("focusin", t), () => e.removeEventListener("focusin", t);
  }, [e, s]), {
    onFocusCapture: () => n2.current = true,
    onBlurCapture: () => n2.current = false
  };
}
function g() {
  const r = new CustomEvent(p);
  document.dispatchEvent(r);
}
function B(r, e, s, { discrete: n2 }) {
  const t = s.originalEvent.target, a = new CustomEvent(r, { bubbles: false, cancelable: true, detail: s });
  e && t.addEventListener(r, e, { once: true }), n2 ? w(t, a) : t.dispatchEvent(a);
}

export {
  M
};
//# sourceMappingURL=chunk-5UWODSHZ.js.map
